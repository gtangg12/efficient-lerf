(efficient-lerf) gtangg12@george-workstation:~/efficient-lerf$ python -m src.efficient_lerf.quantization_model
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/field_components/activations.py:32: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @custom_fwd(cast_inputs=torch.float32)
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/field_components/activations.py:39: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, g):
[03:31:16] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 396 images.
Setting up evaluation dataset...
Caching all 4 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 79.25it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/book_store/lerf/2024-11-07_102606/nerfstudio_models/step-000029999.ckpt
[2024/11/13 03:31:23 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 03:31:23 hloc INFO] Found 400 images in root /home/gtangg12/data/lerf/LERF Datasets/book_store/book_store/images.
[2024/11/13 03:31:23 hloc INFO] Skipping the extraction.
100%|████████████████████████████████████████████| 399/399 [00:00<00:00, 56541.90it/s]
tensor([  0,   4,   7,  10,  13,  15,  18,  21,  23,  26,  31,  33,  35,  38,
         44,  47,  53,  67,  72,  78,  80,  83,  87,  98, 103, 117, 123, 127,
        129, 132, 135, 140, 142, 144, 147, 155, 159, 167, 173, 180, 184, 185,
        187, 191, 194, 201, 208, 212, 214, 236, 238, 240, 242, 245, 247, 249,
        254, 257, 264, 276, 279, 281, 284, 291, 295, 297, 305, 309, 314, 318,
        322, 326, 329, 333, 335, 339, 347, 349, 351, 353, 355, 358, 362, 364,
        366, 368, 374, 376, 378, 381, 382, 384, 390, 393, 395, 397]) 96
Rendering views: 96it [06:14,  3.90s/it]
0it [00:00, ?it/s]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.73 s, search 17.71 s): objective=95887.8 imbalance=1.380 nsplit=0     Iteration 1 (35.67 s, search 35.63 s): objective=95937.8 imbalance=1.300 nsplit=0     Iteration 2 (54.07 s, search 54.02 s): objective=95945.1 imbalance=1.273 nsplit=1     Iteration 3 (72.62 s, search 72.56 s): objective=95947.9 imbalance=1.258 nsplit=0     Iteration 4 (90.96 s, search 90.88 s): objective=95949.6 imbalance=1.251 nsplit=0       
1it [01:49, 109.25s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (18.30 s, search 18.28 s): objective=95714.6 imbalance=1.364 nsplit=0     Iteration 1 (36.51 s, search 36.47 s): objective=95835.4 imbalance=1.287 nsplit=0     Iteration 2 (54.79 s, search 54.74 s): objective=95853 imbalance=1.262 nsplit=0       Iteration 3 (72.99 s, search 72.93 s): objective=95860.9 imbalance=1.251 nsplit=0     Iteration 4 (91.23 s, search 91.15 s): objective=95865 imbalance=1.245 nsplit=0       
2it [03:38, 109.44s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.95 s, search 17.93 s): objective=95624.5 imbalance=1.366 nsplit=0     Iteration 1 (36.06 s, search 36.03 s): objective=95777.9 imbalance=1.281 nsplit=0     Iteration 2 (53.64 s, search 53.60 s): objective=95800.6 imbalance=1.253 nsplit=0     Iteration 3 (71.65 s, search 71.59 s): objective=95809.8 imbalance=1.242 nsplit=0     Iteration 4 (89.31 s, search 89.23 s): objective=95814.9 imbalance=1.237 nsplit=0       
3it [05:25, 108.18s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (17.34 s, search 17.32 s): objective=95611.1 imbalance=1.366 nsplit=0     Iteration 1 (34.68 s, search 34.64 s): objective=95768.1 imbalance=1.280 nsplit=0     Iteration 2 (52.51 s, search 52.46 s): objective=95790.4 imbalance=1.252 nsplit=0     Iteration 3 (70.49 s, search 70.42 s): objective=95800.6 imbalance=1.240 nsplit=0     Iteration 4 (88.09 s, search 88.01 s): objective=95806.1 imbalance=1.234 nsplit=0       
4it [07:11, 107.13s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.54 s, search 17.52 s): objective=95635.2 imbalance=1.366 nsplit=0     Iteration 1 (35.22 s, search 35.18 s): objective=95782.8 imbalance=1.281 nsplit=0     Iteration 2 (52.81 s, search 52.76 s): objective=95804.8 imbalance=1.253 nsplit=0     Iteration 3 (70.09 s, search 70.02 s): objective=95814.4 imbalance=1.239 nsplit=0     Iteration 4 (87.91 s, search 87.83 s): objective=95819.6 imbalance=1.231 nsplit=0       
5it [08:57, 106.74s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.49 s, search 17.47 s): objective=95669.5 imbalance=1.368 nsplit=0     Iteration 1 (35.42 s, search 35.38 s): objective=95805.9 imbalance=1.283 nsplit=0     Iteration 2 (53.00 s, search 52.95 s): objective=95825.4 imbalance=1.254 nsplit=1     Iteration 3 (70.63 s, search 70.57 s): objective=95833.8 imbalance=1.242 nsplit=0     Iteration 4 (88.26 s, search 88.18 s): objective=95838.9 imbalance=1.236 nsplit=0       
6it [10:43, 106.60s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.07 s, search 18.05 s): objective=95708 imbalance=1.373 nsplit=0       Iteration 1 (36.09 s, search 36.06 s): objective=95830 imbalance=1.285 nsplit=0       Iteration 2 (53.97 s, search 53.92 s): objective=95847.9 imbalance=1.255 nsplit=0     Iteration 3 (71.53 s, search 71.47 s): objective=95855.8 imbalance=1.244 nsplit=0     Iteration 4 (89.51 s, search 89.43 s): objective=95859.9 imbalance=1.238 nsplit=0       
7it [12:30, 106.76s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.31 s, search 17.29 s): objective=95746.9 imbalance=1.379 nsplit=0     Iteration 1 (34.59 s, search 34.55 s): objective=95853.5 imbalance=1.289 nsplit=0     Iteration 2 (52.03 s, search 51.98 s): objective=95868.8 imbalance=1.261 nsplit=0     Iteration 3 (70.10 s, search 70.04 s): objective=95875.2 imbalance=1.247 nsplit=0     Iteration 4 (88.19 s, search 88.11 s): objective=95879.1 imbalance=1.240 nsplit=0       
8it [14:16, 106.62s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.02 s, search 18.00 s): objective=95784 imbalance=1.382 nsplit=0       Iteration 1 (36.09 s, search 36.06 s): objective=95875 imbalance=1.293 nsplit=0       Iteration 2 (54.09 s, search 54.04 s): objective=95888.1 imbalance=1.264 nsplit=0     Iteration 3 (71.94 s, search 71.87 s): objective=95893.8 imbalance=1.252 nsplit=0     Iteration 4 (89.88 s, search 89.80 s): objective=95896.9 imbalance=1.245 nsplit=0       
9it [16:04, 106.94s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.96 s, search 17.94 s): objective=95814.5 imbalance=1.382 nsplit=0     Iteration 1 (35.86 s, search 35.82 s): objective=95891.8 imbalance=1.293 nsplit=0     Iteration 2 (53.82 s, search 53.77 s): objective=95903 imbalance=1.263 nsplit=0       Iteration 3 (71.75 s, search 71.68 s): objective=95907.8 imbalance=1.250 nsplit=0     Iteration 4 (89.77 s, search 89.69 s): objective=95910.5 imbalance=1.244 nsplit=0       
10it [17:52, 107.14s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (17.64 s, search 17.62 s): objective=95838.8 imbalance=1.380 nsplit=0     Iteration 1 (35.52 s, search 35.49 s): objective=95904.5 imbalance=1.294 nsplit=0     Iteration 2 (53.58 s, search 53.53 s): objective=95914 imbalance=1.265 nsplit=0       Iteration 3 (71.75 s, search 71.69 s): objective=95918.2 imbalance=1.253 nsplit=0     Iteration 4 (89.82 s, search 89.74 s): objective=95920.7 imbalance=1.246 nsplit=0       
11it [19:40, 107.46s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (18.23 s, search 18.21 s): objective=95857.3 imbalance=1.375 nsplit=0     Iteration 1 (36.47 s, search 36.43 s): objective=95914.7 imbalance=1.291 nsplit=0     Iteration 2 (54.62 s, search 54.57 s): objective=95923.2 imbalance=1.265 nsplit=0     Iteration 3 (72.71 s, search 72.65 s): objective=95926.7 imbalance=1.253 nsplit=0     Iteration 4 (90.87 s, search 90.79 s): objective=95928.7 imbalance=1.246 nsplit=0       
12it [21:29, 107.94s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (17.99 s, search 17.97 s): objective=95872.5 imbalance=1.377 nsplit=0     Iteration 1 (36.10 s, search 36.06 s): objective=95922.8 imbalance=1.290 nsplit=1     Iteration 2 (54.25 s, search 54.20 s): objective=95930 imbalance=1.265 nsplit=1       Iteration 3 (72.42 s, search 72.35 s): objective=95932.9 imbalance=1.253 nsplit=0     Iteration 4 (90.50 s, search 90.43 s): objective=95934.8 imbalance=1.247 nsplit=0       
13it [23:17, 108.17s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (17.84 s, search 17.82 s): objective=95884.8 imbalance=1.380 nsplit=0     Iteration 1 (35.87 s, search 35.83 s): objective=95929.3 imbalance=1.293 nsplit=0     Iteration 2 (54.01 s, search 53.96 s): objective=95935.5 imbalance=1.264 nsplit=1     Iteration 3 (72.21 s, search 72.15 s): objective=95938.3 imbalance=1.251 nsplit=0     Iteration 4 (90.02 s, search 89.94 s): objective=95939.7 imbalance=1.245 nsplit=0       
14it [25:05, 108.00s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.63 s, search 17.61 s): objective=95893.6 imbalance=1.381 nsplit=0     Iteration 1 (35.46 s, search 35.43 s): objective=95934.2 imbalance=1.294 nsplit=0     Iteration 2 (53.40 s, search 53.35 s): objective=95939.8 imbalance=1.264 nsplit=0     Iteration 3 (71.20 s, search 71.13 s): objective=95942.2 imbalance=1.252 nsplit=0     Iteration 4 (89.14 s, search 89.06 s): objective=95943.6 imbalance=1.246 nsplit=0       
15it [26:52, 107.75s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.02 s, search 18.00 s): objective=95901 imbalance=1.382 nsplit=0       Iteration 1 (35.97 s, search 35.93 s): objective=95938.2 imbalance=1.295 nsplit=1     Iteration 2 (53.91 s, search 53.86 s): objective=95943.4 imbalance=1.266 nsplit=0     Iteration 3 (71.93 s, search 71.87 s): objective=95945.4 imbalance=1.253 nsplit=0     Iteration 4 (90.04 s, search 89.96 s): objective=95946.7 imbalance=1.247 nsplit=0       
16it [28:40, 107.87s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.17 s, search 18.14 s): objective=95906.7 imbalance=1.379 nsplit=0     Iteration 1 (36.28 s, search 36.25 s): objective=95941.2 imbalance=1.295 nsplit=0     Iteration 2 (54.31 s, search 54.26 s): objective=95945.8 imbalance=1.266 nsplit=0     Iteration 3 (72.46 s, search 72.39 s): objective=95948.1 imbalance=1.254 nsplit=0     Iteration 4 (90.78 s, search 90.70 s): objective=95949 imbalance=1.248 nsplit=0       
17it [30:29, 108.22s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.69 s, search 17.67 s): objective=95911.6 imbalance=1.380 nsplit=0     Iteration 1 (35.27 s, search 35.24 s): objective=95943.8 imbalance=1.295 nsplit=0     Iteration 2 (52.93 s, search 52.88 s): objective=95948.3 imbalance=1.269 nsplit=0     Iteration 3 (70.42 s, search 70.36 s): objective=95949.9 imbalance=1.256 nsplit=0     Iteration 4 (87.91 s, search 87.83 s): objective=95951.1 imbalance=1.250 nsplit=0       
18it [32:15, 107.38s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.66 s, search 17.65 s): objective=95915.8 imbalance=1.379 nsplit=0     Iteration 1 (35.39 s, search 35.36 s): objective=95946.2 imbalance=1.294 nsplit=0     Iteration 2 (53.35 s, search 53.30 s): objective=95950.4 imbalance=1.266 nsplit=0     Iteration 3 (71.45 s, search 71.39 s): objective=95952.1 imbalance=1.254 nsplit=0     Iteration 4 (89.72 s, search 89.64 s): objective=95953.1 imbalance=1.248 nsplit=0       
19it [34:03, 107.46s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.83 s, search 17.81 s): objective=95919.8 imbalance=1.377 nsplit=0     Iteration 1 (35.44 s, search 35.40 s): objective=95948.4 imbalance=1.294 nsplit=0     Iteration 2 (53.23 s, search 53.18 s): objective=95952.2 imbalance=1.267 nsplit=0     Iteration 3 (71.36 s, search 71.29 s): objective=95953.8 imbalance=1.255 nsplit=0     Iteration 4 (89.37 s, search 89.29 s): objective=95954.9 imbalance=1.250 nsplit=0       
20it [35:50, 107.33s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.27 s, search 17.25 s): objective=95923.2 imbalance=1.380 nsplit=0     Iteration 1 (34.89 s, search 34.86 s): objective=95950.4 imbalance=1.296 nsplit=0     Iteration 2 (52.58 s, search 52.53 s): objective=95953.9 imbalance=1.268 nsplit=0     Iteration 3 (70.19 s, search 70.12 s): objective=95955.5 imbalance=1.256 nsplit=0     Iteration 4 (87.86 s, search 87.78 s): objective=95956.4 imbalance=1.250 nsplit=0       
21it [37:36, 106.98s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.22 s, search 18.20 s): objective=95926.1 imbalance=1.383 nsplit=0     Iteration 1 (36.25 s, search 36.22 s): objective=95951.6 imbalance=1.298 nsplit=0     Iteration 2 (53.98 s, search 53.93 s): objective=95955.1 imbalance=1.269 nsplit=0     Iteration 3 (71.43 s, search 71.36 s): objective=95956.8 imbalance=1.256 nsplit=0     Iteration 4 (88.78 s, search 88.70 s): objective=95957.7 imbalance=1.250 nsplit=0       
22it [39:22, 106.79s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.76 s, search 17.74 s): objective=95928.8 imbalance=1.382 nsplit=0     Iteration 1 (35.93 s, search 35.90 s): objective=95953.1 imbalance=1.300 nsplit=0     Iteration 2 (54.09 s, search 54.05 s): objective=95956.3 imbalance=1.273 nsplit=0     Iteration 3 (72.24 s, search 72.17 s): objective=95957.9 imbalance=1.260 nsplit=0     Iteration 4 (90.36 s, search 90.29 s): objective=95958.7 imbalance=1.254 nsplit=0       
23it [41:10, 107.28s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.57 s, search 17.55 s): objective=95931.2 imbalance=1.382 nsplit=0     Iteration 1 (34.82 s, search 34.78 s): objective=95954.4 imbalance=1.300 nsplit=1     Iteration 2 (52.57 s, search 52.52 s): objective=95957.6 imbalance=1.273 nsplit=0     Iteration 3 (70.57 s, search 70.51 s): objective=95959 imbalance=1.260 nsplit=0       Iteration 4 (88.79 s, search 88.71 s): objective=95959.8 imbalance=1.254 nsplit=0       
24it [42:57, 107.10s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.76 s, search 17.74 s): objective=95933.5 imbalance=1.381 nsplit=0     Iteration 1 (35.49 s, search 35.46 s): objective=95955.8 imbalance=1.298 nsplit=0     Iteration 2 (53.30 s, search 53.25 s): objective=95958.8 imbalance=1.270 nsplit=0     Iteration 3 (71.66 s, search 71.60 s): objective=95960 imbalance=1.256 nsplit=0       Iteration 4 (89.82 s, search 89.75 s): objective=95960.8 imbalance=1.250 nsplit=0       
25it [44:45, 107.34s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (17.98 s, search 17.96 s): objective=95935.5 imbalance=1.381 nsplit=0     Iteration 1 (35.93 s, search 35.90 s): objective=95956.8 imbalance=1.297 nsplit=0     Iteration 2 (54.15 s, search 54.10 s): objective=95959.6 imbalance=1.268 nsplit=0     Iteration 3 (72.34 s, search 72.28 s): objective=95960.8 imbalance=1.255 nsplit=0     Iteration 4 (90.56 s, search 90.48 s): objective=95961.4 imbalance=1.249 nsplit=0       
26it [46:34, 107.78s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (18.18 s, search 18.16 s): objective=95937.4 imbalance=1.381 nsplit=0     Iteration 1 (36.39 s, search 36.35 s): objective=95957.7 imbalance=1.296 nsplit=0     Iteration 2 (54.62 s, search 54.57 s): objective=95960.3 imbalance=1.268 nsplit=0     Iteration 3 (72.82 s, search 72.76 s): objective=95961.6 imbalance=1.255 nsplit=0     Iteration 4 (91.00 s, search 90.92 s): objective=95962.3 imbalance=1.248 nsplit=0       
27it [48:23, 108.23s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (18.29 s, search 18.27 s): objective=95939 imbalance=1.383 nsplit=0       Iteration 1 (36.48 s, search 36.44 s): objective=95958.6 imbalance=1.296 nsplit=0     Iteration 2 (54.66 s, search 54.61 s): objective=95961.2 imbalance=1.267 nsplit=0     Iteration 3 (72.77 s, search 72.70 s): objective=95962.3 imbalance=1.255 nsplit=0     Iteration 4 (90.99 s, search 90.91 s): objective=95962.9 imbalance=1.247 nsplit=0       
28it [50:12, 108.54s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (18.18 s, search 18.16 s): objective=95940.7 imbalance=1.381 nsplit=0     Iteration 1 (36.33 s, search 36.30 s): objective=95959.5 imbalance=1.295 nsplit=1     Iteration 2 (54.41 s, search 54.37 s): objective=95962 imbalance=1.266 nsplit=0       Iteration 3 (72.15 s, search 72.09 s): objective=95963.1 imbalance=1.254 nsplit=0     Iteration 4 (89.56 s, search 89.48 s): objective=95963.7 imbalance=1.247 nsplit=0       
29it [52:00, 108.33s/it]WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 512D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (18.23 s, search 18.21 s): objective=95942.1 imbalance=1.382 nsplit=0     Iteration 1 (36.40 s, search 36.36 s): objective=95960.3 imbalance=1.298 nsplit=0     Iteration 2 (54.51 s, search 54.46 s): objective=95962.6 imbalance=1.267 nsplit=0     Iteration 3 (72.60 s, search 72.53 s): objective=95963.5 imbalance=1.254 nsplit=0     Iteration 4 (90.82 s, search 90.74 s): objective=95964 imbalance=1.249 nsplit=0       
30it [53:49, 107.66s/it]
WARNING clustering 95979 points to 9597 centroids: please provide at least 374283 training points
Clustering 95979 points in 384D to 9597 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (13.53 s, search 13.52 s): objective=87961.2 imbalance=1.410 nsplit=0     Iteration 1 (27.13 s, search 27.10 s): objective=90565.9 imbalance=1.330 nsplit=1     Iteration 2 (40.37 s, search 40.33 s): objective=90941.8 imbalance=1.307 nsplit=0     Iteration 3 (53.68 s, search 53.63 s): objective=91103.4 imbalance=1.296 nsplit=0     Iteration 4 (67.21 s, search 67.15 s): objective=91189.2 imbalance=1.291 nsplit=0       
[04:33:04] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 177 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|██████████████████████████████████████████| 7/7 [00:00<00:00, 208.57it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/bouquet/lerf/2024-11-07_112933/nerfstudio_models/step-000029999.ckpt
[2024/11/13 04:33:07 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 04:33:07 hloc INFO] Found 178 images in root /home/gtangg12/data/lerf/LERF Datasets/bouquet/bouquet/images.
[2024/11/13 04:33:07 hloc INFO] Skipping the extraction.
100%|████████████████████████████████████████████| 177/177 [00:00<00:00, 46726.57it/s]
tensor([  0,  21,  31,  36,  41,  46,  50,  62,  67,  71,  77,  86,  93, 110,
        125, 135, 142, 150, 157, 161, 165, 168, 170, 173, 175, 177]) 26
Rendering views: 26it [01:15,  2.90s/it]
0it [00:00, ?it/s]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.29 s): objective=25325.7 imbalance=1.373 nsplit=0       Iteration 1 (2.58 s, search 2.57 s): objective=25337.8 imbalance=1.294 nsplit=0       Iteration 2 (3.86 s, search 3.84 s): objective=25339.7 imbalance=1.271 nsplit=0       Iteration 3 (5.14 s, search 5.13 s): objective=25340.6 imbalance=1.261 nsplit=0       Iteration 4 (6.42 s, search 6.40 s): objective=25341 imbalance=1.255 nsplit=0       
1it [00:07,  7.72s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.57 s, search 2.56 s): objective=25328.1 imbalance=1.291 nsplit=0       Iteration 2 (3.83 s, search 3.82 s): objective=25330.6 imbalance=1.263 nsplit=0       Iteration 3 (5.06 s, search 5.04 s): objective=25331.7 imbalance=1.249 nsplit=0       Iteration 4 (6.29 s, search 6.27 s): objective=25332.3 imbalance=1.243 nsplit=0       
2it [00:15,  7.63s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.25 s, search 1.24 s): objective=25299.7 imbalance=1.377 nsplit=0       Iteration 1 (2.47 s, search 2.46 s): objective=25320.5 imbalance=1.293 nsplit=0       Iteration 2 (3.72 s, search 3.70 s): objective=25323.6 imbalance=1.267 nsplit=0       Iteration 3 (4.94 s, search 4.92 s): objective=25324.9 imbalance=1.255 nsplit=0       Iteration 4 (6.16 s, search 6.14 s): objective=25325.6 imbalance=1.248 nsplit=0       
3it [00:22,  7.52s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.23 s, search 1.22 s): objective=25292.2 imbalance=1.369 nsplit=0       Iteration 1 (2.46 s, search 2.45 s): objective=25315.6 imbalance=1.285 nsplit=0       Iteration 3 (4.89 s, search 4.87 s): objective=25320.5 imbalance=1.246 nsplit=0       Iteration 4 (6.14 s, search 6.12 s): objective=25321.4 imbalance=1.240 nsplit=0       
4it [00:30,  7.47s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.23 s, search 1.22 s): objective=25287.2 imbalance=1.366 nsplit=0       Iteration 1 (2.47 s, search 2.46 s): objective=25312.2 imbalance=1.286 nsplit=0       Iteration 3 (4.95 s, search 4.94 s): objective=25317.6 imbalance=1.253 nsplit=0       Iteration 4 (6.19 s, search 6.17 s): objective=25318.6 imbalance=1.246 nsplit=0       
5it [00:37,  7.45s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25283.4 imbalance=1.362 nsplit=0       Iteration 1 (2.56 s, search 2.55 s): objective=25309.5 imbalance=1.284 nsplit=0       Iteration 2 (3.79 s, search 3.77 s): objective=25313.6 imbalance=1.259 nsplit=0       Iteration 3 (5.02 s, search 5.00 s): objective=25315.4 imbalance=1.247 nsplit=0       Iteration 4 (6.25 s, search 6.23 s): objective=25316.3 imbalance=1.242 nsplit=0       
6it [00:44,  7.47s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.22 s, search 1.22 s): objective=25280.2 imbalance=1.371 nsplit=0       Iteration 1 (2.45 s, search 2.45 s): objective=25307.4 imbalance=1.285 nsplit=0       Iteration 2 (3.68 s, search 3.67 s): objective=25311.7 imbalance=1.262 nsplit=0       Iteration 3 (4.91 s, search 4.90 s): objective=25313.6 imbalance=1.253 nsplit=0       Iteration 4 (6.14 s, search 6.12 s): objective=25314.6 imbalance=1.248 nsplit=0       
7it [00:52,  7.44s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.22 s, search 1.22 s): objective=25277.8 imbalance=1.370 nsplit=0       Iteration 1 (2.45 s, search 2.44 s): objective=25305.5 imbalance=1.287 nsplit=0       Iteration 3 (4.90 s, search 4.88 s): objective=25312.1 imbalance=1.252 nsplit=0       Iteration 4 (6.13 s, search 6.11 s): objective=25313.1 imbalance=1.246 nsplit=0       
8it [00:59,  7.42s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.47 s, search 2.46 s): objective=25304.6 imbalance=1.288 nsplit=0       Iteration 2 (3.71 s, search 3.70 s): objective=25309.1 imbalance=1.263 nsplit=0       Iteration 4 (6.27 s, search 6.25 s): objective=25312 imbalance=1.247 nsplit=0       
9it [01:07,  7.46s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25274.6 imbalance=1.364 nsplit=0       Iteration 1 (2.56 s, search 2.55 s): objective=25303.8 imbalance=1.286 nsplit=0       Iteration 2 (3.84 s, search 3.82 s): objective=25308.1 imbalance=1.262 nsplit=0       Iteration 4 (6.38 s, search 6.36 s): objective=25311.3 imbalance=1.241 nsplit=0       
10it [01:14,  7.52s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.25 s, search 1.24 s): objective=25273.3 imbalance=1.358 nsplit=0       Iteration 1 (2.51 s, search 2.50 s): objective=25302.9 imbalance=1.282 nsplit=0       Iteration 2 (3.77 s, search 3.75 s): objective=25307.5 imbalance=1.256 nsplit=0       Iteration 3 (5.05 s, search 5.03 s): objective=25309.6 imbalance=1.246 nsplit=0       Iteration 4 (6.31 s, search 6.29 s): objective=25310.6 imbalance=1.241 nsplit=0       
11it [01:22,  7.55s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.28 s): objective=25272.5 imbalance=1.352 nsplit=0       Iteration 1 (2.58 s, search 2.57 s): objective=25302.4 imbalance=1.274 nsplit=0       Iteration 3 (5.16 s, search 5.14 s): objective=25308.9 imbalance=1.241 nsplit=0       Iteration 4 (6.44 s, search 6.42 s): objective=25309.9 imbalance=1.238 nsplit=0       
12it [01:30,  7.60s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.28 s): objective=25271.6 imbalance=1.356 nsplit=0       Iteration 1 (2.57 s, search 2.56 s): objective=25301.7 imbalance=1.277 nsplit=0       Iteration 2 (3.86 s, search 3.84 s): objective=25306.3 imbalance=1.254 nsplit=0       Iteration 3 (5.14 s, search 5.12 s): objective=25308.4 imbalance=1.244 nsplit=0       Iteration 4 (6.42 s, search 6.40 s): objective=25309.6 imbalance=1.237 nsplit=0       
13it [01:37,  7.64s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.57 s, search 2.56 s): objective=25301.2 imbalance=1.276 nsplit=0       Iteration 3 (5.14 s, search 5.13 s): objective=25308.1 imbalance=1.243 nsplit=0       Iteration 4 (6.44 s, search 6.42 s): objective=25309.3 imbalance=1.240 nsplit=0       
14it [01:45,  7.67s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25270.9 imbalance=1.354 nsplit=0       Iteration 1 (2.56 s, search 2.55 s): objective=25300.9 imbalance=1.279 nsplit=0       Iteration 2 (3.82 s, search 3.81 s): objective=25305.8 imbalance=1.258 nsplit=0       Iteration 3 (5.03 s, search 5.02 s): objective=25308.2 imbalance=1.246 nsplit=0       Iteration 4 (6.25 s, search 6.23 s): objective=25309.4 imbalance=1.242 nsplit=0       
15it [01:53,  7.61s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.22 s, search 1.22 s): objective=25270.8 imbalance=1.349 nsplit=0       Iteration 1 (2.46 s, search 2.45 s): objective=25301.1 imbalance=1.279 nsplit=0       Iteration 2 (3.75 s, search 3.74 s): objective=25305.8 imbalance=1.255 nsplit=1       Iteration 3 (5.04 s, search 5.02 s): objective=25307.9 imbalance=1.241 nsplit=0       Iteration 4 (6.33 s, search 6.31 s): objective=25309 imbalance=1.236 nsplit=0       
16it [02:00,  7.62s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.28 s): objective=25270.7 imbalance=1.355 nsplit=0       Iteration 2 (3.85 s, search 3.84 s): objective=25305.8 imbalance=1.259 nsplit=0       Iteration 3 (5.14 s, search 5.13 s): objective=25307.9 imbalance=1.250 nsplit=0       Iteration 4 (6.43 s, search 6.41 s): objective=25309 imbalance=1.246 nsplit=0       
17it [02:08,  7.64s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.25 s, search 1.24 s): objective=25270.4 imbalance=1.356 nsplit=0       Iteration 2 (3.87 s, search 3.86 s): objective=25305.9 imbalance=1.261 nsplit=0       Iteration 4 (6.45 s, search 6.42 s): objective=25309.1 imbalance=1.248 nsplit=0       
18it [02:16,  7.67s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25270.7 imbalance=1.356 nsplit=0       Iteration 1 (2.56 s, search 2.55 s): objective=25301.2 imbalance=1.281 nsplit=0       Iteration 3 (5.12 s, search 5.11 s): objective=25308.2 imbalance=1.249 nsplit=0       Iteration 4 (6.41 s, search 6.39 s): objective=25309.3 imbalance=1.243 nsplit=0       
19it [02:24,  7.69s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25271.3 imbalance=1.358 nsplit=0       Iteration 1 (2.58 s, search 2.57 s): objective=25301.7 imbalance=1.284 nsplit=0       Iteration 2 (3.86 s, search 3.85 s): objective=25306.4 imbalance=1.259 nsplit=0       Iteration 3 (5.13 s, search 5.12 s): objective=25308.6 imbalance=1.250 nsplit=0       Iteration 4 (6.41 s, search 6.39 s): objective=25309.7 imbalance=1.245 nsplit=0       
20it [02:31,  7.69s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.29 s): objective=25272.2 imbalance=1.358 nsplit=0       Iteration 1 (2.58 s, search 2.57 s): objective=25302.3 imbalance=1.282 nsplit=0       Iteration 3 (5.14 s, search 5.13 s): objective=25309.1 imbalance=1.251 nsplit=0       Iteration 4 (6.43 s, search 6.41 s): objective=25310.3 imbalance=1.247 nsplit=0       
21it [02:39,  7.70s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.28 s): objective=25273.3 imbalance=1.362 nsplit=0       Iteration 1 (2.58 s, search 2.57 s): objective=25303.1 imbalance=1.289 nsplit=0       Iteration 2 (3.86 s, search 3.85 s): objective=25307.7 imbalance=1.262 nsplit=0       Iteration 3 (5.15 s, search 5.14 s): objective=25309.8 imbalance=1.255 nsplit=0       Iteration 4 (6.44 s, search 6.42 s): objective=25311 imbalance=1.251 nsplit=0       
22it [02:47,  7.71s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.29 s, search 1.28 s): objective=25274.5 imbalance=1.362 nsplit=0       Iteration 1 (2.57 s, search 2.56 s): objective=25304.1 imbalance=1.287 nsplit=0       Iteration 2 (3.86 s, search 3.85 s): objective=25308.8 imbalance=1.265 nsplit=0       Iteration 3 (5.15 s, search 5.14 s): objective=25310.7 imbalance=1.258 nsplit=0       Iteration 4 (6.46 s, search 6.44 s): objective=25311.7 imbalance=1.256 nsplit=0       
23it [02:54,  7.73s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.28 s, search 1.27 s): objective=25275.8 imbalance=1.357 nsplit=0       Iteration 1 (2.55 s, search 2.54 s): objective=25304.9 imbalance=1.281 nsplit=0       Iteration 2 (3.82 s, search 3.81 s): objective=25309.7 imbalance=1.261 nsplit=0       Iteration 3 (5.10 s, search 5.08 s): objective=25311.6 imbalance=1.253 nsplit=0       Iteration 4 (6.38 s, search 6.36 s): objective=25312.6 imbalance=1.250 nsplit=0       
24it [03:02,  7.71s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.53 s, search 2.52 s): objective=25305.6 imbalance=1.279 nsplit=0       Iteration 2 (3.78 s, search 3.76 s): objective=25310.4 imbalance=1.261 nsplit=0       Iteration 3 (5.03 s, search 5.01 s): objective=25312.2 imbalance=1.255 nsplit=0       Iteration 4 (6.28 s, search 6.26 s): objective=25313.2 imbalance=1.253 nsplit=0       
25it [03:10,  7.66s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.24 s, search 1.23 s): objective=25278.3 imbalance=1.357 nsplit=0       Iteration 1 (2.49 s, search 2.48 s): objective=25306.5 imbalance=1.276 nsplit=0       Iteration 2 (3.73 s, search 3.71 s): objective=25311.2 imbalance=1.257 nsplit=0       Iteration 3 (4.97 s, search 4.95 s): objective=25313.2 imbalance=1.248 nsplit=0       Iteration 4 (6.21 s, search 6.19 s): objective=25314.2 imbalance=1.246 nsplit=0       
26it [03:17,  7.60s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.24 s, search 1.24 s): objective=25279.6 imbalance=1.360 nsplit=0       Iteration 1 (2.48 s, search 2.47 s): objective=25307.4 imbalance=1.277 nsplit=0       Iteration 4 (6.27 s, search 6.25 s): objective=25315.1 imbalance=1.244 nsplit=0       
27it [03:25,  7.58s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.51 s, search 2.50 s): objective=25308.4 imbalance=1.284 nsplit=0       Iteration 2 (3.77 s, search 3.75 s): objective=25312.7 imbalance=1.261 nsplit=0       Iteration 3 (5.03 s, search 5.01 s): objective=25314.8 imbalance=1.252 nsplit=0       Iteration 4 (6.29 s, search 6.27 s): objective=25315.8 imbalance=1.248 nsplit=0       
28it [03:32,  7.58s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.26 s, search 1.25 s): objective=25282.3 imbalance=1.361 nsplit=0       Iteration 1 (2.52 s, search 2.51 s): objective=25309.3 imbalance=1.284 nsplit=0       Iteration 2 (3.80 s, search 3.78 s): objective=25313.9 imbalance=1.265 nsplit=0       Iteration 3 (5.04 s, search 5.03 s): objective=25315.7 imbalance=1.256 nsplit=0       Iteration 4 (6.29 s, search 6.27 s): objective=25316.6 imbalance=1.250 nsplit=0       
29it [03:40,  7.57s/it]WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 512D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.24 s, search 1.23 s): objective=25283.6 imbalance=1.358 nsplit=0       Iteration 1 (2.48 s, search 2.47 s): objective=25310.3 imbalance=1.283 nsplit=0       Iteration 2 (3.72 s, search 3.70 s): objective=25314.6 imbalance=1.264 nsplit=1       Iteration 3 (4.96 s, search 4.94 s): objective=25316.5 imbalance=1.255 nsplit=0       Iteration 4 (6.19 s, search 6.17 s): objective=25317.5 imbalance=1.252 nsplit=0       
30it [03:47,  7.59s/it]
WARNING clustering 25357 points to 2535 centroids: please provide at least 98865 training points
Clustering 25357 points in 384D to 2535 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.85 s, search 1.85 s): objective=24793.5 imbalance=1.325 nsplit=0       Iteration 2 (2.78 s, search 2.77 s): objective=24839.9 imbalance=1.300 nsplit=0       Iteration 3 (3.70 s, search 3.69 s): objective=24858.1 imbalance=1.292 nsplit=0       Iteration 4 (4.63 s, search 4.61 s): objective=24867.7 imbalance=1.289 nsplit=0       
[04:38:21] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 380 images.
Setting up evaluation dataset...
Caching all 3 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 29.79it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/donuts/lerf/2024-11-07_120723/nerfstudio_models/step-000029999.ckpt
[2024/11/13 04:38:33 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 04:38:33 hloc INFO] Found 383 images in root /home/gtangg12/data/lerf/LERF Datasets/donuts/donuts/images.
100%|███████████████████████████████████████████████| 383/383 [00:10<00:00, 37.05it/s]
[2024/11/13 04:38:47 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 382/382 [00:00<00:00, 53171.74it/s]
tensor([  0,  36,  67, 107, 168, 206, 305, 308, 314, 321, 327, 336, 340, 341,
        362, 365, 367, 370]) 18
Rendering views: 18it [00:51,  2.85s/it]
0it [00:00, ?it/s]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17647.3 imbalance=1.376 nsplit=0       Iteration 1 (1.19 s, search 1.19 s): objective=17656.8 imbalance=1.297 nsplit=0       Iteration 2 (1.79 s, search 1.78 s): objective=17658.3 imbalance=1.274 nsplit=0       Iteration 4 (2.98 s, search 2.97 s): objective=17659.4 imbalance=1.260 nsplit=0       
1it [00:03,  3.58s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.59 s): objective=17633.3 imbalance=1.372 nsplit=0       Iteration 1 (1.19 s, search 1.19 s): objective=17647.9 imbalance=1.300 nsplit=0       Iteration 2 (1.79 s, search 1.78 s): objective=17650.1 imbalance=1.277 nsplit=0       Iteration 3 (2.39 s, search 2.38 s): objective=17651.2 imbalance=1.265 nsplit=0       Iteration 4 (3.01 s, search 3.00 s): objective=17651.9 imbalance=1.258 nsplit=0       
2it [00:07,  3.61s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.61 s): objective=17621.5 imbalance=1.362 nsplit=0       Iteration 1 (1.22 s, search 1.22 s): objective=17640.3 imbalance=1.289 nsplit=0       Iteration 2 (1.83 s, search 1.82 s): objective=17643.3 imbalance=1.266 nsplit=0       Iteration 3 (2.43 s, search 2.42 s): objective=17644.7 imbalance=1.258 nsplit=0       Iteration 4 (3.03 s, search 3.02 s): objective=17645.3 imbalance=1.252 nsplit=0       
3it [00:10,  3.63s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17615.1 imbalance=1.366 nsplit=0       Iteration 1 (1.20 s, search 1.20 s): objective=17635.9 imbalance=1.287 nsplit=0       Iteration 2 (1.80 s, search 1.79 s): objective=17639.2 imbalance=1.262 nsplit=0       Iteration 3 (2.40 s, search 2.39 s): objective=17640.8 imbalance=1.255 nsplit=0       Iteration 4 (3.01 s, search 2.99 s): objective=17641.5 imbalance=1.248 nsplit=0       
4it [00:14,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17611.6 imbalance=1.364 nsplit=0       Iteration 1 (1.20 s, search 1.20 s): objective=17633.5 imbalance=1.283 nsplit=0       Iteration 2 (1.80 s, search 1.80 s): objective=17636.9 imbalance=1.260 nsplit=0       Iteration 3 (2.40 s, search 2.39 s): objective=17638.5 imbalance=1.249 nsplit=0       Iteration 4 (3.00 s, search 2.99 s): objective=17639.4 imbalance=1.241 nsplit=0       
5it [00:18,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17609.4 imbalance=1.357 nsplit=0       Iteration 1 (1.20 s, search 1.20 s): objective=17632.1 imbalance=1.280 nsplit=0       Iteration 2 (1.81 s, search 1.80 s): objective=17635.4 imbalance=1.250 nsplit=0       Iteration 4 (3.01 s, search 3.00 s): objective=17638 imbalance=1.229 nsplit=0       
6it [00:21,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17608.1 imbalance=1.354 nsplit=0       Iteration 1 (1.21 s, search 1.20 s): objective=17631.2 imbalance=1.273 nsplit=0       Iteration 2 (1.81 s, search 1.80 s): objective=17634.6 imbalance=1.243 nsplit=0       Iteration 3 (2.41 s, search 2.39 s): objective=17636.1 imbalance=1.230 nsplit=0       Iteration 4 (3.01 s, search 2.99 s): objective=17637.1 imbalance=1.222 nsplit=0       
7it [00:25,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17607.4 imbalance=1.348 nsplit=0       Iteration 1 (1.21 s, search 1.20 s): objective=17630.7 imbalance=1.271 nsplit=0       Iteration 2 (1.80 s, search 1.79 s): objective=17634.4 imbalance=1.245 nsplit=0       Iteration 4 (3.01 s, search 2.99 s): objective=17636.8 imbalance=1.231 nsplit=0       
8it [00:28,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.61 s, search 0.60 s): objective=17607.2 imbalance=1.340 nsplit=0       Iteration 1 (1.21 s, search 1.20 s): objective=17630.7 imbalance=1.262 nsplit=0       Iteration 2 (1.82 s, search 1.81 s): objective=17634.4 imbalance=1.238 nsplit=0       Iteration 4 (3.02 s, search 3.00 s): objective=17636.9 imbalance=1.220 nsplit=0       
9it [00:32,  3.62s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17607.2 imbalance=1.345 nsplit=0       Iteration 1 (1.20 s, search 1.19 s): objective=17630.8 imbalance=1.268 nsplit=0       Iteration 2 (1.79 s, search 1.78 s): objective=17634.5 imbalance=1.241 nsplit=0       Iteration 4 (2.99 s, search 2.98 s): objective=17636.9 imbalance=1.222 nsplit=0       
10it [00:36,  3.61s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.59 s): objective=17607.2 imbalance=1.347 nsplit=0       Iteration 1 (1.19 s, search 1.19 s): objective=17630.8 imbalance=1.267 nsplit=0       Iteration 2 (1.81 s, search 1.80 s): objective=17634.4 imbalance=1.239 nsplit=0       Iteration 3 (2.44 s, search 2.43 s): objective=17636.2 imbalance=1.225 nsplit=0       Iteration 4 (3.07 s, search 3.06 s): objective=17636.9 imbalance=1.220 nsplit=0       
11it [00:39,  3.64s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17607.3 imbalance=1.341 nsplit=0       Iteration 2 (1.86 s, search 1.85 s): objective=17634.6 imbalance=1.233 nsplit=0       Iteration 3 (2.47 s, search 2.46 s): objective=17636.3 imbalance=1.222 nsplit=0       Iteration 4 (3.09 s, search 3.07 s): objective=17637.1 imbalance=1.215 nsplit=0       
12it [00:43,  3.66s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17607.3 imbalance=1.340 nsplit=0       Iteration 2 (1.85 s, search 1.84 s): objective=17634.6 imbalance=1.233 nsplit=0       Iteration 3 (2.47 s, search 2.46 s): objective=17636.2 imbalance=1.220 nsplit=0       Iteration 4 (3.09 s, search 3.08 s): objective=17637.1 imbalance=1.216 nsplit=0       
13it [00:47,  3.68s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17607.2 imbalance=1.343 nsplit=0       Iteration 1 (1.24 s, search 1.23 s): objective=17630.8 imbalance=1.263 nsplit=0       Iteration 2 (1.85 s, search 1.84 s): objective=17634.6 imbalance=1.239 nsplit=0       Iteration 3 (2.47 s, search 2.46 s): objective=17636.1 imbalance=1.227 nsplit=0       Iteration 4 (3.09 s, search 3.07 s): objective=17637 imbalance=1.223 nsplit=0       
14it [00:51,  3.69s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.24 s, search 1.23 s): objective=17630.9 imbalance=1.262 nsplit=0       Iteration 2 (1.86 s, search 1.85 s): objective=17634.6 imbalance=1.239 nsplit=0       Iteration 3 (2.48 s, search 2.47 s): objective=17636.2 imbalance=1.228 nsplit=0       Iteration 4 (3.09 s, search 3.08 s): objective=17637 imbalance=1.223 nsplit=0       
15it [00:54,  3.70s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.24 s, search 1.23 s): objective=17630.9 imbalance=1.265 nsplit=0       Iteration 2 (1.86 s, search 1.85 s): objective=17634.8 imbalance=1.243 nsplit=0       Iteration 3 (2.48 s, search 2.47 s): objective=17636.4 imbalance=1.230 nsplit=0       Iteration 4 (3.10 s, search 3.09 s): objective=17637.1 imbalance=1.224 nsplit=0       
16it [00:58,  3.71s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.24 s, search 1.23 s): objective=17630.9 imbalance=1.259 nsplit=0       Iteration 2 (1.85 s, search 1.85 s): objective=17634.9 imbalance=1.237 nsplit=0       Iteration 3 (2.47 s, search 2.46 s): objective=17636.7 imbalance=1.227 nsplit=0       Iteration 4 (3.09 s, search 3.08 s): objective=17637.5 imbalance=1.221 nsplit=0       
17it [01:02,  3.71s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 3 (2.48 s, search 2.47 s): objective=17636.6 imbalance=1.230 nsplit=0       Iteration 4 (3.10 s, search 3.08 s): objective=17637.5 imbalance=1.225 nsplit=0       
18it [01:05,  3.71s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.61 s): objective=17607.1 imbalance=1.340 nsplit=0       Iteration 1 (1.23 s, search 1.23 s): objective=17631.2 imbalance=1.266 nsplit=0       Iteration 2 (1.85 s, search 1.84 s): objective=17635.1 imbalance=1.246 nsplit=1       Iteration 3 (2.47 s, search 2.46 s): objective=17636.7 imbalance=1.236 nsplit=0       Iteration 4 (3.09 s, search 3.07 s): objective=17637.6 imbalance=1.231 nsplit=0       
19it [01:09,  3.71s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17607.2 imbalance=1.343 nsplit=0       Iteration 1 (1.24 s, search 1.23 s): objective=17631.4 imbalance=1.264 nsplit=0       Iteration 2 (1.83 s, search 1.82 s): objective=17635.2 imbalance=1.243 nsplit=0       Iteration 3 (2.43 s, search 2.42 s): objective=17636.7 imbalance=1.233 nsplit=0       Iteration 4 (3.03 s, search 3.02 s): objective=17637.6 imbalance=1.228 nsplit=0       
20it [01:13,  3.69s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.59 s, search 0.59 s): objective=17607.5 imbalance=1.340 nsplit=0       Iteration 1 (1.18 s, search 1.17 s): objective=17631.6 imbalance=1.267 nsplit=0       Iteration 2 (1.77 s, search 1.76 s): objective=17635.2 imbalance=1.242 nsplit=0       Iteration 3 (2.36 s, search 2.35 s): objective=17636.7 imbalance=1.236 nsplit=0       Iteration 4 (2.95 s, search 2.94 s): objective=17637.7 imbalance=1.232 nsplit=0       
21it [01:16,  3.65s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.60 s): objective=17607.8 imbalance=1.345 nsplit=0       Iteration 1 (1.22 s, search 1.21 s): objective=17631.8 imbalance=1.271 nsplit=0       Iteration 2 (1.84 s, search 1.83 s): objective=17635.5 imbalance=1.246 nsplit=0       Iteration 3 (2.46 s, search 2.45 s): objective=17637.1 imbalance=1.242 nsplit=0       Iteration 4 (3.08 s, search 3.07 s): objective=17638 imbalance=1.235 nsplit=0       
22it [01:20,  3.67s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17608.2 imbalance=1.348 nsplit=0       Iteration 2 (1.86 s, search 1.86 s): objective=17635.6 imbalance=1.246 nsplit=0       Iteration 3 (2.48 s, search 2.47 s): objective=17637.3 imbalance=1.235 nsplit=0       Iteration 4 (3.10 s, search 3.09 s): objective=17638.3 imbalance=1.230 nsplit=0       
23it [01:24,  3.69s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17608.4 imbalance=1.343 nsplit=0       Iteration 1 (1.24 s, search 1.24 s): objective=17632.3 imbalance=1.265 nsplit=0       Iteration 2 (1.86 s, search 1.85 s): objective=17635.9 imbalance=1.241 nsplit=0       Iteration 3 (2.48 s, search 2.47 s): objective=17637.5 imbalance=1.230 nsplit=0       Iteration 4 (3.11 s, search 3.09 s): objective=17638.4 imbalance=1.226 nsplit=0       
24it [01:27,  3.70s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.63 s, search 0.62 s): objective=17608.7 imbalance=1.338 nsplit=0       Iteration 1 (1.25 s, search 1.25 s): objective=17632.7 imbalance=1.261 nsplit=1       Iteration 2 (1.88 s, search 1.87 s): objective=17636.2 imbalance=1.236 nsplit=0       Iteration 3 (2.50 s, search 2.49 s): objective=17637.8 imbalance=1.227 nsplit=0       Iteration 4 (3.13 s, search 3.11 s): objective=17638.7 imbalance=1.222 nsplit=0       
25it [01:31,  3.72s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.25 s, search 1.24 s): objective=17632.9 imbalance=1.261 nsplit=1       Iteration 2 (1.87 s, search 1.87 s): objective=17636.4 imbalance=1.237 nsplit=0       Iteration 3 (2.50 s, search 2.49 s): objective=17637.9 imbalance=1.230 nsplit=0       Iteration 4 (3.12 s, search 3.11 s): objective=17638.8 imbalance=1.226 nsplit=0       
26it [01:35,  3.73s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.62 s, search 0.62 s): objective=17609.5 imbalance=1.344 nsplit=0       Iteration 1 (1.24 s, search 1.24 s): objective=17633.2 imbalance=1.265 nsplit=0       Iteration 2 (1.87 s, search 1.86 s): objective=17636.8 imbalance=1.242 nsplit=0       Iteration 3 (2.49 s, search 2.48 s): objective=17638.2 imbalance=1.235 nsplit=0       Iteration 4 (3.11 s, search 3.10 s): objective=17639.1 imbalance=1.230 nsplit=0       
27it [01:39,  3.73s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.28 s, search 1.27 s): objective=17633.6 imbalance=1.268 nsplit=0       Iteration 2 (1.87 s, search 1.86 s): objective=17637.1 imbalance=1.243 nsplit=0       Iteration 3 (2.47 s, search 2.46 s): objective=17638.7 imbalance=1.233 nsplit=0       Iteration 4 (3.09 s, search 3.07 s): objective=17639.5 imbalance=1.225 nsplit=0       
28it [01:42,  3.72s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.59 s, search 0.59 s): objective=17610.6 imbalance=1.351 nsplit=0       Iteration 1 (1.19 s, search 1.18 s): objective=17634.1 imbalance=1.270 nsplit=1       Iteration 2 (1.78 s, search 1.77 s): objective=17637.6 imbalance=1.245 nsplit=0       Iteration 3 (2.37 s, search 2.36 s): objective=17639.1 imbalance=1.237 nsplit=0       Iteration 4 (2.96 s, search 2.95 s): objective=17640 imbalance=1.231 nsplit=0       
29it [01:46,  3.67s/it]WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 512D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.60 s, search 0.59 s): objective=17611.1 imbalance=1.352 nsplit=0       Iteration 1 (1.19 s, search 1.19 s): objective=17634.4 imbalance=1.273 nsplit=0       Iteration 2 (1.79 s, search 1.78 s): objective=17637.9 imbalance=1.246 nsplit=0       Iteration 3 (2.38 s, search 2.37 s): objective=17639.6 imbalance=1.237 nsplit=0       Iteration 4 (2.97 s, search 2.96 s): objective=17640.4 imbalance=1.233 nsplit=0       
30it [01:50,  3.67s/it]
WARNING clustering 17674 points to 1767 centroids: please provide at least 68913 training points
Clustering 17674 points in 384D to 1767 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.44 s, search 0.44 s): objective=16643.3 imbalance=1.396 nsplit=0       Iteration 1 (0.88 s, search 0.88 s): objective=16996.8 imbalance=1.321 nsplit=0       Iteration 4 (2.21 s, search 2.20 s): objective=17078.9 imbalance=1.287 nsplit=0       
[04:41:36] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
Setting up training dataset...
Caching all 373 images.
Setting up evaluation dataset...
Caching all 3 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 31.36it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/dozer_nerfgun_waldo/lerf/2024-11-07_130106/nerfstudio_models/step-000029999.ckpt
[2024/11/13 04:41:59 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 04:41:59 hloc INFO] Found 377 images in root /home/gtangg12/data/lerf/LERF Datasets/dozer_nerfgun_waldo/dozer_nerfgun_waldo/images.
100%|███████████████████████████████████████████████| 377/377 [00:10<00:00, 35.99it/s]
[2024/11/13 04:42:13 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 375/375 [00:00<00:00, 54277.87it/s]
tensor([  0,  11,  17,  24,  29,  35,  42,  55,  64,  67,  71,  76,  78,  82,
         92, 101, 104, 110, 117, 121, 127, 132, 136, 140, 144, 157, 164, 170,
        178, 183, 186, 194, 197, 200, 205, 234, 239, 247, 252, 255, 257, 263,
        265, 280, 284, 297, 302, 305, 307, 309, 312, 316, 320, 322, 327, 329,
        353, 356, 358, 369, 373, 374, 375]) 63
Rendering views: 63it [03:21,  3.19s/it]
0it [00:00, ?it/s]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.18 s, search 8.17 s): objective=64481.1 imbalance=1.759 nsplit=0       Iteration 1 (16.06 s, search 16.03 s): objective=64492.6 imbalance=1.497 nsplit=0     Iteration 2 (23.88 s, search 23.84 s): objective=64494.5 imbalance=1.448 nsplit=0     Iteration 3 (31.74 s, search 31.69 s): objective=64495.3 imbalance=1.431 nsplit=0     Iteration 4 (39.90 s, search 39.85 s): objective=64495.7 imbalance=1.424 nsplit=0       
1it [00:47, 48.00s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.90 s, search 7.88 s): objective=64423.2 imbalance=1.928 nsplit=0       Iteration 1 (15.79 s, search 15.76 s): objective=64460.2 imbalance=1.587 nsplit=2     Iteration 2 (23.68 s, search 23.64 s): objective=64465.5 imbalance=1.535 nsplit=0     Iteration 3 (31.57 s, search 31.53 s): objective=64467.5 imbalance=1.518 nsplit=0     Iteration 4 (39.55 s, search 39.50 s): objective=64468.6 imbalance=1.509 nsplit=0       
2it [01:35, 47.73s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.08 s, search 8.06 s): objective=64346.2 imbalance=1.900 nsplit=0       Iteration 1 (16.16 s, search 16.14 s): objective=64408.9 imbalance=1.584 nsplit=0     Iteration 2 (23.95 s, search 23.91 s): objective=64417.6 imbalance=1.535 nsplit=0     Iteration 3 (31.74 s, search 31.69 s): objective=64421 imbalance=1.514 nsplit=0       Iteration 4 (39.56 s, search 39.51 s): objective=64422.7 imbalance=1.504 nsplit=0       
3it [02:22, 47.57s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.79 s, search 7.77 s): objective=64323.1 imbalance=1.830 nsplit=0       Iteration 1 (15.63 s, search 15.60 s): objective=64392.7 imbalance=1.549 nsplit=0     Iteration 2 (23.44 s, search 23.41 s): objective=64401.9 imbalance=1.502 nsplit=0     Iteration 3 (31.31 s, search 31.27 s): objective=64405.7 imbalance=1.485 nsplit=0     Iteration 4 (39.22 s, search 39.17 s): objective=64407.7 imbalance=1.480 nsplit=0       
4it [03:10, 47.40s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.90 s, search 7.89 s): objective=64328.1 imbalance=1.793 nsplit=0       Iteration 1 (15.80 s, search 15.78 s): objective=64395.9 imbalance=1.536 nsplit=1     Iteration 2 (23.70 s, search 23.67 s): objective=64405.6 imbalance=1.488 nsplit=0     Iteration 3 (31.79 s, search 31.74 s): objective=64409.2 imbalance=1.472 nsplit=0     Iteration 4 (39.89 s, search 39.83 s): objective=64411.4 imbalance=1.465 nsplit=0       
5it [03:58, 47.61s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.11 s, search 8.10 s): objective=64339.1 imbalance=1.764 nsplit=0       Iteration 1 (16.21 s, search 16.19 s): objective=64403.7 imbalance=1.514 nsplit=3     Iteration 2 (24.21 s, search 24.18 s): objective=64413 imbalance=1.470 nsplit=0       Iteration 3 (32.16 s, search 32.11 s): objective=64417 imbalance=1.454 nsplit=0       Iteration 4 (40.09 s, search 40.03 s): objective=64419 imbalance=1.446 nsplit=0       
6it [04:46, 47.76s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.94 s, search 7.92 s): objective=64348.7 imbalance=1.724 nsplit=0       Iteration 1 (15.89 s, search 15.86 s): objective=64409.4 imbalance=1.495 nsplit=1     Iteration 2 (23.93 s, search 23.90 s): objective=64418.7 imbalance=1.454 nsplit=0     Iteration 3 (32.07 s, search 32.02 s): objective=64422.7 imbalance=1.440 nsplit=0     Iteration 4 (40.20 s, search 40.14 s): objective=64424.7 imbalance=1.434 nsplit=1       
7it [05:34, 47.87s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.03 s, search 8.02 s): objective=64356.3 imbalance=1.685 nsplit=0       Iteration 1 (16.25 s, search 16.23 s): objective=64414 imbalance=1.476 nsplit=1       Iteration 2 (24.32 s, search 24.29 s): objective=64422.9 imbalance=1.434 nsplit=0     Iteration 3 (32.10 s, search 32.06 s): objective=64426.7 imbalance=1.422 nsplit=0     Iteration 4 (39.88 s, search 39.83 s): objective=64428.8 imbalance=1.416 nsplit=0       
8it [06:22, 47.91s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.83 s, search 7.82 s): objective=64362.8 imbalance=1.658 nsplit=0       Iteration 1 (15.67 s, search 15.65 s): objective=64418.2 imbalance=1.461 nsplit=1     Iteration 2 (23.96 s, search 23.93 s): objective=64426.4 imbalance=1.424 nsplit=0     Iteration 3 (32.28 s, search 32.24 s): objective=64429.9 imbalance=1.412 nsplit=0     Iteration 4 (40.61 s, search 40.56 s): objective=64431.9 imbalance=1.405 nsplit=0       
9it [07:11, 48.23s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.32 s, search 8.30 s): objective=64368.4 imbalance=1.636 nsplit=0       Iteration 1 (16.60 s, search 16.58 s): objective=64421.8 imbalance=1.446 nsplit=0     Iteration 2 (24.88 s, search 24.84 s): objective=64430 imbalance=1.412 nsplit=0       Iteration 3 (33.17 s, search 33.12 s): objective=64433.4 imbalance=1.400 nsplit=0     Iteration 4 (41.45 s, search 41.40 s): objective=64435.2 imbalance=1.394 nsplit=0       
10it [08:00, 48.71s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.29 s, search 8.28 s): objective=64373.7 imbalance=1.604 nsplit=0       Iteration 1 (16.59 s, search 16.57 s): objective=64424.8 imbalance=1.422 nsplit=0     Iteration 2 (24.88 s, search 24.84 s): objective=64432.9 imbalance=1.387 nsplit=0     Iteration 3 (33.16 s, search 33.12 s): objective=64436.4 imbalance=1.373 nsplit=0     Iteration 4 (41.43 s, search 41.37 s): objective=64438 imbalance=1.368 nsplit=0       
11it [08:50, 49.03s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.30 s, search 8.28 s): objective=64379.5 imbalance=1.585 nsplit=0       Iteration 1 (16.59 s, search 16.56 s): objective=64428.4 imbalance=1.408 nsplit=1     Iteration 2 (24.87 s, search 24.84 s): objective=64436.3 imbalance=1.375 nsplit=0     Iteration 3 (33.14 s, search 33.10 s): objective=64439.8 imbalance=1.361 nsplit=0     Iteration 4 (41.43 s, search 41.38 s): objective=64441.7 imbalance=1.355 nsplit=0       
12it [09:40, 49.24s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.30 s, search 8.29 s): objective=64384.9 imbalance=1.573 nsplit=0       Iteration 1 (16.63 s, search 16.60 s): objective=64431.7 imbalance=1.408 nsplit=0     Iteration 2 (24.93 s, search 24.89 s): objective=64439.6 imbalance=1.376 nsplit=0     Iteration 3 (33.22 s, search 33.17 s): objective=64443.2 imbalance=1.362 nsplit=0     Iteration 4 (41.52 s, search 41.46 s): objective=64445.1 imbalance=1.356 nsplit=0       
13it [10:30, 49.41s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.30 s, search 8.29 s): objective=64389.8 imbalance=1.562 nsplit=0       Iteration 1 (16.62 s, search 16.60 s): objective=64435.3 imbalance=1.405 nsplit=0     Iteration 2 (24.92 s, search 24.88 s): objective=64442.7 imbalance=1.373 nsplit=0     Iteration 3 (33.20 s, search 33.15 s): objective=64446.2 imbalance=1.363 nsplit=0     Iteration 4 (41.46 s, search 41.41 s): objective=64447.7 imbalance=1.357 nsplit=0       
14it [11:19, 49.52s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.34 s, search 8.33 s): objective=64394.3 imbalance=1.558 nsplit=0       Iteration 1 (16.66 s, search 16.64 s): objective=64438.2 imbalance=1.400 nsplit=0     Iteration 2 (25.01 s, search 24.97 s): objective=64445.6 imbalance=1.367 nsplit=0     Iteration 3 (33.31 s, search 33.26 s): objective=64448.7 imbalance=1.353 nsplit=0     Iteration 4 (41.62 s, search 41.57 s): objective=64450.1 imbalance=1.348 nsplit=0       
15it [12:09, 49.64s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (16.60 s, search 16.57 s): objective=64441.2 imbalance=1.394 nsplit=1     Iteration 2 (24.89 s, search 24.86 s): objective=64448.2 imbalance=1.361 nsplit=0     Iteration 3 (33.19 s, search 33.15 s): objective=64451 imbalance=1.348 nsplit=0       Iteration 4 (41.48 s, search 41.42 s): objective=64452.5 imbalance=1.345 nsplit=0       
16it [12:59, 49.68s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.29 s, search 8.28 s): objective=64403.4 imbalance=1.545 nsplit=0       Iteration 1 (16.56 s, search 16.53 s): objective=64444 imbalance=1.391 nsplit=0       Iteration 2 (24.85 s, search 24.82 s): objective=64450.6 imbalance=1.360 nsplit=0     Iteration 3 (33.12 s, search 33.08 s): objective=64453.5 imbalance=1.348 nsplit=0     Iteration 4 (41.41 s, search 41.36 s): objective=64455.2 imbalance=1.342 nsplit=0       
17it [13:49, 49.70s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.27 s, search 8.26 s): objective=64407.6 imbalance=1.533 nsplit=0       Iteration 1 (16.53 s, search 16.50 s): objective=64446.7 imbalance=1.384 nsplit=1     Iteration 2 (24.78 s, search 24.75 s): objective=64452.9 imbalance=1.358 nsplit=0     Iteration 3 (33.25 s, search 33.21 s): objective=64455.7 imbalance=1.346 nsplit=0     Iteration 4 (41.49 s, search 41.44 s): objective=64457.4 imbalance=1.341 nsplit=0       
18it [14:38, 49.66s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.78 s, search 7.77 s): objective=64411.9 imbalance=1.526 nsplit=0       Iteration 1 (15.61 s, search 15.58 s): objective=64449.2 imbalance=1.379 nsplit=0     Iteration 2 (23.41 s, search 23.38 s): objective=64455.3 imbalance=1.350 nsplit=0     Iteration 3 (31.30 s, search 31.25 s): objective=64458.1 imbalance=1.343 nsplit=0     Iteration 4 (39.38 s, search 39.32 s): objective=64459.7 imbalance=1.337 nsplit=0       
19it [15:26, 48.94s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.96 s, search 7.95 s): objective=64415.9 imbalance=1.518 nsplit=0       Iteration 1 (16.01 s, search 15.98 s): objective=64451.9 imbalance=1.373 nsplit=0     Iteration 2 (24.10 s, search 24.07 s): objective=64457.8 imbalance=1.345 nsplit=0     Iteration 3 (32.05 s, search 32.01 s): objective=64460.6 imbalance=1.334 nsplit=0     Iteration 4 (40.19 s, search 40.13 s): objective=64462.2 imbalance=1.327 nsplit=0       
20it [16:14, 48.76s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.03 s, search 8.02 s): objective=64419.8 imbalance=1.513 nsplit=0       Iteration 1 (16.04 s, search 16.01 s): objective=64454.3 imbalance=1.366 nsplit=0     Iteration 2 (24.09 s, search 24.05 s): objective=64460.1 imbalance=1.339 nsplit=0     Iteration 3 (32.23 s, search 32.18 s): objective=64462.9 imbalance=1.328 nsplit=0     Iteration 4 (40.49 s, search 40.44 s): objective=64464.3 imbalance=1.323 nsplit=0       
21it [17:03, 48.76s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (8.25 s, search 8.24 s): objective=64423.3 imbalance=1.515 nsplit=0       Iteration 1 (16.51 s, search 16.49 s): objective=64456.5 imbalance=1.372 nsplit=0     Iteration 2 (24.60 s, search 24.57 s): objective=64462.2 imbalance=1.344 nsplit=0     Iteration 3 (32.75 s, search 32.71 s): objective=64464.4 imbalance=1.333 nsplit=0     Iteration 4 (40.91 s, search 40.86 s): objective=64465.6 imbalance=1.327 nsplit=0       
22it [17:52, 48.81s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.90 s, search 7.89 s): objective=64426.6 imbalance=1.513 nsplit=0       Iteration 1 (15.75 s, search 15.72 s): objective=64458.5 imbalance=1.371 nsplit=0     Iteration 2 (23.57 s, search 23.54 s): objective=64464 imbalance=1.344 nsplit=0       Iteration 3 (31.33 s, search 31.29 s): objective=64466.3 imbalance=1.331 nsplit=0     Iteration 4 (39.12 s, search 39.07 s): objective=64467.5 imbalance=1.328 nsplit=0       
23it [18:39, 48.25s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.93 s, search 7.92 s): objective=64429.9 imbalance=1.511 nsplit=0       Iteration 1 (16.06 s, search 16.04 s): objective=64460.3 imbalance=1.366 nsplit=0     Iteration 2 (24.35 s, search 24.32 s): objective=64465.5 imbalance=1.338 nsplit=0     Iteration 3 (32.62 s, search 32.58 s): objective=64467.8 imbalance=1.327 nsplit=0     Iteration 4 (40.82 s, search 40.76 s): objective=64469.1 imbalance=1.324 nsplit=0       
24it [19:27, 48.41s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (15.92 s, search 15.89 s): objective=64462.3 imbalance=1.364 nsplit=0     Iteration 2 (23.96 s, search 23.92 s): objective=64467.1 imbalance=1.338 nsplit=0     Iteration 3 (32.07 s, search 32.02 s): objective=64469.4 imbalance=1.326 nsplit=0     Iteration 4 (40.17 s, search 40.11 s): objective=64470.8 imbalance=1.322 nsplit=0       
25it [20:16, 48.35s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (16.09 s, search 16.07 s): objective=64464.1 imbalance=1.363 nsplit=0     Iteration 2 (24.14 s, search 24.10 s): objective=64468.9 imbalance=1.335 nsplit=0     Iteration 3 (32.42 s, search 32.37 s): objective=64471.1 imbalance=1.324 nsplit=0     Iteration 4 (40.35 s, search 40.29 s): objective=64472.2 imbalance=1.319 nsplit=0       
26it [21:04, 48.31s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (15.69 s, search 15.66 s): objective=64466 imbalance=1.363 nsplit=1       Iteration 2 (23.54 s, search 23.50 s): objective=64470.4 imbalance=1.334 nsplit=0     Iteration 3 (31.38 s, search 31.34 s): objective=64472.4 imbalance=1.321 nsplit=0     Iteration 4 (39.42 s, search 39.37 s): objective=64473.6 imbalance=1.315 nsplit=0       
27it [21:51, 48.02s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.96 s, search 7.94 s): objective=64441.7 imbalance=1.498 nsplit=0       Iteration 1 (16.07 s, search 16.05 s): objective=64467.8 imbalance=1.363 nsplit=1     Iteration 2 (24.10 s, search 24.07 s): objective=64472.2 imbalance=1.335 nsplit=0     Iteration 3 (32.01 s, search 31.97 s): objective=64473.9 imbalance=1.324 nsplit=0     Iteration 4 (40.23 s, search 40.18 s): objective=64475.1 imbalance=1.319 nsplit=0       
28it [22:40, 48.14s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.97 s, search 7.95 s): objective=64444.2 imbalance=1.499 nsplit=0       Iteration 1 (15.90 s, search 15.87 s): objective=64469.5 imbalance=1.364 nsplit=0     Iteration 2 (23.82 s, search 23.79 s): objective=64473.6 imbalance=1.332 nsplit=0     Iteration 3 (31.75 s, search 31.71 s): objective=64475.4 imbalance=1.320 nsplit=0     Iteration 4 (39.68 s, search 39.62 s): objective=64476.4 imbalance=1.316 nsplit=0       
29it [23:27, 47.96s/it]WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 512D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (7.88 s, search 7.87 s): objective=64446.6 imbalance=1.497 nsplit=0       Iteration 1 (15.75 s, search 15.72 s): objective=64470.9 imbalance=1.361 nsplit=0     Iteration 2 (23.86 s, search 23.83 s): objective=64475 imbalance=1.330 nsplit=0       Iteration 3 (32.09 s, search 32.05 s): objective=64476.8 imbalance=1.319 nsplit=0     Iteration 4 (40.37 s, search 40.32 s): objective=64477.7 imbalance=1.313 nsplit=0       
30it [24:16, 48.54s/it]
WARNING clustering 64509 points to 6450 centroids: please provide at least 251550 training points
Clustering 64509 points in 384D to 6450 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (5.93 s, search 5.92 s): objective=62592.2 imbalance=2.716 nsplit=0       Iteration 1 (11.82 s, search 11.80 s): objective=63148 imbalance=1.919 nsplit=0       Iteration 2 (17.73 s, search 17.71 s): objective=63219.6 imbalance=1.827 nsplit=0     Iteration 3 (23.56 s, search 23.53 s): objective=63249 imbalance=1.798 nsplit=0       Iteration 4 (29.39 s, search 29.35 s): objective=63264.6 imbalance=1.786 nsplit=0       
[05:10:39] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 260 images.
Setting up evaluation dataset...
Caching all 2 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 41.75it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/espresso/lerf/2024-11-07_134613/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:10:48 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:10:48 hloc INFO] Found 262 images in root /home/gtangg12/data/lerf/LERF Datasets/espresso/espresso/images.
100%|███████████████████████████████████████████████| 262/262 [00:06<00:00, 37.58it/s]
[2024/11/13 05:10:59 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 261/261 [00:00<00:00, 47550.75it/s]
tensor([  0,  23,  32,  39,  43,  47,  53,  64,  90,  99, 112, 117, 123, 125,
        133, 139, 142, 160, 165, 171, 177, 182, 187, 191, 196, 201, 206, 213,
        216, 219, 222, 228, 230, 234, 239, 241, 245, 249, 251, 252, 255, 257,
        260, 261]) 44
Rendering views: 44it [02:05,  2.84s/it]
0it [00:00, ?it/s]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.52 s, search 3.51 s): objective=43178.9 imbalance=1.396 nsplit=0       Iteration 1 (7.05 s, search 7.03 s): objective=43194.6 imbalance=1.306 nsplit=0       Iteration 2 (10.58 s, search 10.55 s): objective=43196.6 imbalance=1.273 nsplit=0     Iteration 3 (14.11 s, search 14.08 s): objective=43197.7 imbalance=1.257 nsplit=0     Iteration 4 (17.77 s, search 17.74 s): objective=43198.2 imbalance=1.250 nsplit=0       
1it [00:21, 21.42s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.51 s, search 3.50 s): objective=43115.2 imbalance=1.382 nsplit=0       Iteration 2 (10.56 s, search 10.54 s): objective=43159.1 imbalance=1.271 nsplit=0     Iteration 3 (14.09 s, search 14.06 s): objective=43161.8 imbalance=1.259 nsplit=0     Iteration 4 (17.62 s, search 17.58 s): objective=43163.1 imbalance=1.252 nsplit=0       
2it [00:42, 21.27s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.51 s, search 3.50 s): objective=43094.5 imbalance=1.375 nsplit=0       Iteration 1 (7.04 s, search 7.02 s): objective=43138.4 imbalance=1.286 nsplit=0       Iteration 2 (10.56 s, search 10.54 s): objective=43145.7 imbalance=1.261 nsplit=0     Iteration 3 (14.09 s, search 14.06 s): objective=43149.1 imbalance=1.253 nsplit=0     Iteration 4 (17.62 s, search 17.58 s): objective=43150.8 imbalance=1.249 nsplit=0       
3it [01:03, 21.22s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (7.05 s, search 7.04 s): objective=43140.9 imbalance=1.281 nsplit=0       Iteration 2 (10.58 s, search 10.56 s): objective=43147.6 imbalance=1.256 nsplit=0     Iteration 3 (14.12 s, search 14.09 s): objective=43150.6 imbalance=1.244 nsplit=0     Iteration 4 (17.65 s, search 17.61 s): objective=43152.2 imbalance=1.239 nsplit=0       
4it [01:25, 21.27s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (7.43 s, search 7.41 s): objective=43147.1 imbalance=1.287 nsplit=0       Iteration 2 (11.13 s, search 11.10 s): objective=43153.3 imbalance=1.260 nsplit=0     Iteration 3 (14.80 s, search 14.77 s): objective=43156.2 imbalance=1.248 nsplit=0     Iteration 4 (18.50 s, search 18.47 s): objective=43157.7 imbalance=1.242 nsplit=0       
5it [01:47, 21.61s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.72 s, search 3.71 s): objective=43116.5 imbalance=1.370 nsplit=0       Iteration 1 (7.44 s, search 7.42 s): objective=43152.9 imbalance=1.281 nsplit=0       Iteration 2 (11.15 s, search 11.13 s): objective=43158.6 imbalance=1.254 nsplit=0     Iteration 3 (14.85 s, search 14.82 s): objective=43161.2 imbalance=1.243 nsplit=0     Iteration 4 (18.58 s, search 18.54 s): objective=43162.7 imbalance=1.235 nsplit=0       
6it [02:09, 21.86s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.75 s, search 3.74 s): objective=43125.8 imbalance=1.365 nsplit=0       Iteration 2 (11.23 s, search 11.21 s): objective=43164.3 imbalance=1.250 nsplit=0     Iteration 3 (14.96 s, search 14.93 s): objective=43166.7 imbalance=1.240 nsplit=0     Iteration 4 (18.69 s, search 18.66 s): objective=43168 imbalance=1.235 nsplit=0       
7it [02:32, 22.05s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.67 s, search 3.67 s): objective=43134.5 imbalance=1.368 nsplit=0       Iteration 1 (7.35 s, search 7.33 s): objective=43164.5 imbalance=1.279 nsplit=0       Iteration 2 (11.02 s, search 10.99 s): objective=43169.1 imbalance=1.254 nsplit=0     Iteration 3 (14.67 s, search 14.64 s): objective=43171.3 imbalance=1.243 nsplit=1     Iteration 4 (18.34 s, search 18.31 s): objective=43172.5 imbalance=1.237 nsplit=0       
8it [02:54, 22.05s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.71 s, search 3.71 s): objective=43142.1 imbalance=1.371 nsplit=0       Iteration 1 (7.53 s, search 7.51 s): objective=43169.4 imbalance=1.284 nsplit=0       Iteration 2 (11.24 s, search 11.21 s): objective=43173.3 imbalance=1.260 nsplit=0     Iteration 3 (14.95 s, search 14.92 s): objective=43175.3 imbalance=1.249 nsplit=0     Iteration 4 (18.65 s, search 18.62 s): objective=43176.4 imbalance=1.244 nsplit=0       
9it [03:16, 22.15s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.69 s, search 3.68 s): objective=43148.9 imbalance=1.379 nsplit=0       Iteration 1 (7.39 s, search 7.37 s): objective=43173.6 imbalance=1.289 nsplit=0       Iteration 2 (11.10 s, search 11.07 s): objective=43177.3 imbalance=1.266 nsplit=0     Iteration 3 (14.80 s, search 14.77 s): objective=43179 imbalance=1.255 nsplit=0       Iteration 4 (18.48 s, search 18.44 s): objective=43180.1 imbalance=1.250 nsplit=0       
10it [03:38, 22.17s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.70 s, search 3.69 s): objective=43154.8 imbalance=1.381 nsplit=0       Iteration 1 (7.41 s, search 7.40 s): objective=43177.2 imbalance=1.289 nsplit=0       Iteration 2 (11.11 s, search 11.09 s): objective=43180.6 imbalance=1.264 nsplit=0     Iteration 3 (14.81 s, search 14.78 s): objective=43182.2 imbalance=1.254 nsplit=0     Iteration 4 (18.52 s, search 18.48 s): objective=43183 imbalance=1.249 nsplit=0       
11it [04:00, 22.19s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.69 s, search 3.68 s): objective=43159.7 imbalance=1.380 nsplit=0       Iteration 1 (7.39 s, search 7.37 s): objective=43180.4 imbalance=1.292 nsplit=0       Iteration 2 (11.13 s, search 11.11 s): objective=43183.4 imbalance=1.266 nsplit=0     Iteration 3 (14.83 s, search 14.81 s): objective=43184.9 imbalance=1.255 nsplit=0     Iteration 4 (18.52 s, search 18.49 s): objective=43185.6 imbalance=1.250 nsplit=0       
12it [04:23, 22.20s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.67 s, search 3.66 s): objective=43163.9 imbalance=1.381 nsplit=0       Iteration 1 (7.35 s, search 7.33 s): objective=43183.1 imbalance=1.291 nsplit=0       Iteration 2 (11.04 s, search 11.02 s): objective=43186 imbalance=1.267 nsplit=0       Iteration 3 (14.73 s, search 14.70 s): objective=43187.2 imbalance=1.259 nsplit=1     Iteration 4 (18.41 s, search 18.38 s): objective=43187.8 imbalance=1.254 nsplit=0       
13it [04:45, 22.16s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.67 s, search 3.66 s): objective=43167.7 imbalance=1.388 nsplit=0       Iteration 1 (7.35 s, search 7.34 s): objective=43185.3 imbalance=1.292 nsplit=0       Iteration 2 (10.96 s, search 10.93 s): objective=43188 imbalance=1.266 nsplit=0       Iteration 3 (14.54 s, search 14.51 s): objective=43189.2 imbalance=1.256 nsplit=0     Iteration 4 (18.10 s, search 18.06 s): objective=43189.8 imbalance=1.254 nsplit=0       
14it [05:06, 22.01s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.54 s, search 3.53 s): objective=43171.1 imbalance=1.388 nsplit=0       Iteration 1 (7.08 s, search 7.06 s): objective=43187.2 imbalance=1.295 nsplit=0       Iteration 2 (10.63 s, search 10.60 s): objective=43189.7 imbalance=1.269 nsplit=0     Iteration 3 (14.17 s, search 14.14 s): objective=43190.7 imbalance=1.258 nsplit=0     Iteration 4 (17.71 s, search 17.68 s): objective=43191.3 imbalance=1.252 nsplit=0       
15it [05:28, 21.79s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.54 s, search 3.53 s): objective=43174.3 imbalance=1.386 nsplit=0       Iteration 1 (7.09 s, search 7.07 s): objective=43189.2 imbalance=1.299 nsplit=0       Iteration 2 (10.65 s, search 10.63 s): objective=43191.4 imbalance=1.270 nsplit=0     Iteration 3 (14.20 s, search 14.17 s): objective=43192.3 imbalance=1.258 nsplit=0     Iteration 4 (17.84 s, search 17.81 s): objective=43192.8 imbalance=1.253 nsplit=0       
16it [05:49, 21.70s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (7.30 s, search 7.29 s): objective=43190.9 imbalance=1.295 nsplit=0       Iteration 2 (10.95 s, search 10.92 s): objective=43193 imbalance=1.266 nsplit=0       Iteration 3 (14.61 s, search 14.58 s): objective=43194 imbalance=1.257 nsplit=0       Iteration 4 (18.33 s, search 18.29 s): objective=43194.6 imbalance=1.253 nsplit=0       
17it [06:11, 21.81s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.70 s, search 3.69 s): objective=43179.3 imbalance=1.381 nsplit=0       Iteration 1 (7.41 s, search 7.39 s): objective=43192.2 imbalance=1.289 nsplit=0       Iteration 2 (11.11 s, search 11.09 s): objective=43194.1 imbalance=1.263 nsplit=0     Iteration 3 (14.80 s, search 14.77 s): objective=43195.1 imbalance=1.252 nsplit=0     Iteration 4 (18.47 s, search 18.43 s): objective=43195.7 imbalance=1.248 nsplit=0       
18it [06:33, 21.91s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.66 s, search 3.65 s): objective=43181.4 imbalance=1.379 nsplit=0       Iteration 1 (7.32 s, search 7.30 s): objective=43193.5 imbalance=1.289 nsplit=0       Iteration 2 (10.98 s, search 10.96 s): objective=43195.3 imbalance=1.266 nsplit=0     Iteration 3 (14.66 s, search 14.63 s): objective=43196.2 imbalance=1.255 nsplit=0     Iteration 4 (18.34 s, search 18.30 s): objective=43196.7 imbalance=1.251 nsplit=0       
19it [06:55, 21.95s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.68 s, search 3.67 s): objective=43183.6 imbalance=1.378 nsplit=0       Iteration 1 (7.34 s, search 7.32 s): objective=43194.7 imbalance=1.294 nsplit=1       Iteration 2 (10.95 s, search 10.93 s): objective=43196.4 imbalance=1.268 nsplit=0     Iteration 3 (14.43 s, search 14.40 s): objective=43197.2 imbalance=1.258 nsplit=0     Iteration 4 (17.92 s, search 17.88 s): objective=43197.6 imbalance=1.252 nsplit=0       
20it [07:17, 21.79s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.49 s, search 3.49 s): objective=43185.4 imbalance=1.381 nsplit=0       Iteration 1 (6.99 s, search 6.97 s): objective=43195.7 imbalance=1.299 nsplit=0       Iteration 2 (10.48 s, search 10.45 s): objective=43197.4 imbalance=1.271 nsplit=0     Iteration 3 (13.97 s, search 13.94 s): objective=43198.2 imbalance=1.258 nsplit=0     Iteration 4 (17.47 s, search 17.44 s): objective=43198.5 imbalance=1.253 nsplit=0       
21it [07:38, 21.55s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (7.00 s, search 6.99 s): objective=43196.7 imbalance=1.295 nsplit=0       Iteration 2 (10.50 s, search 10.48 s): objective=43198.3 imbalance=1.268 nsplit=1     Iteration 3 (14.00 s, search 13.98 s): objective=43198.9 imbalance=1.256 nsplit=0     Iteration 4 (17.49 s, search 17.46 s): objective=43199.2 imbalance=1.249 nsplit=0       
22it [07:59, 21.39s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.49 s, search 3.49 s): objective=43188.4 imbalance=1.388 nsplit=0       Iteration 1 (6.99 s, search 6.97 s): objective=43197.5 imbalance=1.297 nsplit=0       Iteration 2 (10.63 s, search 10.60 s): objective=43199 imbalance=1.268 nsplit=0       Iteration 3 (14.13 s, search 14.10 s): objective=43199.5 imbalance=1.256 nsplit=0     Iteration 4 (17.81 s, search 17.78 s): objective=43199.9 imbalance=1.250 nsplit=0       
23it [08:20, 21.42s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.66 s, search 3.65 s): objective=43189.7 imbalance=1.389 nsplit=0       Iteration 1 (7.29 s, search 7.27 s): objective=43198.3 imbalance=1.296 nsplit=0       Iteration 2 (10.83 s, search 10.81 s): objective=43199.5 imbalance=1.268 nsplit=0     Iteration 3 (14.34 s, search 14.31 s): objective=43200.1 imbalance=1.257 nsplit=0     Iteration 4 (17.85 s, search 17.81 s): objective=43200.5 imbalance=1.253 nsplit=0       
24it [08:42, 21.41s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.53 s, search 3.52 s): objective=43190.8 imbalance=1.392 nsplit=0       Iteration 1 (7.08 s, search 7.07 s): objective=43198.9 imbalance=1.301 nsplit=0       Iteration 2 (10.57 s, search 10.55 s): objective=43200.1 imbalance=1.273 nsplit=0     Iteration 3 (14.04 s, search 14.01 s): objective=43200.7 imbalance=1.261 nsplit=0     Iteration 4 (17.53 s, search 17.50 s): objective=43201 imbalance=1.256 nsplit=0       
25it [09:03, 21.31s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.48 s, search 3.48 s): objective=43191.8 imbalance=1.395 nsplit=0       Iteration 1 (7.03 s, search 7.01 s): objective=43199.4 imbalance=1.304 nsplit=0       Iteration 2 (10.64 s, search 10.62 s): objective=43200.5 imbalance=1.277 nsplit=0     Iteration 3 (14.23 s, search 14.20 s): objective=43201 imbalance=1.264 nsplit=0       Iteration 4 (17.79 s, search 17.75 s): objective=43201.3 imbalance=1.258 nsplit=0       
26it [09:24, 21.32s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.57 s, search 3.56 s): objective=43192.7 imbalance=1.393 nsplit=0       Iteration 1 (7.13 s, search 7.11 s): objective=43199.9 imbalance=1.303 nsplit=1       Iteration 2 (10.69 s, search 10.67 s): objective=43201 imbalance=1.273 nsplit=0       Iteration 3 (14.24 s, search 14.21 s): objective=43201.4 imbalance=1.262 nsplit=0     Iteration 4 (17.82 s, search 17.78 s): objective=43201.8 imbalance=1.257 nsplit=0       
27it [09:46, 21.34s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.57 s, search 3.56 s): objective=43193.5 imbalance=1.397 nsplit=0       Iteration 1 (7.14 s, search 7.12 s): objective=43200.4 imbalance=1.305 nsplit=0       Iteration 2 (10.70 s, search 10.68 s): objective=43201.4 imbalance=1.273 nsplit=0     Iteration 3 (14.26 s, search 14.23 s): objective=43201.9 imbalance=1.261 nsplit=0     Iteration 4 (17.82 s, search 17.78 s): objective=43202.2 imbalance=1.255 nsplit=0       
28it [10:07, 21.36s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.55 s, search 3.54 s): objective=43194.2 imbalance=1.393 nsplit=0       Iteration 1 (7.11 s, search 7.09 s): objective=43200.8 imbalance=1.303 nsplit=0       Iteration 2 (10.67 s, search 10.65 s): objective=43201.8 imbalance=1.274 nsplit=0     Iteration 3 (14.24 s, search 14.21 s): objective=43202.2 imbalance=1.261 nsplit=0     Iteration 4 (17.81 s, search 17.77 s): objective=43202.5 imbalance=1.256 nsplit=0       
29it [10:28, 21.37s/it]WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 512D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.57 s, search 3.56 s): objective=43194.8 imbalance=1.393 nsplit=0       Iteration 1 (7.14 s, search 7.12 s): objective=43201.1 imbalance=1.303 nsplit=1       Iteration 2 (10.70 s, search 10.68 s): objective=43202.2 imbalance=1.274 nsplit=0     Iteration 3 (14.27 s, search 14.24 s): objective=43202.6 imbalance=1.261 nsplit=0     Iteration 4 (17.84 s, search 17.81 s): objective=43202.9 imbalance=1.254 nsplit=0       
30it [10:50, 21.68s/it]
WARNING clustering 43210 points to 4321 centroids: please provide at least 168519 training points
Clustering 43210 points in 384D to 4321 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (2.61 s, search 2.60 s): objective=40967.7 imbalance=1.444 nsplit=0       Iteration 1 (5.22 s, search 5.21 s): objective=41733.5 imbalance=1.355 nsplit=0       Iteration 2 (7.85 s, search 7.83 s): objective=41831.9 imbalance=1.329 nsplit=0       Iteration 3 (10.53 s, search 10.51 s): objective=41876.1 imbalance=1.317 nsplit=0     Iteration 4 (13.19 s, search 13.16 s): objective=41899.3 imbalance=1.313 nsplit=0       
[05:24:18] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 302 images.
Setting up evaluation dataset...
Caching all 3 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 37.46it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/figurines/lerf/2024-11-07_143841/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:24:30 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:24:30 hloc INFO] Found 305 images in root /home/gtangg12/data/lerf/LERF Datasets/figurines/figurines/images.
100%|███████████████████████████████████████████████| 305/305 [00:08<00:00, 37.89it/s]
[2024/11/13 05:24:42 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 304/304 [00:00<00:00, 51403.69it/s]
tensor([  0,   6,  23,  26,  30,  35,  52,  58,  66,  72,  76,  84,  89,  94,
        100, 108, 115, 122, 130, 142, 146, 154, 161, 170, 181, 191, 196, 200,
        211, 215, 220, 228, 234, 243, 248, 251, 259, 263, 265, 268, 272, 277,
        281, 284, 289, 291, 295, 300, 302, 304]) 50
Rendering views: 50it [02:19,  2.78s/it]
0it [00:00, ?it/s]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.16 s, search 9.14 s): objective=49021.8 imbalance=1.315 nsplit=0       Iteration 2 (13.80 s, search 13.77 s): objective=49025 imbalance=1.287 nsplit=0       Iteration 3 (18.49 s, search 18.46 s): objective=49026.3 imbalance=1.277 nsplit=0     Iteration 4 (23.22 s, search 23.18 s): objective=49027 imbalance=1.272 nsplit=0       
1it [00:27, 27.76s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.50 s, search 4.49 s): objective=48962.3 imbalance=1.409 nsplit=0       Iteration 1 (9.00 s, search 8.99 s): objective=48996.6 imbalance=1.319 nsplit=0       Iteration 2 (13.50 s, search 13.47 s): objective=49001.9 imbalance=1.295 nsplit=0     Iteration 3 (17.99 s, search 17.96 s): objective=49004.3 imbalance=1.287 nsplit=0     Iteration 4 (22.47 s, search 22.43 s): objective=49005.7 imbalance=1.282 nsplit=1       
2it [00:54, 27.29s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.53 s, search 4.52 s): objective=48932.3 imbalance=1.401 nsplit=0       Iteration 1 (9.17 s, search 9.15 s): objective=48975.3 imbalance=1.315 nsplit=0       Iteration 2 (13.87 s, search 13.84 s): objective=48982.4 imbalance=1.287 nsplit=0     Iteration 3 (18.56 s, search 18.53 s): objective=48985.5 imbalance=1.275 nsplit=0     Iteration 4 (23.26 s, search 23.22 s): objective=48987.2 imbalance=1.270 nsplit=0       
3it [01:22, 27.61s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.70 s, search 4.69 s): objective=48914.2 imbalance=1.405 nsplit=0       Iteration 1 (9.32 s, search 9.30 s): objective=48962.2 imbalance=1.316 nsplit=0       Iteration 2 (13.94 s, search 13.92 s): objective=48970.1 imbalance=1.286 nsplit=0     Iteration 3 (18.63 s, search 18.60 s): objective=48973.7 imbalance=1.273 nsplit=0     Iteration 4 (23.32 s, search 23.28 s): objective=48975.8 imbalance=1.268 nsplit=0       
4it [01:50, 27.78s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.73 s, search 4.72 s): objective=48903.9 imbalance=1.411 nsplit=0       Iteration 1 (9.47 s, search 9.45 s): objective=48955.3 imbalance=1.319 nsplit=0       Iteration 2 (14.22 s, search 14.19 s): objective=48963.4 imbalance=1.290 nsplit=0     Iteration 3 (18.95 s, search 18.92 s): objective=48967.2 imbalance=1.278 nsplit=0     Iteration 4 (23.65 s, search 23.61 s): objective=48969.4 imbalance=1.271 nsplit=0       
5it [02:19, 27.97s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.63 s, search 4.62 s): objective=48901.3 imbalance=1.411 nsplit=0       Iteration 2 (14.03 s, search 14.01 s): objective=48961.6 imbalance=1.285 nsplit=0     Iteration 3 (18.74 s, search 18.70 s): objective=48965.6 imbalance=1.271 nsplit=0     Iteration 4 (23.43 s, search 23.38 s): objective=48968 imbalance=1.266 nsplit=0       
6it [02:47, 28.02s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.61 s, search 4.60 s): objective=48901.7 imbalance=1.408 nsplit=0       Iteration 1 (9.15 s, search 9.13 s): objective=48953.3 imbalance=1.309 nsplit=0       Iteration 2 (13.66 s, search 13.63 s): objective=48962 imbalance=1.280 nsplit=0       Iteration 3 (18.14 s, search 18.11 s): objective=48965.8 imbalance=1.266 nsplit=0     Iteration 4 (22.87 s, search 22.83 s): objective=48968.2 imbalance=1.260 nsplit=0       
7it [03:14, 27.88s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.68 s, search 4.67 s): objective=48903.9 imbalance=1.402 nsplit=0       Iteration 1 (9.21 s, search 9.19 s): objective=48955.4 imbalance=1.309 nsplit=0       Iteration 2 (13.82 s, search 13.79 s): objective=48964 imbalance=1.281 nsplit=0       Iteration 3 (18.34 s, search 18.31 s): objective=48967.8 imbalance=1.269 nsplit=0     Iteration 4 (22.90 s, search 22.86 s): objective=48969.9 imbalance=1.262 nsplit=0       
8it [03:42, 27.74s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.53 s, search 4.52 s): objective=48906.1 imbalance=1.397 nsplit=0       Iteration 1 (9.07 s, search 9.05 s): objective=48957.2 imbalance=1.303 nsplit=0       Iteration 2 (13.72 s, search 13.70 s): objective=48965.4 imbalance=1.277 nsplit=0     Iteration 3 (18.45 s, search 18.41 s): objective=48969.5 imbalance=1.266 nsplit=0     Iteration 4 (23.15 s, search 23.11 s): objective=48971.5 imbalance=1.261 nsplit=0       
9it [04:10, 27.79s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.66 s, search 4.65 s): objective=48907.6 imbalance=1.396 nsplit=0       Iteration 1 (9.26 s, search 9.24 s): objective=48958.5 imbalance=1.306 nsplit=0       Iteration 2 (13.98 s, search 13.95 s): objective=48966.7 imbalance=1.278 nsplit=0     Iteration 3 (18.63 s, search 18.60 s): objective=48970.3 imbalance=1.266 nsplit=0     Iteration 4 (23.16 s, search 23.12 s): objective=48972.4 imbalance=1.259 nsplit=0       
10it [04:37, 27.75s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.04 s, search 9.02 s): objective=48959.7 imbalance=1.309 nsplit=0       Iteration 2 (13.56 s, search 13.54 s): objective=48967.6 imbalance=1.282 nsplit=0     Iteration 3 (18.07 s, search 18.04 s): objective=48971.6 imbalance=1.270 nsplit=0     Iteration 4 (22.59 s, search 22.55 s): objective=48973.4 imbalance=1.263 nsplit=0       
11it [05:04, 27.57s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.65 s, search 4.64 s): objective=48910.5 imbalance=1.396 nsplit=0       Iteration 2 (14.05 s, search 14.03 s): objective=48968.7 imbalance=1.279 nsplit=0     Iteration 3 (18.81 s, search 18.78 s): objective=48972.2 imbalance=1.269 nsplit=0     Iteration 4 (23.43 s, search 23.39 s): objective=48974.3 imbalance=1.263 nsplit=0       
12it [05:32, 27.70s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.56 s, search 4.55 s): objective=48911.8 imbalance=1.391 nsplit=0       Iteration 1 (9.11 s, search 9.09 s): objective=48962.1 imbalance=1.307 nsplit=0       Iteration 2 (13.69 s, search 13.67 s): objective=48970 imbalance=1.278 nsplit=0       Iteration 3 (18.25 s, search 18.22 s): objective=48973.6 imbalance=1.266 nsplit=0     Iteration 4 (22.83 s, search 22.78 s): objective=48975.5 imbalance=1.259 nsplit=0       
13it [06:00, 27.62s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.58 s, search 4.57 s): objective=48913.2 imbalance=1.392 nsplit=0       Iteration 1 (9.17 s, search 9.15 s): objective=48963.2 imbalance=1.304 nsplit=1       Iteration 2 (13.75 s, search 13.72 s): objective=48971.2 imbalance=1.274 nsplit=0     Iteration 3 (18.32 s, search 18.28 s): objective=48974.9 imbalance=1.264 nsplit=0     Iteration 4 (22.89 s, search 22.85 s): objective=48977 imbalance=1.258 nsplit=0       
14it [06:27, 27.58s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.57 s, search 4.56 s): objective=48914.7 imbalance=1.389 nsplit=0       Iteration 1 (9.15 s, search 9.13 s): objective=48964.4 imbalance=1.305 nsplit=1       Iteration 2 (13.74 s, search 13.71 s): objective=48972.6 imbalance=1.274 nsplit=0     Iteration 3 (18.29 s, search 18.25 s): objective=48976.1 imbalance=1.262 nsplit=0     Iteration 4 (22.84 s, search 22.80 s): objective=48978 imbalance=1.256 nsplit=0       
15it [06:55, 27.52s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.55 s, search 4.54 s): objective=48916.1 imbalance=1.388 nsplit=0       Iteration 1 (9.09 s, search 9.07 s): objective=48965.4 imbalance=1.304 nsplit=0       Iteration 2 (13.63 s, search 13.61 s): objective=48973.3 imbalance=1.276 nsplit=0     Iteration 3 (18.18 s, search 18.15 s): objective=48977 imbalance=1.265 nsplit=0       Iteration 4 (22.73 s, search 22.69 s): objective=48978.9 imbalance=1.260 nsplit=0       
16it [07:22, 27.49s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.66 s, search 4.65 s): objective=48917.7 imbalance=1.389 nsplit=0       Iteration 1 (9.35 s, search 9.33 s): objective=48966.1 imbalance=1.305 nsplit=1       Iteration 2 (14.03 s, search 14.01 s): objective=48973.8 imbalance=1.277 nsplit=0     Iteration 3 (18.69 s, search 18.66 s): objective=48977.3 imbalance=1.263 nsplit=0     Iteration 4 (23.36 s, search 23.32 s): objective=48979.2 imbalance=1.257 nsplit=0       
17it [07:50, 27.66s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.67 s, search 4.66 s): objective=48918.5 imbalance=1.385 nsplit=0       Iteration 2 (13.86 s, search 13.84 s): objective=48974.5 imbalance=1.280 nsplit=0     Iteration 3 (18.42 s, search 18.39 s): objective=48977.8 imbalance=1.270 nsplit=0     Iteration 4 (22.97 s, search 22.93 s): objective=48979.7 imbalance=1.263 nsplit=0       
18it [08:18, 27.63s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.57 s, search 4.56 s): objective=48919.1 imbalance=1.383 nsplit=0       Iteration 1 (9.10 s, search 9.08 s): objective=48967.4 imbalance=1.302 nsplit=1       Iteration 2 (13.63 s, search 13.60 s): objective=48975 imbalance=1.275 nsplit=0       Iteration 3 (18.20 s, search 18.17 s): objective=48978.4 imbalance=1.265 nsplit=0     Iteration 4 (22.77 s, search 22.73 s): objective=48980.2 imbalance=1.260 nsplit=0       
19it [08:45, 27.54s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.57 s, search 4.56 s): objective=48919.5 imbalance=1.379 nsplit=0       Iteration 1 (9.15 s, search 9.13 s): objective=48967.9 imbalance=1.295 nsplit=1       Iteration 2 (13.71 s, search 13.69 s): objective=48975.4 imbalance=1.270 nsplit=0     Iteration 3 (18.44 s, search 18.41 s): objective=48978.9 imbalance=1.260 nsplit=0     Iteration 4 (23.01 s, search 22.97 s): objective=48980.6 imbalance=1.254 nsplit=0       
20it [09:13, 27.56s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.77 s, search 4.76 s): objective=48919.8 imbalance=1.380 nsplit=0       Iteration 1 (9.55 s, search 9.53 s): objective=48968.1 imbalance=1.293 nsplit=0       Iteration 2 (14.28 s, search 14.25 s): objective=48975.6 imbalance=1.267 nsplit=0     Iteration 3 (19.01 s, search 18.97 s): objective=48979.2 imbalance=1.256 nsplit=0     Iteration 4 (23.73 s, search 23.69 s): objective=48981.1 imbalance=1.250 nsplit=0       
21it [09:41, 27.83s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.71 s, search 4.70 s): objective=48919.9 imbalance=1.379 nsplit=0       Iteration 1 (9.46 s, search 9.44 s): objective=48968.4 imbalance=1.294 nsplit=1       Iteration 2 (14.21 s, search 14.18 s): objective=48976 imbalance=1.266 nsplit=0       Iteration 3 (18.94 s, search 18.91 s): objective=48979.4 imbalance=1.254 nsplit=0     Iteration 4 (23.70 s, search 23.66 s): objective=48981.2 imbalance=1.250 nsplit=0       
22it [10:10, 28.03s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.73 s, search 4.72 s): objective=48920.2 imbalance=1.378 nsplit=0       Iteration 1 (9.29 s, search 9.27 s): objective=48968.5 imbalance=1.297 nsplit=0       Iteration 2 (13.86 s, search 13.84 s): objective=48976 imbalance=1.271 nsplit=0       Iteration 3 (18.45 s, search 18.41 s): objective=48979.1 imbalance=1.260 nsplit=0     Iteration 4 (23.04 s, search 23.00 s): objective=48981 imbalance=1.255 nsplit=0       
23it [10:37, 27.90s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.59 s, search 4.58 s): objective=48920.7 imbalance=1.377 nsplit=0       Iteration 2 (13.70 s, search 13.68 s): objective=48976.3 imbalance=1.272 nsplit=0     Iteration 3 (18.25 s, search 18.21 s): objective=48979.6 imbalance=1.259 nsplit=0     Iteration 4 (22.80 s, search 22.76 s): objective=48981.5 imbalance=1.254 nsplit=0       
24it [11:05, 27.74s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.55 s, search 4.54 s): objective=48921.2 imbalance=1.380 nsplit=0       Iteration 1 (9.25 s, search 9.24 s): objective=48969.1 imbalance=1.297 nsplit=0       Iteration 2 (13.84 s, search 13.81 s): objective=48976.5 imbalance=1.268 nsplit=0     Iteration 3 (18.37 s, search 18.34 s): objective=48979.6 imbalance=1.255 nsplit=0     Iteration 4 (22.90 s, search 22.85 s): objective=48981.5 imbalance=1.251 nsplit=0       
25it [11:32, 27.64s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.51 s, search 4.50 s): objective=48921.4 imbalance=1.383 nsplit=0       Iteration 1 (9.04 s, search 9.02 s): objective=48969.2 imbalance=1.298 nsplit=0       Iteration 2 (13.58 s, search 13.55 s): objective=48976.5 imbalance=1.268 nsplit=0     Iteration 3 (18.09 s, search 18.06 s): objective=48979.8 imbalance=1.258 nsplit=0     Iteration 4 (22.60 s, search 22.56 s): objective=48981.6 imbalance=1.254 nsplit=0       
26it [11:59, 27.49s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.02 s, search 9.00 s): objective=48969.5 imbalance=1.298 nsplit=0       Iteration 2 (13.52 s, search 13.49 s): objective=48976.6 imbalance=1.269 nsplit=0     Iteration 3 (18.02 s, search 17.98 s): objective=48980.1 imbalance=1.259 nsplit=0     Iteration 4 (22.53 s, search 22.49 s): objective=48981.8 imbalance=1.256 nsplit=0       
27it [12:26, 27.36s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.51 s, search 4.50 s): objective=48922.6 imbalance=1.382 nsplit=0       Iteration 1 (9.04 s, search 9.02 s): objective=48969.6 imbalance=1.299 nsplit=0       Iteration 2 (13.53 s, search 13.51 s): objective=48977.2 imbalance=1.272 nsplit=0     Iteration 3 (18.23 s, search 18.19 s): objective=48980.3 imbalance=1.261 nsplit=0     Iteration 4 (22.93 s, search 22.89 s): objective=48982 imbalance=1.256 nsplit=0       
28it [12:54, 27.44s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.67 s, search 4.66 s): objective=48923.4 imbalance=1.381 nsplit=0       Iteration 1 (9.37 s, search 9.35 s): objective=48970.2 imbalance=1.299 nsplit=0       Iteration 2 (14.06 s, search 14.04 s): objective=48977.3 imbalance=1.271 nsplit=0     Iteration 3 (18.76 s, search 18.73 s): objective=48980.6 imbalance=1.262 nsplit=0     Iteration 4 (23.44 s, search 23.40 s): objective=48982.5 imbalance=1.256 nsplit=0       
29it [13:22, 27.66s/it]WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 512D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.74 s, search 4.73 s): objective=48924.1 imbalance=1.381 nsplit=0       Iteration 1 (9.41 s, search 9.39 s): objective=48970.5 imbalance=1.296 nsplit=0       Iteration 2 (14.08 s, search 14.05 s): objective=48977.6 imbalance=1.269 nsplit=0     Iteration 3 (18.75 s, search 18.72 s): objective=48980.9 imbalance=1.261 nsplit=0     Iteration 4 (23.39 s, search 23.35 s): objective=48982.7 imbalance=1.256 nsplit=0       
30it [13:50, 27.68s/it]
WARNING clustering 49046 points to 4904 centroids: please provide at least 191256 training points
Clustering 49046 points in 384D to 4904 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.37 s, search 3.36 s): objective=47059.3 imbalance=1.439 nsplit=0       Iteration 1 (6.72 s, search 6.71 s): objective=47724.9 imbalance=1.352 nsplit=0       Iteration 2 (10.10 s, search 10.09 s): objective=47819.9 imbalance=1.331 nsplit=0     Iteration 3 (13.53 s, search 13.50 s): objective=47861.6 imbalance=1.320 nsplit=0     Iteration 4 (16.89 s, search 16.86 s): objective=47884.2 imbalance=1.314 nsplit=0       
[05:41:21] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 177 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 63.90it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/fruit_aisle/lerf/2024-11-07_152911/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:41:26 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:41:26 hloc INFO] Found 178 images in root /home/gtangg12/data/lerf/LERF Datasets/fruit_aisle/fruit_aisle/images.
100%|███████████████████████████████████████████████| 178/178 [00:04<00:00, 37.15it/s]
[2024/11/13 05:41:35 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 177/177 [00:00<00:00, 54943.15it/s]
tensor([ 0, 58, 86]) 3
Rendering views: 3it [00:12,  4.02s/it]
0it [00:00, ?it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3014.31 imbalance=1.437 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3017.8 imbalance=1.372 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3018.25 imbalance=1.349 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3018.46 imbalance=1.340 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3018.57 imbalance=1.333 nsplit=0       
1it [00:00,  8.09it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3002.27 imbalance=1.439 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3010.2 imbalance=1.364 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3011.51 imbalance=1.315 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3012.17 imbalance=1.303 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3012.52 imbalance=1.297 nsplit=0       
2it [00:00,  8.10it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=2996.6 imbalance=1.446 nsplit=0        Iteration 1 (0.04 s, search 0.04 s): objective=3006.92 imbalance=1.346 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3008.48 imbalance=1.316 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3009.01 imbalance=1.295 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3009.41 imbalance=1.281 nsplit=0       
3it [00:00,  8.09it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=2995.77 imbalance=1.390 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3006.94 imbalance=1.287 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3008.7 imbalance=1.252 nsplit=0        Iteration 3 (0.08 s, search 0.08 s): objective=3009.41 imbalance=1.232 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3009.84 imbalance=1.223 nsplit=0       
4it [00:00,  8.04it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=2997.71 imbalance=1.385 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3008.48 imbalance=1.275 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3009.93 imbalance=1.239 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3010.5 imbalance=1.236 nsplit=0        Iteration 4 (0.10 s, search 0.10 s): objective=3010.8 imbalance=1.229 nsplit=0       
5it [00:00,  8.06it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3000.63 imbalance=1.364 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3010.13 imbalance=1.266 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3011.45 imbalance=1.235 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3011.95 imbalance=1.223 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3012.2 imbalance=1.220 nsplit=0       
6it [00:00,  8.09it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3003.75 imbalance=1.372 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3011.88 imbalance=1.268 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3012.96 imbalance=1.242 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3013.44 imbalance=1.231 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3013.63 imbalance=1.226 nsplit=0       
7it [00:00,  8.07it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3006.26 imbalance=1.376 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3013.25 imbalance=1.291 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3014.08 imbalance=1.256 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3014.53 imbalance=1.244 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3014.75 imbalance=1.233 nsplit=0       
8it [00:00,  8.07it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3008.03 imbalance=1.363 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3014.33 imbalance=1.289 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3015.13 imbalance=1.249 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3015.52 imbalance=1.235 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3015.75 imbalance=1.230 nsplit=0       
9it [00:01,  8.08it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3009.72 imbalance=1.357 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3015.38 imbalance=1.277 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3016.12 imbalance=1.251 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3016.45 imbalance=1.245 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3016.64 imbalance=1.239 nsplit=0       
10it [00:01,  8.09it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3011.25 imbalance=1.358 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3016.18 imbalance=1.284 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3016.84 imbalance=1.262 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3017.25 imbalance=1.245 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3017.46 imbalance=1.235 nsplit=0       
11it [00:01,  8.06it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3012.57 imbalance=1.361 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3017.04 imbalance=1.282 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3017.68 imbalance=1.256 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3017.96 imbalance=1.247 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3018.14 imbalance=1.241 nsplit=0       
12it [00:01,  8.06it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3013.7 imbalance=1.371 nsplit=0        Iteration 1 (0.05 s, search 0.04 s): objective=3017.75 imbalance=1.284 nsplit=0       Iteration 2 (0.07 s, search 0.06 s): objective=3018.21 imbalance=1.262 nsplit=0       Iteration 3 (0.09 s, search 0.08 s): objective=3018.43 imbalance=1.247 nsplit=0       Iteration 4 (0.11 s, search 0.11 s): objective=3018.55 imbalance=1.243 nsplit=0       
13it [00:01,  7.98it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3014.63 imbalance=1.386 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3018.29 imbalance=1.293 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3018.67 imbalance=1.271 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3018.89 imbalance=1.257 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3019.01 imbalance=1.251 nsplit=0       
14it [00:01,  7.98it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3015.38 imbalance=1.393 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3018.74 imbalance=1.285 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3019.11 imbalance=1.254 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3019.32 imbalance=1.244 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3019.45 imbalance=1.236 nsplit=0       
15it [00:01,  8.04it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3015.98 imbalance=1.392 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3019.13 imbalance=1.297 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3019.5 imbalance=1.274 nsplit=0        Iteration 3 (0.08 s, search 0.08 s): objective=3019.67 imbalance=1.260 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3019.75 imbalance=1.253 nsplit=0       
16it [00:01,  8.07it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3016.49 imbalance=1.391 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3019.42 imbalance=1.281 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3019.78 imbalance=1.252 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3019.94 imbalance=1.244 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3020.03 imbalance=1.250 nsplit=0       
17it [00:02,  8.11it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3016.92 imbalance=1.401 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3019.67 imbalance=1.287 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3020.16 imbalance=1.243 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3020.25 imbalance=1.234 nsplit=0       
18it [00:02,  8.07it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3017.3 imbalance=1.415 nsplit=0        Iteration 1 (0.04 s, search 0.04 s): objective=3019.9 imbalance=1.297 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3020.24 imbalance=1.264 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3020.41 imbalance=1.247 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3020.5 imbalance=1.240 nsplit=0       
19it [00:02,  8.08it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3017.64 imbalance=1.420 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.1 imbalance=1.296 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3020.43 imbalance=1.262 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3020.62 imbalance=1.243 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3020.77 imbalance=1.228 nsplit=0       
20it [00:02,  8.11it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3017.95 imbalance=1.408 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.31 imbalance=1.299 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3020.6 imbalance=1.266 nsplit=0        Iteration 3 (0.08 s, search 0.08 s): objective=3020.81 imbalance=1.251 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3020.96 imbalance=1.239 nsplit=0       
21it [00:02,  8.13it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3018.23 imbalance=1.414 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.5 imbalance=1.299 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3020.79 imbalance=1.261 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3020.99 imbalance=1.243 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.13 imbalance=1.231 nsplit=0       
22it [00:02,  8.15it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3018.48 imbalance=1.421 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.67 imbalance=1.294 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3020.95 imbalance=1.256 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.11 imbalance=1.247 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.25 imbalance=1.234 nsplit=0       
23it [00:02,  8.16it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3018.71 imbalance=1.430 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.83 imbalance=1.296 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3021.09 imbalance=1.248 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.25 imbalance=1.232 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.38 imbalance=1.226 nsplit=0       
24it [00:02,  8.18it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3018.92 imbalance=1.425 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3020.98 imbalance=1.283 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3021.23 imbalance=1.245 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.36 imbalance=1.233 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.5 imbalance=1.229 nsplit=0       
25it [00:03,  8.17it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3019.12 imbalance=1.417 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3021.1 imbalance=1.279 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3021.35 imbalance=1.234 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.46 imbalance=1.224 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.55 imbalance=1.220 nsplit=0       
26it [00:03,  8.17it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3019.31 imbalance=1.419 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3021.2 imbalance=1.279 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3021.45 imbalance=1.236 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.55 imbalance=1.229 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.63 imbalance=1.224 nsplit=0       
27it [00:03,  8.17it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3019.47 imbalance=1.419 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3021.3 imbalance=1.290 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3021.55 imbalance=1.254 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.64 imbalance=1.245 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.75 imbalance=1.243 nsplit=0       
28it [00:03,  8.15it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3019.61 imbalance=1.409 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3021.4 imbalance=1.301 nsplit=0        Iteration 2 (0.06 s, search 0.06 s): objective=3021.64 imbalance=1.272 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.78 imbalance=1.252 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.87 imbalance=1.249 nsplit=0       
29it [00:03,  8.15it/s]WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 512D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3019.74 imbalance=1.416 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3021.49 imbalance=1.296 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3021.72 imbalance=1.269 nsplit=0       Iteration 3 (0.08 s, search 0.08 s): objective=3021.87 imbalance=1.255 nsplit=0       Iteration 4 (0.10 s, search 0.10 s): objective=3021.95 imbalance=1.251 nsplit=0       
30it [00:03,  8.10it/s]
WARNING clustering 3024 points to 302 centroids: please provide at least 11778 training points
Clustering 3024 points in 384D to 302 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.01 s, search 0.01 s): objective=2703.52 imbalance=1.491 nsplit=0       Iteration 1 (0.03 s, search 0.03 s): objective=2812.23 imbalance=1.385 nsplit=0       Iteration 2 (0.04 s, search 0.04 s): objective=2826.43 imbalance=1.341 nsplit=0       Iteration 3 (0.05 s, search 0.05 s): objective=2833.15 imbalance=1.330 nsplit=0       Iteration 4 (0.07 s, search 0.07 s): objective=2836.87 imbalance=1.329 nsplit=0       
[05:41:53] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 145 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 73.20it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/hand_hand/lerf/2024-11-07_160705/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:41:59 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:41:59 hloc INFO] Found 146 images in root /home/gtangg12/data/lerf/LERF Datasets/hand_hand/hand_hand/images.
100%|███████████████████████████████████████████████| 146/146 [00:03<00:00, 37.06it/s]
[2024/11/13 05:42:06 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 145/145 [00:00<00:00, 44960.01it/s]
tensor([  0,  20,  27,  50,  56,  64,  70,  75,  78,  80,  81,  86, 105, 107,
        109, 112, 119, 121, 123, 132, 141]) 21
Rendering views: 21it [01:02,  2.97s/it]
0it [00:00, ?it/s]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.84 s, search 0.83 s): objective=20285.8 imbalance=1.369 nsplit=0       Iteration 2 (2.49 s, search 2.48 s): objective=20297.6 imbalance=1.267 nsplit=0       Iteration 3 (3.31 s, search 3.30 s): objective=20298.4 imbalance=1.253 nsplit=0       Iteration 4 (4.14 s, search 4.12 s): objective=20298.8 imbalance=1.249 nsplit=0       
1it [00:04,  4.97s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 2 (2.47 s, search 2.46 s): objective=20293.1 imbalance=1.266 nsplit=0       Iteration 4 (4.13 s, search 4.11 s): objective=20294.4 imbalance=1.251 nsplit=0       
2it [00:09,  4.97s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.83 s, search 0.83 s): objective=20268.8 imbalance=1.365 nsplit=0       Iteration 1 (1.66 s, search 1.65 s): objective=20284.8 imbalance=1.288 nsplit=0       Iteration 2 (2.49 s, search 2.47 s): objective=20287.3 imbalance=1.263 nsplit=0       Iteration 3 (3.31 s, search 3.30 s): objective=20288.5 imbalance=1.250 nsplit=0       Iteration 4 (4.14 s, search 4.12 s): objective=20289.2 imbalance=1.244 nsplit=0       
3it [00:14,  4.97s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.65 s, search 1.64 s): objective=20279.6 imbalance=1.284 nsplit=0       Iteration 2 (2.47 s, search 2.46 s): objective=20282.9 imbalance=1.262 nsplit=0       Iteration 3 (3.30 s, search 3.28 s): objective=20284.4 imbalance=1.251 nsplit=0       Iteration 4 (4.12 s, search 4.10 s): objective=20285.2 imbalance=1.248 nsplit=0       
4it [00:19,  4.96s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.82 s): objective=20255.2 imbalance=1.356 nsplit=0       Iteration 1 (1.64 s, search 1.64 s): objective=20275.7 imbalance=1.282 nsplit=0       Iteration 3 (3.28 s, search 3.27 s): objective=20280.5 imbalance=1.253 nsplit=0       Iteration 4 (4.10 s, search 4.08 s): objective=20281.4 imbalance=1.249 nsplit=0       
5it [00:24,  4.95s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20251.8 imbalance=1.351 nsplit=0       Iteration 1 (1.63 s, search 1.63 s): objective=20273.4 imbalance=1.279 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20276.8 imbalance=1.254 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20278.5 imbalance=1.247 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20279.3 imbalance=1.242 nsplit=0       
6it [00:29,  4.94s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.63 s, search 1.63 s): objective=20272.2 imbalance=1.274 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20275.7 imbalance=1.253 nsplit=0       Iteration 3 (3.26 s, search 3.25 s): objective=20277.3 imbalance=1.240 nsplit=0       Iteration 4 (4.08 s, search 4.06 s): objective=20278.1 imbalance=1.236 nsplit=0       
7it [00:34,  4.93s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.64 s, search 1.63 s): objective=20271.6 imbalance=1.273 nsplit=0       Iteration 2 (2.46 s, search 2.45 s): objective=20275.1 imbalance=1.247 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20276.6 imbalance=1.232 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20277.4 imbalance=1.228 nsplit=0       
8it [00:39,  4.93s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20248.5 imbalance=1.351 nsplit=0       Iteration 1 (1.64 s, search 1.63 s): objective=20271.2 imbalance=1.272 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20274.8 imbalance=1.247 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20276.3 imbalance=1.233 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20277.2 imbalance=1.230 nsplit=0       
9it [00:44,  4.92s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20248.4 imbalance=1.350 nsplit=0       Iteration 1 (1.63 s, search 1.63 s): objective=20271.1 imbalance=1.269 nsplit=0       Iteration 2 (2.46 s, search 2.45 s): objective=20274.6 imbalance=1.243 nsplit=0       Iteration 3 (3.28 s, search 3.26 s): objective=20276.1 imbalance=1.231 nsplit=0       Iteration 4 (4.10 s, search 4.08 s): objective=20276.8 imbalance=1.226 nsplit=0       
10it [00:49,  4.92s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20248.3 imbalance=1.350 nsplit=0       Iteration 1 (1.63 s, search 1.63 s): objective=20271.1 imbalance=1.269 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20274.8 imbalance=1.242 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20276.4 imbalance=1.230 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20277.2 imbalance=1.226 nsplit=0       
11it [00:54,  4.92s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.81 s, search 0.81 s): objective=20248.3 imbalance=1.357 nsplit=0       Iteration 2 (2.40 s, search 2.39 s): objective=20274.7 imbalance=1.242 nsplit=0       Iteration 3 (3.20 s, search 3.18 s): objective=20276.3 imbalance=1.228 nsplit=0       Iteration 4 (3.99 s, search 3.97 s): objective=20277.2 imbalance=1.220 nsplit=0       
12it [00:59,  4.88s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.79 s, search 0.78 s): objective=20248.3 imbalance=1.349 nsplit=0       Iteration 1 (1.58 s, search 1.57 s): objective=20271.1 imbalance=1.266 nsplit=0       Iteration 2 (2.41 s, search 2.40 s): objective=20274.8 imbalance=1.239 nsplit=0       Iteration 3 (3.24 s, search 3.22 s): objective=20276.5 imbalance=1.226 nsplit=0       Iteration 4 (4.06 s, search 4.05 s): objective=20277.3 imbalance=1.221 nsplit=0       
13it [01:03,  4.89s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.83 s, search 0.82 s): objective=20248.4 imbalance=1.343 nsplit=0       Iteration 1 (1.65 s, search 1.65 s): objective=20271.2 imbalance=1.262 nsplit=0       Iteration 2 (2.47 s, search 2.46 s): objective=20274.9 imbalance=1.236 nsplit=0       Iteration 3 (3.26 s, search 3.25 s): objective=20276.6 imbalance=1.225 nsplit=0       Iteration 4 (4.06 s, search 4.04 s): objective=20277.5 imbalance=1.216 nsplit=0       
14it [01:08,  4.88s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.78 s, search 0.78 s): objective=20248.6 imbalance=1.345 nsplit=0       Iteration 1 (1.57 s, search 1.56 s): objective=20271.4 imbalance=1.264 nsplit=0       Iteration 2 (2.38 s, search 2.37 s): objective=20275.1 imbalance=1.237 nsplit=0       Iteration 3 (3.19 s, search 3.18 s): objective=20276.9 imbalance=1.225 nsplit=0       Iteration 4 (4.00 s, search 3.98 s): objective=20277.8 imbalance=1.217 nsplit=0       
15it [01:13,  4.86s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20248.9 imbalance=1.344 nsplit=0       Iteration 1 (1.63 s, search 1.62 s): objective=20271.5 imbalance=1.268 nsplit=0       Iteration 2 (2.44 s, search 2.43 s): objective=20275.4 imbalance=1.243 nsplit=0       Iteration 4 (4.07 s, search 4.05 s): objective=20277.9 imbalance=1.222 nsplit=0       
16it [01:18,  4.87s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20249.1 imbalance=1.343 nsplit=0       Iteration 1 (1.63 s, search 1.62 s): objective=20271.7 imbalance=1.267 nsplit=0       Iteration 2 (2.44 s, search 2.43 s): objective=20275.4 imbalance=1.244 nsplit=0       Iteration 3 (3.25 s, search 3.24 s): objective=20277.2 imbalance=1.232 nsplit=0       Iteration 4 (4.07 s, search 4.05 s): objective=20278 imbalance=1.225 nsplit=0       
17it [01:23,  4.87s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.78 s, search 0.78 s): objective=20249.4 imbalance=1.344 nsplit=0       Iteration 2 (2.36 s, search 2.35 s): objective=20275.9 imbalance=1.235 nsplit=0       Iteration 3 (3.16 s, search 3.15 s): objective=20277.6 imbalance=1.225 nsplit=0       Iteration 4 (3.95 s, search 3.94 s): objective=20278.4 imbalance=1.217 nsplit=0       
18it [01:28,  4.84s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.81 s, search 0.81 s): objective=20249.6 imbalance=1.347 nsplit=0       Iteration 1 (1.63 s, search 1.62 s): objective=20272.2 imbalance=1.262 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20277.7 imbalance=1.228 nsplit=0       Iteration 4 (4.10 s, search 4.08 s): objective=20278.5 imbalance=1.222 nsplit=0       
19it [01:33,  4.87s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.67 s, search 1.67 s): objective=20272.6 imbalance=1.263 nsplit=0       Iteration 2 (2.50 s, search 2.49 s): objective=20276.3 imbalance=1.239 nsplit=0       Iteration 3 (3.31 s, search 3.30 s): objective=20277.9 imbalance=1.229 nsplit=0       Iteration 4 (4.13 s, search 4.12 s): objective=20278.7 imbalance=1.225 nsplit=0       
20it [01:38,  4.90s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.82 s): objective=20250.6 imbalance=1.354 nsplit=0       Iteration 1 (1.64 s, search 1.64 s): objective=20273.1 imbalance=1.270 nsplit=0       Iteration 2 (2.46 s, search 2.45 s): objective=20276.6 imbalance=1.240 nsplit=0       Iteration 3 (3.28 s, search 3.27 s): objective=20278.2 imbalance=1.228 nsplit=0       Iteration 4 (4.11 s, search 4.09 s): objective=20279 imbalance=1.224 nsplit=0       
21it [01:43,  4.91s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20251.1 imbalance=1.364 nsplit=0       Iteration 1 (1.63 s, search 1.63 s): objective=20273.6 imbalance=1.274 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20277.1 imbalance=1.248 nsplit=1       Iteration 3 (3.27 s, search 3.25 s): objective=20278.6 imbalance=1.236 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20279.4 imbalance=1.232 nsplit=0       
22it [01:47,  4.91s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20251.7 imbalance=1.364 nsplit=0       Iteration 1 (1.64 s, search 1.63 s): objective=20273.9 imbalance=1.273 nsplit=0       Iteration 2 (2.45 s, search 2.44 s): objective=20277.6 imbalance=1.248 nsplit=0       Iteration 3 (3.27 s, search 3.26 s): objective=20279.1 imbalance=1.235 nsplit=0       Iteration 4 (4.09 s, search 4.07 s): objective=20279.9 imbalance=1.232 nsplit=0       
23it [01:52,  4.91s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20252.4 imbalance=1.367 nsplit=0       Iteration 1 (1.64 s, search 1.63 s): objective=20274.4 imbalance=1.271 nsplit=0       Iteration 3 (3.28 s, search 3.26 s): objective=20279.6 imbalance=1.231 nsplit=0       Iteration 4 (4.09 s, search 4.08 s): objective=20280.4 imbalance=1.227 nsplit=0       
24it [01:57,  4.91s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.81 s): objective=20253.1 imbalance=1.367 nsplit=0       Iteration 1 (1.64 s, search 1.63 s): objective=20274.8 imbalance=1.276 nsplit=1       Iteration 2 (2.46 s, search 2.45 s): objective=20278.4 imbalance=1.248 nsplit=0       Iteration 3 (3.28 s, search 3.26 s): objective=20279.9 imbalance=1.238 nsplit=0       Iteration 4 (4.10 s, search 4.08 s): objective=20280.6 imbalance=1.235 nsplit=0       
25it [02:02,  4.92s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.82 s, search 0.82 s): objective=20253.8 imbalance=1.365 nsplit=0       Iteration 1 (1.64 s, search 1.64 s): objective=20275.3 imbalance=1.276 nsplit=1       Iteration 2 (2.41 s, search 2.40 s): objective=20278.8 imbalance=1.248 nsplit=0       Iteration 3 (3.19 s, search 3.18 s): objective=20280.2 imbalance=1.237 nsplit=0       Iteration 4 (3.96 s, search 3.95 s): objective=20280.8 imbalance=1.234 nsplit=0       
26it [02:07,  4.87s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.79 s, search 0.78 s): objective=20254.5 imbalance=1.364 nsplit=0       Iteration 1 (1.58 s, search 1.57 s): objective=20275.8 imbalance=1.277 nsplit=0       Iteration 2 (2.36 s, search 2.35 s): objective=20279.3 imbalance=1.254 nsplit=0       Iteration 3 (3.15 s, search 3.14 s): objective=20280.6 imbalance=1.244 nsplit=0       Iteration 4 (3.94 s, search 3.93 s): objective=20281.2 imbalance=1.238 nsplit=0       
27it [02:12,  4.83s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.80 s, search 0.80 s): objective=20255.2 imbalance=1.363 nsplit=0       Iteration 1 (1.59 s, search 1.59 s): objective=20276.2 imbalance=1.282 nsplit=0       Iteration 2 (2.39 s, search 2.38 s): objective=20279.6 imbalance=1.258 nsplit=0       Iteration 4 (3.97 s, search 3.95 s): objective=20281.7 imbalance=1.244 nsplit=0       
28it [02:16,  4.81s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.80 s, search 0.79 s): objective=20255.9 imbalance=1.365 nsplit=0       Iteration 1 (1.59 s, search 1.59 s): objective=20276.8 imbalance=1.285 nsplit=0       Iteration 3 (3.18 s, search 3.17 s): objective=20281.3 imbalance=1.246 nsplit=0       Iteration 4 (3.98 s, search 3.96 s): objective=20282.1 imbalance=1.241 nsplit=0       
29it [02:21,  4.80s/it]WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 512D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.79 s, search 0.79 s): objective=20256.4 imbalance=1.368 nsplit=0       Iteration 1 (1.60 s, search 1.59 s): objective=20277.3 imbalance=1.289 nsplit=0       Iteration 2 (2.38 s, search 2.37 s): objective=20280.5 imbalance=1.259 nsplit=1       Iteration 3 (3.17 s, search 3.16 s): objective=20281.8 imbalance=1.245 nsplit=0       Iteration 4 (3.95 s, search 3.94 s): objective=20282.6 imbalance=1.239 nsplit=0       
30it [02:26,  4.88s/it]
WARNING clustering 20312 points to 2031 centroids: please provide at least 79209 training points
Clustering 20312 points in 384D to 2031 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.19 s, search 1.18 s): objective=19792.6 imbalance=1.303 nsplit=0       Iteration 2 (1.77 s, search 1.77 s): objective=19830.7 imbalance=1.280 nsplit=0       Iteration 4 (2.94 s, search 2.93 s): objective=19857.9 imbalance=1.272 nsplit=0       
[05:45:43] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 130 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 84.37it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/ramen/lerf/2024-11-07_164537/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:45:49 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:45:49 hloc INFO] Found 131 images in root /home/gtangg12/data/lerf/LERF Datasets/ramen/ramen/images.
100%|███████████████████████████████████████████████| 131/131 [00:03<00:00, 36.91it/s]
[2024/11/13 05:45:56 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 130/130 [00:00<00:00, 54141.55it/s]
tensor([  0,  97, 109, 118]) 4
Rendering views: 4it [00:14,  3.54s/it]
0it [00:00, ?it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3867.99 imbalance=1.400 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3870.7 imbalance=1.328 nsplit=0        Iteration 2 (0.09 s, search 0.08 s): objective=3871.11 imbalance=1.308 nsplit=0       Iteration 3 (0.11 s, search 0.11 s): objective=3871.29 imbalance=1.294 nsplit=0       Iteration 4 (0.14 s, search 0.14 s): objective=3871.38 imbalance=1.289 nsplit=0       
1it [00:00,  5.74it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3858.61 imbalance=1.430 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3865.1 imbalance=1.328 nsplit=0        Iteration 2 (0.09 s, search 0.09 s): objective=3865.99 imbalance=1.301 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3866.39 imbalance=1.283 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3866.58 imbalance=1.278 nsplit=0       
2it [00:00,  5.68it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3852.48 imbalance=1.410 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3861.38 imbalance=1.307 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3862.52 imbalance=1.275 nsplit=0       Iteration 3 (0.11 s, search 0.11 s): objective=3863.09 imbalance=1.263 nsplit=0       Iteration 4 (0.14 s, search 0.14 s): objective=3863.37 imbalance=1.254 nsplit=0       
3it [00:00,  5.71it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3848.89 imbalance=1.411 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3859.24 imbalance=1.319 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3860.73 imbalance=1.287 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3861.3 imbalance=1.277 nsplit=0        Iteration 4 (0.15 s, search 0.15 s): objective=3861.57 imbalance=1.274 nsplit=0       
4it [00:00,  5.61it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3847.77 imbalance=1.430 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3858.12 imbalance=1.318 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3859.67 imbalance=1.296 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3860.24 imbalance=1.291 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3860.54 imbalance=1.287 nsplit=0       
5it [00:00,  5.60it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3847.64 imbalance=1.418 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3857.96 imbalance=1.326 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3859.59 imbalance=1.286 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3860.36 imbalance=1.283 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3860.73 imbalance=1.282 nsplit=0       
6it [00:01,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3848.19 imbalance=1.436 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3858.39 imbalance=1.325 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3859.89 imbalance=1.290 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3860.52 imbalance=1.281 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3860.81 imbalance=1.278 nsplit=0       
7it [00:01,  5.58it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3848.97 imbalance=1.437 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3858.83 imbalance=1.321 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3860.32 imbalance=1.288 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3861.01 imbalance=1.276 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3861.34 imbalance=1.271 nsplit=0       
8it [00:01,  5.57it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3849.92 imbalance=1.463 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3859.48 imbalance=1.332 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3860.88 imbalance=1.297 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3861.48 imbalance=1.290 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3861.79 imbalance=1.280 nsplit=0       
9it [00:01,  5.55it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3850.86 imbalance=1.464 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3860.15 imbalance=1.330 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3861.45 imbalance=1.292 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3861.99 imbalance=1.278 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3862.19 imbalance=1.275 nsplit=0       
10it [00:01,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3851.83 imbalance=1.468 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3860.73 imbalance=1.335 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3862.04 imbalance=1.299 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3862.59 imbalance=1.279 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3862.8 imbalance=1.270 nsplit=0       
11it [00:01,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3852.8 imbalance=1.464 nsplit=0        Iteration 1 (0.06 s, search 0.06 s): objective=3861.32 imbalance=1.338 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3862.66 imbalance=1.297 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3863.18 imbalance=1.275 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3863.45 imbalance=1.261 nsplit=0       
12it [00:02,  5.60it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3853.82 imbalance=1.458 nsplit=0       Iteration 1 (0.07 s, search 0.06 s): objective=3861.9 imbalance=1.338 nsplit=0        Iteration 2 (0.10 s, search 0.09 s): objective=3863.06 imbalance=1.297 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3863.58 imbalance=1.281 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3863.8 imbalance=1.274 nsplit=0       
13it [00:02,  5.53it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3854.82 imbalance=1.444 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3862.59 imbalance=1.335 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3863.71 imbalance=1.303 nsplit=0       Iteration 3 (0.12 s, search 0.11 s): objective=3864.24 imbalance=1.288 nsplit=0       Iteration 4 (0.14 s, search 0.14 s): objective=3864.53 imbalance=1.283 nsplit=0       
14it [00:02,  5.58it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3855.76 imbalance=1.429 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3863.11 imbalance=1.335 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3864.23 imbalance=1.298 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3864.67 imbalance=1.285 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3864.89 imbalance=1.282 nsplit=0       
15it [00:02,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3856.59 imbalance=1.431 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3863.68 imbalance=1.324 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3864.78 imbalance=1.305 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3865.21 imbalance=1.291 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3865.46 imbalance=1.282 nsplit=0       
16it [00:02,  5.61it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3857.32 imbalance=1.436 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3864.2 imbalance=1.326 nsplit=0        Iteration 2 (0.09 s, search 0.09 s): objective=3865.31 imbalance=1.296 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3865.71 imbalance=1.281 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3865.95 imbalance=1.274 nsplit=0       
17it [00:03,  5.58it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3857.98 imbalance=1.429 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3864.69 imbalance=1.310 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3865.71 imbalance=1.281 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3866.16 imbalance=1.272 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3866.41 imbalance=1.263 nsplit=0       
18it [00:03,  5.60it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3858.66 imbalance=1.439 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3865.07 imbalance=1.309 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3866.16 imbalance=1.273 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3866.62 imbalance=1.258 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3866.83 imbalance=1.250 nsplit=0       
19it [00:03,  5.56it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3859.3 imbalance=1.431 nsplit=0        Iteration 1 (0.06 s, search 0.06 s): objective=3865.34 imbalance=1.293 nsplit=0       Iteration 2 (0.09 s, search 0.08 s): objective=3866.32 imbalance=1.258 nsplit=0       Iteration 3 (0.11 s, search 0.11 s): objective=3866.79 imbalance=1.248 nsplit=0       Iteration 4 (0.14 s, search 0.14 s): objective=3867.03 imbalance=1.246 nsplit=0       
20it [00:03,  5.63it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3859.87 imbalance=1.430 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3865.71 imbalance=1.303 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3866.68 imbalance=1.266 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3867.13 imbalance=1.253 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3867.35 imbalance=1.249 nsplit=0       
21it [00:03,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3860.42 imbalance=1.427 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3866.11 imbalance=1.317 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3867.03 imbalance=1.276 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3867.44 imbalance=1.259 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3867.64 imbalance=1.253 nsplit=0       
22it [00:03,  5.59it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3860.92 imbalance=1.414 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3866.4 imbalance=1.294 nsplit=0        Iteration 2 (0.09 s, search 0.09 s): objective=3867.33 imbalance=1.250 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3867.7 imbalance=1.241 nsplit=0        Iteration 4 (0.15 s, search 0.15 s): objective=3867.93 imbalance=1.236 nsplit=0       
23it [00:04,  5.60it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3861.36 imbalance=1.400 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3866.68 imbalance=1.287 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3867.57 imbalance=1.251 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3867.97 imbalance=1.243 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3868.19 imbalance=1.234 nsplit=0       
24it [00:04,  5.61it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3861.79 imbalance=1.389 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3866.99 imbalance=1.277 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3867.89 imbalance=1.245 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3868.28 imbalance=1.226 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3868.46 imbalance=1.218 nsplit=0       
25it [00:04,  5.62it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3862.23 imbalance=1.390 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3867.25 imbalance=1.281 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3868.13 imbalance=1.243 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3868.51 imbalance=1.223 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3868.74 imbalance=1.217 nsplit=0       
26it [00:04,  5.63it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3862.64 imbalance=1.387 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3867.47 imbalance=1.292 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3868.31 imbalance=1.245 nsplit=0       Iteration 3 (0.12 s, search 0.12 s): objective=3868.75 imbalance=1.223 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3869 imbalance=1.214 nsplit=0       
27it [00:04,  5.58it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3863.02 imbalance=1.376 nsplit=0       Iteration 1 (0.06 s, search 0.06 s): objective=3867.78 imbalance=1.278 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3868.66 imbalance=1.234 nsplit=0       Iteration 3 (0.12 s, search 0.11 s): objective=3869.02 imbalance=1.217 nsplit=0       Iteration 4 (0.15 s, search 0.14 s): objective=3869.23 imbalance=1.213 nsplit=0       
28it [00:05,  5.61it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3863.4 imbalance=1.382 nsplit=0        Iteration 2 (0.09 s, search 0.09 s): objective=3868.8 imbalance=1.238 nsplit=1        Iteration 3 (0.12 s, search 0.12 s): objective=3869.15 imbalance=1.216 nsplit=0       Iteration 4 (0.15 s, search 0.15 s): objective=3869.35 imbalance=1.213 nsplit=0       
29it [00:05,  5.61it/s]WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 512D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.03 s, search 0.03 s): objective=3863.8 imbalance=1.385 nsplit=0        Iteration 1 (0.06 s, search 0.06 s): objective=3868.22 imbalance=1.270 nsplit=0       Iteration 2 (0.09 s, search 0.09 s): objective=3869.01 imbalance=1.243 nsplit=0       Iteration 3 (0.12 s, search 0.11 s): objective=3869.38 imbalance=1.223 nsplit=0       Iteration 4 (0.14 s, search 0.14 s): objective=3869.58 imbalance=1.219 nsplit=0       
30it [00:05,  5.60it/s]
WARNING clustering 3876 points to 387 centroids: please provide at least 15093 training points
Clustering 3876 points in 384D to 387 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (0.02 s, search 0.02 s): objective=3567.36 imbalance=1.483 nsplit=0       Iteration 1 (0.04 s, search 0.04 s): objective=3674.23 imbalance=1.393 nsplit=0       Iteration 2 (0.06 s, search 0.06 s): objective=3687.94 imbalance=1.384 nsplit=0       Iteration 3 (0.09 s, search 0.09 s): objective=3694.19 imbalance=1.381 nsplit=0       Iteration 4 (0.11 s, search 0.11 s): objective=3697.44 imbalance=1.380 nsplit=0       
[05:46:18] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 134 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 78.95it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/shoe_rack/lerf/2024-11-07_172316/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:46:23 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:46:23 hloc INFO] Found 135 images in root /home/gtangg12/data/lerf/LERF Datasets/shoe_rack/shoe_rack/images.
100%|███████████████████████████████████████████████| 135/135 [00:03<00:00, 36.77it/s]
[2024/11/13 05:46:31 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 134/134 [00:00<00:00, 43193.72it/s]
tensor([  0,  27,  32,  38,  43,  61,  64,  67,  72,  76,  77,  79,  84,  89,
         94,  95,  99, 103, 109, 111, 114, 116, 118, 132, 133]) 25
Rendering views: 25it [01:12,  2.90s/it]
0it [00:00, ?it/s]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.25 s, search 1.24 s): objective=24147.9 imbalance=1.385 nsplit=0       Iteration 1 (2.39 s, search 2.38 s): objective=24159.9 imbalance=1.296 nsplit=3       Iteration 2 (3.51 s, search 3.50 s): objective=24161.9 imbalance=1.267 nsplit=1       Iteration 3 (4.63 s, search 4.61 s): objective=24162.8 imbalance=1.254 nsplit=0       Iteration 4 (5.74 s, search 5.72 s): objective=24163.4 imbalance=1.251 nsplit=0       
1it [00:06,  6.87s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.11 s): objective=24125.1 imbalance=1.383 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24144.7 imbalance=1.301 nsplit=0       Iteration 2 (3.36 s, search 3.35 s): objective=24147.7 imbalance=1.272 nsplit=0       Iteration 4 (5.59 s, search 5.58 s): objective=24149.7 imbalance=1.257 nsplit=0       
2it [00:13,  6.78s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.12 s): objective=24108.1 imbalance=1.385 nsplit=0       Iteration 1 (2.24 s, search 2.23 s): objective=24132.8 imbalance=1.297 nsplit=0       Iteration 2 (3.37 s, search 3.36 s): objective=24136.9 imbalance=1.269 nsplit=0       Iteration 3 (4.51 s, search 4.50 s): objective=24138.8 imbalance=1.257 nsplit=1       Iteration 4 (5.66 s, search 5.64 s): objective=24139.8 imbalance=1.250 nsplit=0       
3it [00:20,  6.80s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.16 s, search 1.15 s): objective=24100.7 imbalance=1.384 nsplit=0       Iteration 1 (2.31 s, search 2.30 s): objective=24127.8 imbalance=1.292 nsplit=0       Iteration 2 (3.47 s, search 3.45 s): objective=24132.3 imbalance=1.265 nsplit=0       Iteration 3 (4.62 s, search 4.60 s): objective=24134.3 imbalance=1.252 nsplit=0       Iteration 4 (5.76 s, search 5.74 s): objective=24135.3 imbalance=1.242 nsplit=0       
4it [00:27,  6.84s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.15 s, search 1.14 s): objective=24098.7 imbalance=1.374 nsplit=0       Iteration 1 (2.29 s, search 2.28 s): objective=24126.4 imbalance=1.283 nsplit=1       Iteration 2 (3.44 s, search 3.42 s): objective=24130.9 imbalance=1.252 nsplit=0       Iteration 3 (4.55 s, search 4.54 s): objective=24132.9 imbalance=1.239 nsplit=0       Iteration 4 (5.66 s, search 5.64 s): objective=24133.9 imbalance=1.232 nsplit=0       
5it [00:34,  6.82s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.10 s): objective=24099.2 imbalance=1.359 nsplit=0       Iteration 1 (2.21 s, search 2.20 s): objective=24126.8 imbalance=1.277 nsplit=0       Iteration 2 (3.31 s, search 3.30 s): objective=24131.2 imbalance=1.248 nsplit=0       Iteration 3 (4.46 s, search 4.44 s): objective=24133.1 imbalance=1.234 nsplit=0       Iteration 4 (5.58 s, search 5.56 s): objective=24134.1 imbalance=1.228 nsplit=0       
6it [00:40,  6.78s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.10 s): objective=24101.4 imbalance=1.360 nsplit=0       Iteration 1 (2.25 s, search 2.24 s): objective=24128.3 imbalance=1.276 nsplit=1       Iteration 2 (3.40 s, search 3.38 s): objective=24132.5 imbalance=1.250 nsplit=0       Iteration 3 (4.54 s, search 4.53 s): objective=24134.4 imbalance=1.238 nsplit=0       Iteration 4 (5.69 s, search 5.67 s): objective=24135.4 imbalance=1.234 nsplit=0       
7it [00:47,  6.80s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.14 s, search 1.14 s): objective=24104.2 imbalance=1.361 nsplit=0       Iteration 1 (2.28 s, search 2.27 s): objective=24130.3 imbalance=1.275 nsplit=0       Iteration 2 (3.41 s, search 3.40 s): objective=24134.5 imbalance=1.245 nsplit=0       Iteration 3 (4.56 s, search 4.55 s): objective=24136.4 imbalance=1.233 nsplit=0       Iteration 4 (5.72 s, search 5.70 s): objective=24137.3 imbalance=1.226 nsplit=0       
8it [00:54,  6.82s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.16 s, search 1.16 s): objective=24107.5 imbalance=1.359 nsplit=0       Iteration 1 (2.33 s, search 2.32 s): objective=24132.6 imbalance=1.273 nsplit=0       Iteration 3 (4.67 s, search 4.66 s): objective=24138.9 imbalance=1.233 nsplit=0       Iteration 4 (5.85 s, search 5.83 s): objective=24139.8 imbalance=1.226 nsplit=0       
9it [01:01,  6.89s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.17 s, search 1.17 s): objective=24111.1 imbalance=1.361 nsplit=0       Iteration 3 (4.68 s, search 4.67 s): objective=24140.8 imbalance=1.235 nsplit=0       Iteration 4 (5.85 s, search 5.83 s): objective=24141.9 imbalance=1.228 nsplit=0       
10it [01:08,  6.93s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.17 s, search 1.16 s): objective=24114.4 imbalance=1.363 nsplit=0       Iteration 1 (2.33 s, search 2.32 s): objective=24137.2 imbalance=1.273 nsplit=0       Iteration 2 (3.49 s, search 3.48 s): objective=24141.1 imbalance=1.244 nsplit=0       Iteration 3 (4.67 s, search 4.65 s): objective=24142.8 imbalance=1.234 nsplit=0       Iteration 4 (5.84 s, search 5.82 s): objective=24143.8 imbalance=1.226 nsplit=0       
11it [01:15,  6.96s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.17 s, search 1.17 s): objective=24117.8 imbalance=1.367 nsplit=0       Iteration 1 (2.35 s, search 2.34 s): objective=24139.6 imbalance=1.275 nsplit=0       Iteration 2 (3.52 s, search 3.51 s): objective=24143.2 imbalance=1.244 nsplit=0       Iteration 4 (5.85 s, search 5.83 s): objective=24146 imbalance=1.228 nsplit=0       
12it [01:22,  6.98s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.17 s, search 1.17 s): objective=24121.2 imbalance=1.363 nsplit=0       Iteration 2 (3.51 s, search 3.49 s): objective=24145.4 imbalance=1.252 nsplit=0       Iteration 4 (5.85 s, search 5.83 s): objective=24147.9 imbalance=1.237 nsplit=0       
13it [01:29,  7.00s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.18 s, search 1.17 s): objective=24124.6 imbalance=1.368 nsplit=0       Iteration 1 (2.36 s, search 2.35 s): objective=24144.4 imbalance=1.277 nsplit=0       Iteration 2 (3.53 s, search 3.52 s): objective=24147.7 imbalance=1.252 nsplit=0       Iteration 3 (4.70 s, search 4.68 s): objective=24149.2 imbalance=1.241 nsplit=0       Iteration 4 (5.86 s, search 5.84 s): objective=24149.9 imbalance=1.237 nsplit=0       
14it [01:36,  7.01s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.36 s, search 2.35 s): objective=24146.7 imbalance=1.278 nsplit=0       Iteration 2 (3.51 s, search 3.50 s): objective=24149.7 imbalance=1.255 nsplit=0       Iteration 3 (4.67 s, search 4.65 s): objective=24151.2 imbalance=1.243 nsplit=0       Iteration 4 (5.82 s, search 5.80 s): objective=24151.9 imbalance=1.235 nsplit=0       
15it [01:43,  7.01s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.15 s, search 1.14 s): objective=24131.2 imbalance=1.366 nsplit=0       Iteration 3 (4.60 s, search 4.59 s): objective=24153.2 imbalance=1.243 nsplit=0       Iteration 4 (5.76 s, search 5.74 s): objective=24153.8 imbalance=1.239 nsplit=0       
16it [01:50,  6.98s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.16 s, search 1.16 s): objective=24134.1 imbalance=1.370 nsplit=0       Iteration 2 (3.49 s, search 3.47 s): objective=24153.8 imbalance=1.261 nsplit=0       Iteration 3 (4.65 s, search 4.63 s): objective=24154.9 imbalance=1.249 nsplit=0       Iteration 4 (5.80 s, search 5.78 s): objective=24155.5 imbalance=1.242 nsplit=0       
17it [01:57,  6.98s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.15 s, search 1.15 s): objective=24136.7 imbalance=1.368 nsplit=0       Iteration 1 (2.31 s, search 2.30 s): objective=24152.8 imbalance=1.282 nsplit=0       Iteration 2 (3.47 s, search 3.45 s): objective=24155.5 imbalance=1.254 nsplit=0       Iteration 3 (4.58 s, search 4.57 s): objective=24156.5 imbalance=1.240 nsplit=0       Iteration 4 (5.68 s, search 5.67 s): objective=24157 imbalance=1.234 nsplit=0       
18it [02:04,  6.92s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.09 s, search 1.09 s): objective=24139.2 imbalance=1.370 nsplit=0       Iteration 1 (2.20 s, search 2.19 s): objective=24154.4 imbalance=1.280 nsplit=0       Iteration 4 (5.50 s, search 5.48 s): objective=24158.5 imbalance=1.235 nsplit=0       
19it [02:10,  6.83s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.10 s, search 1.10 s): objective=24141.6 imbalance=1.374 nsplit=0       Iteration 2 (3.30 s, search 3.29 s): objective=24158.3 imbalance=1.259 nsplit=0       Iteration 3 (4.41 s, search 4.40 s): objective=24159.3 imbalance=1.242 nsplit=0       Iteration 4 (5.52 s, search 5.50 s): objective=24159.8 imbalance=1.236 nsplit=0       
20it [02:17,  6.77s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.11 s): objective=24143.7 imbalance=1.380 nsplit=0       Iteration 1 (2.24 s, search 2.23 s): objective=24157.4 imbalance=1.288 nsplit=0       Iteration 2 (3.36 s, search 3.35 s): objective=24159.7 imbalance=1.258 nsplit=0       Iteration 3 (4.48 s, search 4.46 s): objective=24160.6 imbalance=1.243 nsplit=0       Iteration 4 (5.60 s, search 5.58 s): objective=24161.1 imbalance=1.237 nsplit=0       
21it [02:24,  6.76s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.11 s): objective=24145.6 imbalance=1.378 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24158.7 imbalance=1.283 nsplit=0       Iteration 2 (3.36 s, search 3.35 s): objective=24160.8 imbalance=1.252 nsplit=0       Iteration 3 (4.50 s, search 4.49 s): objective=24161.7 imbalance=1.241 nsplit=0       Iteration 4 (5.63 s, search 5.61 s): objective=24162.1 imbalance=1.236 nsplit=0       
22it [02:31,  6.76s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.11 s): objective=24147.4 imbalance=1.376 nsplit=0       Iteration 1 (2.24 s, search 2.23 s): objective=24159.8 imbalance=1.283 nsplit=0       Iteration 2 (3.36 s, search 3.34 s): objective=24161.9 imbalance=1.251 nsplit=0       Iteration 3 (4.47 s, search 4.46 s): objective=24162.7 imbalance=1.239 nsplit=0       Iteration 4 (5.59 s, search 5.57 s): objective=24163.1 imbalance=1.235 nsplit=0       
23it [02:37,  6.75s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (2.24 s, search 2.23 s): objective=24160.6 imbalance=1.284 nsplit=0       Iteration 2 (3.36 s, search 3.34 s): objective=24162.6 imbalance=1.253 nsplit=0       Iteration 3 (4.49 s, search 4.47 s): objective=24163.4 imbalance=1.239 nsplit=0       Iteration 4 (5.65 s, search 5.63 s): objective=24163.8 imbalance=1.232 nsplit=0       
24it [02:44,  6.77s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.15 s, search 1.15 s): objective=24150.4 imbalance=1.375 nsplit=0       Iteration 1 (2.31 s, search 2.30 s): objective=24161.5 imbalance=1.287 nsplit=0       Iteration 2 (3.47 s, search 3.46 s): objective=24163.4 imbalance=1.256 nsplit=0       Iteration 3 (4.59 s, search 4.57 s): objective=24164.2 imbalance=1.240 nsplit=0       Iteration 4 (5.71 s, search 5.69 s): objective=24164.6 imbalance=1.234 nsplit=0       
25it [02:51,  6.79s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.11 s): objective=24151.7 imbalance=1.375 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24162.3 imbalance=1.285 nsplit=0       Iteration 2 (3.34 s, search 3.33 s): objective=24164.1 imbalance=1.256 nsplit=0       Iteration 3 (4.46 s, search 4.44 s): objective=24164.8 imbalance=1.244 nsplit=0       Iteration 4 (5.58 s, search 5.56 s): objective=24165.2 imbalance=1.237 nsplit=0       
26it [02:58,  6.76s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.11 s): objective=24152.8 imbalance=1.380 nsplit=0       Iteration 2 (3.34 s, search 3.33 s): objective=24164.7 imbalance=1.253 nsplit=0       Iteration 3 (4.46 s, search 4.45 s): objective=24165.5 imbalance=1.239 nsplit=0       Iteration 4 (5.58 s, search 5.56 s): objective=24165.9 imbalance=1.234 nsplit=0       
27it [03:04,  6.74s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.11 s): objective=24153.8 imbalance=1.377 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24163.7 imbalance=1.283 nsplit=0       Iteration 2 (3.34 s, search 3.33 s): objective=24165.3 imbalance=1.254 nsplit=0       Iteration 4 (5.60 s, search 5.58 s): objective=24166.4 imbalance=1.234 nsplit=0       
28it [03:11,  6.74s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.11 s, search 1.11 s): objective=24154.7 imbalance=1.372 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24164.3 imbalance=1.280 nsplit=0       Iteration 2 (3.34 s, search 3.33 s): objective=24165.8 imbalance=1.249 nsplit=0       Iteration 3 (4.46 s, search 4.45 s): objective=24166.5 imbalance=1.238 nsplit=0       Iteration 4 (5.58 s, search 5.56 s): objective=24166.9 imbalance=1.233 nsplit=0       
29it [03:18,  6.72s/it]WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 512D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (1.12 s, search 1.11 s): objective=24155.5 imbalance=1.369 nsplit=0       Iteration 1 (2.23 s, search 2.22 s): objective=24164.9 imbalance=1.279 nsplit=0       Iteration 2 (3.34 s, search 3.33 s): objective=24166.4 imbalance=1.251 nsplit=0       Iteration 3 (4.45 s, search 4.44 s): objective=24167.1 imbalance=1.239 nsplit=0       Iteration 4 (5.57 s, search 5.55 s): objective=24167.4 imbalance=1.233 nsplit=0       
30it [03:24,  6.83s/it]
WARNING clustering 24179 points to 2417 centroids: please provide at least 94263 training points
Clustering 24179 points in 384D to 2417 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 1 (1.64 s, search 1.64 s): objective=23456.9 imbalance=1.352 nsplit=0       Iteration 4 (4.11 s, search 4.10 s): objective=23537.5 imbalance=1.311 nsplit=0       
[05:51:19] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 438 images.
Setting up evaluation dataset...
Caching all 4 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 26.72it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/sunnyside/lerf/2024-11-07_195944/nerfstudio_models/step-000029999.ckpt
[2024/11/13 05:51:34 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 05:51:34 hloc INFO] Found 442 images in root /home/gtangg12/data/lerf/LERF Datasets/sunnyside/sunnyside/images.
100%|███████████████████████████████████████████████| 442/442 [00:11<00:00, 38.46it/s]
[2024/11/13 05:51:49 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 441/441 [00:00<00:00, 50375.51it/s]
tensor([  0,   5,   9,  23,  27,  30,  32,  35,  37,  40,  48,  52,  57,  61,
         64,  68,  75,  78,  83,  85,  87,  90,  92,  95,  98, 103, 111, 113,
        114, 118, 120, 123, 127, 132, 134, 135, 137, 139, 141, 143, 145, 150,
        152, 153, 155, 159, 161, 165, 167, 170, 176, 180, 182, 186, 189, 191,
        195, 200, 205, 206, 210, 213, 216, 218, 220, 227, 234, 236, 250, 251,
        255, 257, 259, 260, 267, 275, 278, 280, 283, 284, 288, 291, 305, 322,
        325, 328, 329, 331, 334, 336, 337, 338, 339, 341, 342, 343, 349, 351,
        353, 359, 362, 367, 371, 375, 378, 380, 387, 394, 399, 401, 419, 421,
        429, 439]) 114
Rendering views: 114it [06:11,  3.25s/it]
0it [00:00, ?it/s]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.02 s, search 26.00 s): objective=115576 imbalance=1.393 nsplit=0      Iteration 1 (51.75 s, search 51.71 s): objective=115598 imbalance=1.311 nsplit=0      Iteration 2 (77.49 s, search 77.43 s): objective=115601 imbalance=1.286 nsplit=0      Iteration 3 (102.83 s, search 102.76 s): objective=115602 imbalance=1.275 nsplit=0    Iteration 4 (127.98 s, search 127.89 s): objective=115602 imbalance=1.269 nsplit=0       
1it [02:33, 153.22s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.17 s, search 25.15 s): objective=115446 imbalance=1.394 nsplit=0      Iteration 1 (50.51 s, search 50.47 s): objective=115529 imbalance=1.311 nsplit=0      Iteration 2 (75.75 s, search 75.69 s): objective=115541 imbalance=1.283 nsplit=0      Iteration 3 (101.35 s, search 101.28 s): objective=115546 imbalance=1.271 nsplit=0    Iteration 4 (127.20 s, search 127.10 s): objective=115549 imbalance=1.264 nsplit=0       
2it [05:06, 153.21s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.78 s, search 25.76 s): objective=115400 imbalance=1.395 nsplit=0      Iteration 1 (50.97 s, search 50.93 s): objective=115501 imbalance=1.312 nsplit=0      Iteration 2 (76.15 s, search 76.09 s): objective=115515 imbalance=1.284 nsplit=0      Iteration 3 (101.32 s, search 101.24 s): objective=115521 imbalance=1.274 nsplit=0    Iteration 4 (126.60 s, search 126.51 s): objective=115524 imbalance=1.269 nsplit=0       
3it [07:39, 153.24s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.11 s, search 26.08 s): objective=115400 imbalance=1.393 nsplit=0      Iteration 1 (52.62 s, search 52.58 s): objective=115500 imbalance=1.310 nsplit=0      Iteration 2 (78.70 s, search 78.64 s): objective=115514 imbalance=1.282 nsplit=0      Iteration 3 (104.41 s, search 104.34 s): objective=115521 imbalance=1.270 nsplit=0    Iteration 4 (129.81 s, search 129.71 s): objective=115524 imbalance=1.265 nsplit=0       
4it [10:15, 154.39s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.45 s, search 26.43 s): objective=115419 imbalance=1.393 nsplit=0      Iteration 1 (51.87 s, search 51.83 s): objective=115510 imbalance=1.313 nsplit=0      Iteration 2 (77.11 s, search 77.05 s): objective=115524 imbalance=1.286 nsplit=0      Iteration 3 (102.98 s, search 102.91 s): objective=115530 imbalance=1.275 nsplit=0    Iteration 4 (128.66 s, search 128.57 s): objective=115533 imbalance=1.268 nsplit=0       
5it [12:51, 154.69s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.28 s, search 26.25 s): objective=115442 imbalance=1.391 nsplit=0      Iteration 1 (51.75 s, search 51.71 s): objective=115524 imbalance=1.310 nsplit=1      Iteration 2 (77.05 s, search 76.99 s): objective=115536 imbalance=1.283 nsplit=0      Iteration 3 (102.44 s, search 102.37 s): objective=115541 imbalance=1.272 nsplit=0    Iteration 4 (127.78 s, search 127.69 s): objective=115544 imbalance=1.266 nsplit=0       
6it [15:24, 154.17s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.31 s, search 25.29 s): objective=115465 imbalance=1.392 nsplit=0      Iteration 1 (50.39 s, search 50.35 s): objective=115537 imbalance=1.308 nsplit=3      Iteration 2 (75.76 s, search 75.70 s): objective=115547 imbalance=1.280 nsplit=1      Iteration 3 (100.74 s, search 100.67 s): objective=115551 imbalance=1.269 nsplit=0    Iteration 4 (126.40 s, search 126.31 s): objective=115554 imbalance=1.263 nsplit=0       
7it [17:56, 153.43s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.72 s, search 25.70 s): objective=115484 imbalance=1.393 nsplit=0      Iteration 1 (52.24 s, search 52.20 s): objective=115547 imbalance=1.305 nsplit=0      Iteration 2 (78.19 s, search 78.13 s): objective=115556 imbalance=1.278 nsplit=0      Iteration 3 (103.76 s, search 103.69 s): objective=115559 imbalance=1.267 nsplit=0    Iteration 4 (129.21 s, search 129.12 s): objective=115561 imbalance=1.262 nsplit=0       
8it [20:30, 153.80s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.63 s, search 25.61 s): objective=115499 imbalance=1.394 nsplit=0      Iteration 1 (50.90 s, search 50.86 s): objective=115555 imbalance=1.309 nsplit=2      Iteration 2 (76.01 s, search 75.96 s): objective=115563 imbalance=1.284 nsplit=0      Iteration 3 (101.14 s, search 101.07 s): objective=115566 imbalance=1.273 nsplit=0    Iteration 4 (126.28 s, search 126.18 s): objective=115568 imbalance=1.267 nsplit=0       
9it [23:02, 153.06s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.51 s, search 25.49 s): objective=115511 imbalance=1.394 nsplit=0      Iteration 1 (50.48 s, search 50.44 s): objective=115561 imbalance=1.310 nsplit=2      Iteration 2 (75.70 s, search 75.64 s): objective=115568 imbalance=1.284 nsplit=0      Iteration 3 (100.93 s, search 100.86 s): objective=115571 imbalance=1.272 nsplit=0    Iteration 4 (126.02 s, search 125.92 s): objective=115573 imbalance=1.267 nsplit=0       
10it [25:33, 152.48s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.10 s, search 25.07 s): objective=115522 imbalance=1.396 nsplit=0      Iteration 1 (50.80 s, search 50.76 s): objective=115567 imbalance=1.313 nsplit=0      Iteration 2 (76.18 s, search 76.13 s): objective=115573 imbalance=1.287 nsplit=0      Iteration 3 (101.55 s, search 101.47 s): objective=115576 imbalance=1.275 nsplit=0    Iteration 4 (126.90 s, search 126.81 s): objective=115578 imbalance=1.270 nsplit=0       
11it [28:05, 152.43s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.95 s, search 25.93 s): objective=115531 imbalance=1.391 nsplit=0      Iteration 1 (51.52 s, search 51.48 s): objective=115572 imbalance=1.309 nsplit=1      Iteration 2 (77.41 s, search 77.35 s): objective=115578 imbalance=1.285 nsplit=0      Iteration 3 (102.79 s, search 102.71 s): objective=115580 imbalance=1.275 nsplit=0    Iteration 4 (128.34 s, search 128.25 s): objective=115581 imbalance=1.270 nsplit=0       
12it [30:39, 152.93s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.69 s, search 25.66 s): objective=115539 imbalance=1.395 nsplit=0      Iteration 1 (51.07 s, search 51.03 s): objective=115576 imbalance=1.312 nsplit=0      Iteration 2 (76.43 s, search 76.37 s): objective=115581 imbalance=1.286 nsplit=0      Iteration 3 (101.73 s, search 101.65 s): objective=115583 imbalance=1.276 nsplit=0    Iteration 4 (127.04 s, search 126.94 s): objective=115584 imbalance=1.271 nsplit=0       
13it [33:12, 152.79s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.56 s, search 25.54 s): objective=115546 imbalance=1.394 nsplit=0      Iteration 1 (50.88 s, search 50.84 s): objective=115580 imbalance=1.312 nsplit=0      Iteration 2 (76.33 s, search 76.27 s): objective=115585 imbalance=1.288 nsplit=0      Iteration 3 (102.13 s, search 102.05 s): objective=115586 imbalance=1.277 nsplit=0    Iteration 4 (127.50 s, search 127.41 s): objective=115587 imbalance=1.272 nsplit=0       
14it [35:44, 152.76s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.25 s, search 26.23 s): objective=115553 imbalance=1.397 nsplit=0      Iteration 1 (52.59 s, search 52.55 s): objective=115583 imbalance=1.313 nsplit=0      Iteration 2 (78.17 s, search 78.11 s): objective=115587 imbalance=1.287 nsplit=0      Iteration 3 (103.24 s, search 103.16 s): objective=115589 imbalance=1.277 nsplit=0    Iteration 4 (128.31 s, search 128.22 s): objective=115590 imbalance=1.272 nsplit=0       
15it [38:18, 153.00s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.87 s, search 25.85 s): objective=115558 imbalance=1.401 nsplit=0      Iteration 1 (51.68 s, search 51.63 s): objective=115586 imbalance=1.316 nsplit=0      Iteration 2 (77.88 s, search 77.82 s): objective=115590 imbalance=1.289 nsplit=0      Iteration 3 (103.04 s, search 102.96 s): objective=115591 imbalance=1.277 nsplit=0    Iteration 4 (128.28 s, search 128.18 s): objective=115592 imbalance=1.272 nsplit=0       
16it [40:52, 153.31s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.03 s, search 26.01 s): objective=115562 imbalance=1.401 nsplit=0      Iteration 1 (51.66 s, search 51.62 s): objective=115588 imbalance=1.317 nsplit=1      Iteration 2 (77.00 s, search 76.95 s): objective=115592 imbalance=1.290 nsplit=0      Iteration 3 (102.35 s, search 102.27 s): objective=115593 imbalance=1.278 nsplit=0    Iteration 4 (127.67 s, search 127.58 s): objective=115594 imbalance=1.271 nsplit=0       
17it [43:25, 153.28s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.16 s, search 25.14 s): objective=115565 imbalance=1.404 nsplit=0      Iteration 1 (50.46 s, search 50.42 s): objective=115590 imbalance=1.317 nsplit=2      Iteration 2 (76.79 s, search 76.73 s): objective=115593 imbalance=1.289 nsplit=0      Iteration 3 (103.15 s, search 103.07 s): objective=115595 imbalance=1.277 nsplit=0    Iteration 4 (129.48 s, search 129.39 s): objective=115595 imbalance=1.271 nsplit=0       
18it [46:01, 154.05s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.93 s, search 25.91 s): objective=115568 imbalance=1.404 nsplit=0      Iteration 1 (51.08 s, search 51.04 s): objective=115591 imbalance=1.317 nsplit=2      Iteration 2 (76.46 s, search 76.40 s): objective=115595 imbalance=1.290 nsplit=0      Iteration 3 (102.54 s, search 102.46 s): objective=115596 imbalance=1.278 nsplit=0    Iteration 4 (127.77 s, search 127.68 s): objective=115597 imbalance=1.273 nsplit=0       
19it [48:35, 154.04s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.45 s, search 26.43 s): objective=115571 imbalance=1.404 nsplit=0      Iteration 1 (52.92 s, search 52.88 s): objective=115593 imbalance=1.315 nsplit=2      Iteration 2 (79.17 s, search 79.11 s): objective=115596 imbalance=1.287 nsplit=0      Iteration 3 (105.51 s, search 105.43 s): objective=115597 imbalance=1.276 nsplit=0    Iteration 4 (131.73 s, search 131.64 s): objective=115598 imbalance=1.270 nsplit=0       
20it [51:13, 155.25s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.35 s, search 26.32 s): objective=115573 imbalance=1.403 nsplit=0      Iteration 1 (52.40 s, search 52.36 s): objective=115594 imbalance=1.313 nsplit=2      Iteration 2 (78.25 s, search 78.20 s): objective=115597 imbalance=1.285 nsplit=0      Iteration 3 (104.60 s, search 104.52 s): objective=115598 imbalance=1.273 nsplit=0    Iteration 4 (131.03 s, search 130.94 s): objective=115599 imbalance=1.267 nsplit=0       
21it [53:50, 155.85s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.30 s, search 26.27 s): objective=115575 imbalance=1.401 nsplit=0      Iteration 1 (52.67 s, search 52.63 s): objective=115595 imbalance=1.317 nsplit=0      Iteration 2 (78.41 s, search 78.35 s): objective=115598 imbalance=1.290 nsplit=1      Iteration 3 (104.03 s, search 103.96 s): objective=115599 imbalance=1.278 nsplit=0    Iteration 4 (129.77 s, search 129.68 s): objective=115599 imbalance=1.274 nsplit=0       
22it [56:26, 155.74s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.50 s, search 25.48 s): objective=115578 imbalance=1.402 nsplit=0      Iteration 1 (51.21 s, search 51.17 s): objective=115596 imbalance=1.318 nsplit=0      Iteration 2 (76.92 s, search 76.86 s): objective=115599 imbalance=1.290 nsplit=0      Iteration 3 (102.20 s, search 102.13 s): objective=115600 imbalance=1.280 nsplit=0    Iteration 4 (127.78 s, search 127.69 s): objective=115600 imbalance=1.274 nsplit=0       
23it [58:59, 155.05s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.78 s, search 25.76 s): objective=115579 imbalance=1.401 nsplit=0      Iteration 1 (51.51 s, search 51.47 s): objective=115597 imbalance=1.317 nsplit=1      Iteration 2 (77.16 s, search 77.10 s): objective=115599 imbalance=1.292 nsplit=0      Iteration 3 (102.36 s, search 102.28 s): objective=115600 imbalance=1.280 nsplit=0    Iteration 4 (127.52 s, search 127.42 s): objective=115601 imbalance=1.274 nsplit=0       
24it [1:01:32, 154.50s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.67 s, search 25.64 s): objective=115581 imbalance=1.401 nsplit=0      Iteration 1 (51.33 s, search 51.29 s): objective=115598 imbalance=1.315 nsplit=1      Iteration 2 (76.98 s, search 76.92 s): objective=115600 imbalance=1.290 nsplit=0      Iteration 3 (102.61 s, search 102.53 s): objective=115601 imbalance=1.277 nsplit=0    Iteration 4 (129.03 s, search 128.94 s): objective=115601 imbalance=1.270 nsplit=0       
25it [1:04:08, 154.80s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (26.42 s, search 26.40 s): objective=115582 imbalance=1.399 nsplit=0      Iteration 1 (52.81 s, search 52.77 s): objective=115599 imbalance=1.313 nsplit=0      Iteration 2 (79.24 s, search 79.18 s): objective=115601 imbalance=1.287 nsplit=0      Iteration 3 (105.57 s, search 105.50 s): objective=115602 imbalance=1.275 nsplit=0    Iteration 4 (131.72 s, search 131.63 s): objective=115602 imbalance=1.268 nsplit=0       
26it [1:06:46, 155.77s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.46 s, search 25.43 s): objective=115583 imbalance=1.398 nsplit=0      Iteration 1 (50.69 s, search 50.65 s): objective=115600 imbalance=1.314 nsplit=0      Iteration 2 (75.99 s, search 75.93 s): objective=115602 imbalance=1.288 nsplit=0      Iteration 3 (101.52 s, search 101.45 s): objective=115602 imbalance=1.276 nsplit=0    Iteration 4 (126.99 s, search 126.90 s): objective=115603 imbalance=1.270 nsplit=0       
27it [1:09:19, 154.83s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.51 s, search 25.49 s): objective=115585 imbalance=1.398 nsplit=0      Iteration 1 (51.02 s, search 50.98 s): objective=115600 imbalance=1.314 nsplit=0      Iteration 2 (76.35 s, search 76.29 s): objective=115602 imbalance=1.289 nsplit=0      Iteration 3 (102.05 s, search 101.98 s): objective=115603 imbalance=1.278 nsplit=0    Iteration 4 (127.78 s, search 127.69 s): objective=115603 imbalance=1.272 nsplit=0       
28it [1:11:52, 154.44s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.77 s, search 25.75 s): objective=115586 imbalance=1.395 nsplit=0      Iteration 1 (51.06 s, search 51.02 s): objective=115601 imbalance=1.312 nsplit=0      Iteration 2 (76.38 s, search 76.32 s): objective=115603 imbalance=1.288 nsplit=0      Iteration 3 (101.89 s, search 101.81 s): objective=115604 imbalance=1.276 nsplit=0    Iteration 4 (127.19 s, search 127.10 s): objective=115604 imbalance=1.271 nsplit=0       
29it [1:14:25, 153.93s/it]WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 512D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.02 s
  Iteration 0 (25.50 s, search 25.48 s): objective=115587 imbalance=1.395 nsplit=0      Iteration 1 (50.77 s, search 50.73 s): objective=115601 imbalance=1.311 nsplit=0      Iteration 2 (76.38 s, search 76.32 s): objective=115603 imbalance=1.286 nsplit=0      Iteration 3 (101.85 s, search 101.77 s): objective=115604 imbalance=1.276 nsplit=0    Iteration 4 (127.23 s, search 127.14 s): objective=115605 imbalance=1.271 nsplit=0       
30it [1:16:58, 153.94s/it]
WARNING clustering 115615 points to 11561 centroids: please provide at least 450879 training points
Clustering 115615 points in 384D to 11561 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (19.24 s, search 19.22 s): objective=111316 imbalance=1.447 nsplit=0      Iteration 1 (38.46 s, search 38.43 s): objective=112722 imbalance=1.344 nsplit=0      Iteration 2 (57.55 s, search 57.51 s): objective=112917 imbalance=1.317 nsplit=0      Iteration 3 (76.63 s, search 76.57 s): objective=113002 imbalance=1.306 nsplit=0      Iteration 4 (95.57 s, search 95.50 s): objective=113046 imbalance=1.302 nsplit=0       
[07:17:11] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 179 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 60.71it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/teatime/lerf/2024-11-07_215716/nerfstudio_models/step-000029999.ckpt
[2024/11/13 07:17:15 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 07:17:15 hloc INFO] Found 180 images in root /home/gtangg12/data/lerf/LERF Datasets/teatime/teatime/images.
100%|███████████████████████████████████████████████| 180/180 [00:04<00:00, 36.67it/s]
[2024/11/13 07:17:23 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 179/179 [00:00<00:00, 55633.97it/s]
tensor([  0,  16,  24,  27,  29,  33,  35,  45,  49,  63,  70,  78,  83,  94,
         97,  99, 101, 105, 109, 112, 115, 118, 120, 123, 130, 134, 136, 140,
        143, 145, 146, 149, 151, 154, 155, 156, 158, 160, 161, 162, 164, 166,
        169, 172, 175, 176, 178, 179]) 48
Rendering views: 48it [02:14,  2.80s/it]
0it [00:00, ?it/s]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.34 s, search 4.33 s): objective=46703.3 imbalance=1.390 nsplit=0       Iteration 1 (8.68 s, search 8.66 s): objective=46718.3 imbalance=1.302 nsplit=1       Iteration 2 (12.98 s, search 12.95 s): objective=46720.4 imbalance=1.271 nsplit=0     Iteration 3 (17.16 s, search 17.13 s): objective=46721.4 imbalance=1.259 nsplit=0     Iteration 4 (21.33 s, search 21.29 s): objective=46721.9 imbalance=1.255 nsplit=0       
1it [00:25, 25.57s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.30 s, search 4.29 s): objective=46676.8 imbalance=1.384 nsplit=0       Iteration 1 (8.45 s, search 8.43 s): objective=46701.6 imbalance=1.296 nsplit=0       Iteration 2 (12.56 s, search 12.53 s): objective=46705.3 imbalance=1.270 nsplit=0     Iteration 3 (16.69 s, search 16.66 s): objective=46706.9 imbalance=1.260 nsplit=0     Iteration 4 (20.82 s, search 20.78 s): objective=46707.6 imbalance=1.255 nsplit=0       
2it [00:50, 25.22s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.13 s, search 4.12 s): objective=46656.6 imbalance=1.388 nsplit=0       Iteration 1 (8.26 s, search 8.24 s): objective=46688.3 imbalance=1.300 nsplit=0       Iteration 2 (12.39 s, search 12.37 s): objective=46693.1 imbalance=1.270 nsplit=0     Iteration 3 (16.53 s, search 16.50 s): objective=46695.2 imbalance=1.257 nsplit=0     Iteration 4 (20.67 s, search 20.63 s): objective=46696.2 imbalance=1.250 nsplit=0       
3it [01:15, 25.04s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (8.27 s, search 8.25 s): objective=46682.7 imbalance=1.298 nsplit=0       Iteration 2 (12.41 s, search 12.38 s): objective=46687.7 imbalance=1.271 nsplit=0     Iteration 3 (16.64 s, search 16.61 s): objective=46690.1 imbalance=1.258 nsplit=0     Iteration 4 (20.97 s, search 20.93 s): objective=46691.4 imbalance=1.253 nsplit=0       
4it [01:40, 25.16s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.23 s, search 4.22 s): objective=46646.1 imbalance=1.383 nsplit=0       Iteration 1 (8.38 s, search 8.36 s): objective=46681.6 imbalance=1.298 nsplit=0       Iteration 2 (12.49 s, search 12.47 s): objective=46686.9 imbalance=1.270 nsplit=0     Iteration 3 (16.61 s, search 16.57 s): objective=46689.2 imbalance=1.259 nsplit=0     Iteration 4 (20.73 s, search 20.69 s): objective=46690.3 imbalance=1.253 nsplit=0       
5it [02:05, 25.06s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.13 s, search 4.13 s): objective=46646.9 imbalance=1.385 nsplit=0       Iteration 1 (8.29 s, search 8.28 s): objective=46682.3 imbalance=1.297 nsplit=0       Iteration 2 (12.42 s, search 12.40 s): objective=46687.5 imbalance=1.269 nsplit=0     Iteration 3 (16.55 s, search 16.52 s): objective=46689.9 imbalance=1.260 nsplit=0     Iteration 4 (20.83 s, search 20.79 s): objective=46691.1 imbalance=1.252 nsplit=0       
6it [02:30, 25.04s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.19 s, search 4.18 s): objective=46648.8 imbalance=1.389 nsplit=0       Iteration 1 (8.49 s, search 8.48 s): objective=46683.6 imbalance=1.300 nsplit=0       Iteration 2 (12.63 s, search 12.61 s): objective=46689.2 imbalance=1.270 nsplit=0     Iteration 3 (16.76 s, search 16.73 s): objective=46691.4 imbalance=1.257 nsplit=0     Iteration 4 (20.92 s, search 20.88 s): objective=46692.6 imbalance=1.253 nsplit=0       
7it [02:55, 25.07s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.19 s, search 4.18 s): objective=46650.1 imbalance=1.382 nsplit=0       Iteration 1 (8.36 s, search 8.34 s): objective=46684.8 imbalance=1.294 nsplit=0       Iteration 2 (12.55 s, search 12.52 s): objective=46690 imbalance=1.265 nsplit=0       Iteration 3 (16.73 s, search 16.70 s): objective=46692.3 imbalance=1.253 nsplit=0     Iteration 4 (21.03 s, search 20.99 s): objective=46693.5 imbalance=1.247 nsplit=0       
8it [03:20, 25.11s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (8.26 s, search 8.24 s): objective=46685.1 imbalance=1.296 nsplit=0       Iteration 2 (12.38 s, search 12.36 s): objective=46690.3 imbalance=1.269 nsplit=1     Iteration 3 (16.51 s, search 16.48 s): objective=46692.7 imbalance=1.258 nsplit=0     Iteration 4 (20.64 s, search 20.61 s): objective=46694 imbalance=1.253 nsplit=0       
9it [03:45, 25.01s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.14 s, search 4.13 s): objective=46651.4 imbalance=1.387 nsplit=0       Iteration 1 (8.27 s, search 8.25 s): objective=46685.1 imbalance=1.295 nsplit=0       Iteration 2 (12.40 s, search 12.37 s): objective=46690.5 imbalance=1.268 nsplit=0     Iteration 3 (16.52 s, search 16.49 s): objective=46693.1 imbalance=1.257 nsplit=0     Iteration 4 (20.66 s, search 20.62 s): objective=46694.4 imbalance=1.250 nsplit=0       
10it [04:10, 24.94s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.13 s, search 4.12 s): objective=46651.5 imbalance=1.384 nsplit=0       Iteration 1 (8.25 s, search 8.24 s): objective=46685.3 imbalance=1.289 nsplit=0       Iteration 2 (12.37 s, search 12.34 s): objective=46690.6 imbalance=1.265 nsplit=0     Iteration 3 (16.55 s, search 16.52 s): objective=46693 imbalance=1.254 nsplit=0       Iteration 4 (20.67 s, search 20.63 s): objective=46694.4 imbalance=1.247 nsplit=0       
11it [04:35, 24.90s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.12 s, search 4.12 s): objective=46651.3 imbalance=1.383 nsplit=0       Iteration 1 (8.24 s, search 8.22 s): objective=46684.9 imbalance=1.294 nsplit=0       Iteration 2 (12.36 s, search 12.34 s): objective=46690.6 imbalance=1.267 nsplit=1     Iteration 3 (16.49 s, search 16.46 s): objective=46693 imbalance=1.255 nsplit=0       Iteration 4 (20.64 s, search 20.60 s): objective=46694.5 imbalance=1.247 nsplit=0       
12it [05:00, 24.88s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (8.38 s, search 8.37 s): objective=46684.7 imbalance=1.290 nsplit=0       Iteration 2 (12.51 s, search 12.48 s): objective=46690.5 imbalance=1.262 nsplit=2     Iteration 3 (16.63 s, search 16.60 s): objective=46692.9 imbalance=1.251 nsplit=0     Iteration 4 (20.75 s, search 20.71 s): objective=46694.2 imbalance=1.245 nsplit=0       
13it [05:25, 24.88s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.15 s, search 4.14 s): objective=46650.7 imbalance=1.379 nsplit=0       Iteration 1 (8.38 s, search 8.37 s): objective=46684.5 imbalance=1.293 nsplit=1       Iteration 2 (12.62 s, search 12.60 s): objective=46689.9 imbalance=1.264 nsplit=0     Iteration 3 (16.85 s, search 16.82 s): objective=46692.4 imbalance=1.252 nsplit=0     Iteration 4 (21.09 s, search 21.05 s): objective=46693.8 imbalance=1.246 nsplit=0       
14it [05:50, 25.00s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.16 s, search 4.15 s): objective=46650.4 imbalance=1.378 nsplit=0       Iteration 1 (8.33 s, search 8.32 s): objective=46684.4 imbalance=1.290 nsplit=0       Iteration 2 (12.53 s, search 12.50 s): objective=46689.9 imbalance=1.263 nsplit=0     Iteration 3 (16.69 s, search 16.66 s): objective=46692.4 imbalance=1.254 nsplit=0     Iteration 4 (20.87 s, search 20.83 s): objective=46693.9 imbalance=1.248 nsplit=0       
15it [06:15, 25.01s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.18 s, search 4.17 s): objective=46650.5 imbalance=1.378 nsplit=0       Iteration 1 (8.35 s, search 8.33 s): objective=46684.3 imbalance=1.290 nsplit=0       Iteration 2 (12.53 s, search 12.50 s): objective=46689.8 imbalance=1.262 nsplit=0     Iteration 3 (16.70 s, search 16.66 s): objective=46692.2 imbalance=1.252 nsplit=0     Iteration 4 (20.88 s, search 20.84 s): objective=46693.6 imbalance=1.248 nsplit=0       
16it [06:40, 25.05s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.29 s, search 4.28 s): objective=46650.5 imbalance=1.376 nsplit=0       Iteration 1 (8.39 s, search 8.38 s): objective=46684.1 imbalance=1.290 nsplit=0       Iteration 2 (12.51 s, search 12.49 s): objective=46689.9 imbalance=1.264 nsplit=0     Iteration 3 (16.62 s, search 16.59 s): objective=46692.3 imbalance=1.254 nsplit=0     Iteration 4 (20.76 s, search 20.72 s): objective=46693.5 imbalance=1.249 nsplit=0       
17it [07:05, 25.01s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.13 s, search 4.12 s): objective=46650.8 imbalance=1.378 nsplit=0       Iteration 1 (8.33 s, search 8.31 s): objective=46684.3 imbalance=1.296 nsplit=0       Iteration 2 (12.50 s, search 12.48 s): objective=46689.8 imbalance=1.269 nsplit=0     Iteration 3 (16.68 s, search 16.65 s): objective=46692.1 imbalance=1.256 nsplit=1     Iteration 4 (20.86 s, search 20.82 s): objective=46693.3 imbalance=1.249 nsplit=0       
18it [07:30, 25.02s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.17 s, search 4.16 s): objective=46651.1 imbalance=1.379 nsplit=0       Iteration 1 (8.58 s, search 8.56 s): objective=46684.5 imbalance=1.293 nsplit=0       Iteration 2 (12.92 s, search 12.90 s): objective=46690 imbalance=1.266 nsplit=0       Iteration 3 (17.27 s, search 17.24 s): objective=46692.2 imbalance=1.254 nsplit=0     Iteration 4 (21.60 s, search 21.56 s): objective=46693.4 imbalance=1.248 nsplit=0       
19it [07:56, 25.30s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.34 s, search 4.33 s): objective=46651.5 imbalance=1.384 nsplit=0       Iteration 1 (8.68 s, search 8.66 s): objective=46684.7 imbalance=1.293 nsplit=0       Iteration 2 (13.02 s, search 13.00 s): objective=46690.1 imbalance=1.267 nsplit=0     Iteration 3 (17.36 s, search 17.32 s): objective=46692.3 imbalance=1.254 nsplit=0     Iteration 4 (21.68 s, search 21.64 s): objective=46693.6 imbalance=1.248 nsplit=0       
20it [08:22, 25.52s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.35 s, search 4.34 s): objective=46651.8 imbalance=1.390 nsplit=0       Iteration 1 (8.69 s, search 8.67 s): objective=46684.8 imbalance=1.297 nsplit=0       Iteration 2 (13.02 s, search 13.00 s): objective=46690.2 imbalance=1.266 nsplit=0     Iteration 3 (17.37 s, search 17.34 s): objective=46692.6 imbalance=1.254 nsplit=0     Iteration 4 (21.70 s, search 21.66 s): objective=46693.8 imbalance=1.247 nsplit=0       
21it [08:48, 25.68s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.34 s, search 4.33 s): objective=46652.3 imbalance=1.393 nsplit=0       Iteration 1 (8.67 s, search 8.65 s): objective=46685.1 imbalance=1.301 nsplit=0       Iteration 2 (13.01 s, search 12.98 s): objective=46690.3 imbalance=1.272 nsplit=1     Iteration 3 (17.36 s, search 17.32 s): objective=46692.8 imbalance=1.259 nsplit=0     Iteration 4 (21.71 s, search 21.67 s): objective=46694 imbalance=1.253 nsplit=0       
22it [09:14, 25.79s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.33 s, search 4.33 s): objective=46652.6 imbalance=1.392 nsplit=0       Iteration 1 (8.64 s, search 8.62 s): objective=46685.4 imbalance=1.305 nsplit=0       Iteration 2 (12.94 s, search 12.91 s): objective=46690.5 imbalance=1.276 nsplit=0     Iteration 3 (17.13 s, search 17.09 s): objective=46692.9 imbalance=1.262 nsplit=0     Iteration 4 (21.22 s, search 21.18 s): objective=46694.1 imbalance=1.256 nsplit=0       
23it [09:39, 25.66s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.11 s, search 4.10 s): objective=46652.9 imbalance=1.394 nsplit=0       Iteration 1 (8.42 s, search 8.41 s): objective=46685.5 imbalance=1.305 nsplit=0       Iteration 2 (12.78 s, search 12.76 s): objective=46690.6 imbalance=1.276 nsplit=0     Iteration 3 (17.14 s, search 17.10 s): objective=46692.9 imbalance=1.262 nsplit=0     Iteration 4 (21.48 s, search 21.44 s): objective=46694 imbalance=1.256 nsplit=0       
24it [10:05, 25.72s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.37 s, search 4.36 s): objective=46653.2 imbalance=1.394 nsplit=0       Iteration 1 (8.73 s, search 8.71 s): objective=46685.4 imbalance=1.309 nsplit=0       Iteration 2 (13.08 s, search 13.05 s): objective=46690.5 imbalance=1.278 nsplit=0     Iteration 3 (17.44 s, search 17.40 s): objective=46692.8 imbalance=1.267 nsplit=0     Iteration 4 (21.77 s, search 21.73 s): objective=46694 imbalance=1.261 nsplit=0       
25it [10:31, 25.84s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.35 s, search 4.34 s): objective=46653.5 imbalance=1.393 nsplit=0       Iteration 1 (8.70 s, search 8.68 s): objective=46685.5 imbalance=1.307 nsplit=0       Iteration 2 (13.06 s, search 13.04 s): objective=46690.6 imbalance=1.277 nsplit=0     Iteration 3 (17.42 s, search 17.39 s): objective=46692.8 imbalance=1.265 nsplit=0     Iteration 4 (21.79 s, search 21.75 s): objective=46694.1 imbalance=1.258 nsplit=0       
26it [10:57, 25.94s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.35 s, search 4.34 s): objective=46653.8 imbalance=1.395 nsplit=0       Iteration 1 (8.70 s, search 8.68 s): objective=46685.6 imbalance=1.307 nsplit=0       Iteration 2 (13.04 s, search 13.02 s): objective=46690.6 imbalance=1.281 nsplit=0     Iteration 3 (17.39 s, search 17.36 s): objective=46692.9 imbalance=1.270 nsplit=0     Iteration 4 (21.73 s, search 21.70 s): objective=46694.2 imbalance=1.264 nsplit=0       
27it [11:24, 25.99s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (8.74 s, search 8.72 s): objective=46685.9 imbalance=1.305 nsplit=0       Iteration 2 (13.09 s, search 13.07 s): objective=46690.7 imbalance=1.279 nsplit=0     Iteration 3 (17.51 s, search 17.48 s): objective=46693.1 imbalance=1.269 nsplit=0     Iteration 4 (21.86 s, search 21.82 s): objective=46694.1 imbalance=1.263 nsplit=0       
28it [11:50, 26.02s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.09 s, search 4.09 s): objective=46654.5 imbalance=1.396 nsplit=0       Iteration 2 (12.32 s, search 12.29 s): objective=46690.9 imbalance=1.281 nsplit=0     Iteration 3 (16.43 s, search 16.40 s): objective=46693.3 imbalance=1.270 nsplit=0     Iteration 4 (20.61 s, search 20.57 s): objective=46694.5 imbalance=1.264 nsplit=0       
29it [12:15, 25.65s/it]WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 512D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.16 s, search 4.15 s): objective=46654.9 imbalance=1.396 nsplit=0       Iteration 1 (8.31 s, search 8.30 s): objective=46686.4 imbalance=1.306 nsplit=0       Iteration 2 (12.49 s, search 12.46 s): objective=46691.4 imbalance=1.277 nsplit=0     Iteration 3 (16.65 s, search 16.62 s): objective=46693.6 imbalance=1.265 nsplit=0     Iteration 4 (20.88 s, search 20.84 s): objective=46694.8 imbalance=1.259 nsplit=0       
30it [12:40, 25.34s/it]
WARNING clustering 46733 points to 4673 centroids: please provide at least 182247 training points
Clustering 46733 points in 384D to 4673 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.15 s, search 3.14 s): objective=45026.7 imbalance=1.427 nsplit=0       Iteration 1 (6.32 s, search 6.31 s): objective=45606.8 imbalance=1.334 nsplit=0       Iteration 2 (9.48 s, search 9.46 s): objective=45686.2 imbalance=1.308 nsplit=0       Iteration 3 (12.63 s, search 12.61 s): objective=45721.3 imbalance=1.300 nsplit=0     Iteration 4 (15.80 s, search 15.77 s): objective=45741.2 imbalance=1.296 nsplit=0       
[07:32:46] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 412 images.
Setting up evaluation dataset...
Caching all 4 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 28.53it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/veggie_aisle/lerf/2024-11-07_225558/nerfstudio_models/step-000029999.ckpt
[2024/11/13 07:32:59 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 07:32:59 hloc INFO] Found 426 images in root /home/gtangg12/data/lerf/LERF Datasets/veggie_aisle/veggie_aisle/images.
100%|███████████████████████████████████████████████| 426/426 [00:11<00:00, 38.31it/s]
[2024/11/13 07:33:14 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 415/415 [00:00<00:00, 51055.53it/s]
tensor([  0,   6,  10,  15,  22,  28,  35,  37,  40,  68,  81,  90, 102, 145,
        203, 215, 241, 253, 267, 302, 319, 324, 327, 332, 335, 345, 349, 351,
        354, 358, 360, 362, 365, 367, 370, 372, 377, 383, 405, 413]) 40
Rendering views: 40it [01:51,  2.79s/it]
0it [00:00, ?it/s]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (6.13 s, search 6.12 s): objective=39953.9 imbalance=1.297 nsplit=0       Iteration 2 (9.20 s, search 9.18 s): objective=39957.6 imbalance=1.265 nsplit=0       Iteration 3 (12.27 s, search 12.24 s): objective=39959.2 imbalance=1.254 nsplit=0     Iteration 4 (15.33 s, search 15.30 s): objective=39960.1 imbalance=1.248 nsplit=0       
1it [00:18, 18.43s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.06 s, search 3.05 s): objective=39852.1 imbalance=1.357 nsplit=0       Iteration 1 (6.11 s, search 6.10 s): objective=39902.5 imbalance=1.282 nsplit=0       Iteration 2 (9.17 s, search 9.15 s): objective=39910.6 imbalance=1.260 nsplit=0       Iteration 3 (12.23 s, search 12.20 s): objective=39914.3 imbalance=1.249 nsplit=0     Iteration 4 (15.30 s, search 15.27 s): objective=39916.2 imbalance=1.242 nsplit=0       
2it [00:36, 18.40s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.06 s, search 3.05 s): objective=39834.3 imbalance=1.353 nsplit=0       Iteration 1 (6.12 s, search 6.10 s): objective=39891.5 imbalance=1.273 nsplit=0       Iteration 2 (9.19 s, search 9.17 s): objective=39900.1 imbalance=1.247 nsplit=0       Iteration 3 (12.20 s, search 12.17 s): objective=39903.7 imbalance=1.237 nsplit=0     Iteration 4 (15.21 s, search 15.18 s): objective=39905.7 imbalance=1.232 nsplit=0       
3it [00:55, 18.33s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.16 s, search 3.15 s): objective=39845.1 imbalance=1.351 nsplit=0       Iteration 1 (6.27 s, search 6.25 s): objective=39898.2 imbalance=1.271 nsplit=0       Iteration 2 (9.43 s, search 9.41 s): objective=39905.8 imbalance=1.244 nsplit=0       Iteration 3 (12.59 s, search 12.57 s): objective=39909.4 imbalance=1.233 nsplit=0     Iteration 4 (15.77 s, search 15.73 s): objective=39911.2 imbalance=1.226 nsplit=0       
4it [01:14, 18.61s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.09 s, search 3.08 s): objective=39862.9 imbalance=1.354 nsplit=0       Iteration 1 (6.09 s, search 6.08 s): objective=39909.4 imbalance=1.274 nsplit=1       Iteration 2 (9.11 s, search 9.09 s): objective=39916.6 imbalance=1.249 nsplit=0       Iteration 3 (12.13 s, search 12.10 s): objective=39919.5 imbalance=1.237 nsplit=0     Iteration 4 (15.15 s, search 15.11 s): objective=39921.4 imbalance=1.232 nsplit=0       
5it [01:32, 18.46s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.01 s, search 3.01 s): objective=39878.8 imbalance=1.359 nsplit=0       Iteration 1 (6.03 s, search 6.01 s): objective=39919.3 imbalance=1.277 nsplit=0       Iteration 2 (9.05 s, search 9.02 s): objective=39925.2 imbalance=1.248 nsplit=0       Iteration 3 (12.09 s, search 12.06 s): objective=39928.1 imbalance=1.237 nsplit=0     Iteration 4 (15.11 s, search 15.07 s): objective=39929.7 imbalance=1.230 nsplit=0       
6it [01:50, 18.35s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.01 s, search 3.01 s): objective=39890.4 imbalance=1.357 nsplit=0       Iteration 2 (9.05 s, search 9.03 s): objective=39932.6 imbalance=1.247 nsplit=0       Iteration 3 (12.06 s, search 12.03 s): objective=39935 imbalance=1.236 nsplit=0       Iteration 4 (15.08 s, search 15.05 s): objective=39936.4 imbalance=1.231 nsplit=0       
7it [02:08, 18.30s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.14 s, search 3.13 s): objective=39899.7 imbalance=1.358 nsplit=0       Iteration 2 (9.22 s, search 9.20 s): objective=39937.8 imbalance=1.249 nsplit=0       Iteration 3 (12.24 s, search 12.22 s): objective=39940 imbalance=1.238 nsplit=0       Iteration 4 (15.27 s, search 15.24 s): objective=39941.1 imbalance=1.232 nsplit=0       
8it [02:26, 18.30s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.08 s, search 3.07 s): objective=39907.2 imbalance=1.355 nsplit=0       Iteration 1 (6.12 s, search 6.11 s): objective=39937.6 imbalance=1.274 nsplit=1       Iteration 2 (9.16 s, search 9.14 s): objective=39942.2 imbalance=1.249 nsplit=0       Iteration 3 (12.22 s, search 12.19 s): objective=39944.2 imbalance=1.239 nsplit=0     Iteration 4 (15.29 s, search 15.25 s): objective=39945.3 imbalance=1.234 nsplit=0       
9it [02:45, 18.32s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.07 s, search 3.06 s): objective=39914.3 imbalance=1.367 nsplit=0       Iteration 1 (6.14 s, search 6.13 s): objective=39941.9 imbalance=1.285 nsplit=0       Iteration 2 (9.21 s, search 9.18 s): objective=39945.9 imbalance=1.260 nsplit=0       Iteration 3 (12.27 s, search 12.24 s): objective=39947.8 imbalance=1.248 nsplit=0     Iteration 4 (15.32 s, search 15.28 s): objective=39948.7 imbalance=1.242 nsplit=0       
10it [03:03, 18.35s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.06 s, search 3.06 s): objective=39920.6 imbalance=1.363 nsplit=0       Iteration 1 (6.13 s, search 6.12 s): objective=39945.9 imbalance=1.286 nsplit=0       Iteration 2 (9.19 s, search 9.17 s): objective=39949.5 imbalance=1.258 nsplit=0       Iteration 3 (12.25 s, search 12.23 s): objective=39951.2 imbalance=1.246 nsplit=0     Iteration 4 (15.32 s, search 15.29 s): objective=39952.1 imbalance=1.242 nsplit=0       
11it [03:22, 18.36s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.05 s, search 3.05 s): objective=39926.2 imbalance=1.365 nsplit=0       Iteration 1 (6.12 s, search 6.10 s): objective=39949.3 imbalance=1.286 nsplit=0       Iteration 2 (9.19 s, search 9.17 s): objective=39952.6 imbalance=1.261 nsplit=0       Iteration 3 (12.23 s, search 12.20 s): objective=39954.1 imbalance=1.250 nsplit=0     Iteration 4 (15.24 s, search 15.20 s): objective=39955 imbalance=1.244 nsplit=0       
12it [03:40, 18.33s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.03 s, search 3.03 s): objective=39930.9 imbalance=1.367 nsplit=0       Iteration 1 (6.05 s, search 6.04 s): objective=39952.2 imbalance=1.288 nsplit=0       Iteration 2 (9.07 s, search 9.05 s): objective=39955.4 imbalance=1.262 nsplit=0       Iteration 3 (12.08 s, search 12.05 s): objective=39956.8 imbalance=1.248 nsplit=0     Iteration 4 (15.12 s, search 15.08 s): objective=39957.6 imbalance=1.243 nsplit=0       
13it [03:58, 18.28s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.02 s, search 3.01 s): objective=39935.1 imbalance=1.365 nsplit=0       Iteration 1 (6.02 s, search 6.00 s): objective=39954.9 imbalance=1.286 nsplit=0       Iteration 2 (9.03 s, search 9.01 s): objective=39957.7 imbalance=1.261 nsplit=0       Iteration 3 (12.04 s, search 12.01 s): objective=39959.1 imbalance=1.248 nsplit=0     Iteration 4 (15.05 s, search 15.02 s): objective=39959.8 imbalance=1.245 nsplit=0       
14it [04:16, 18.22s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.01 s, search 3.01 s): objective=39938.3 imbalance=1.362 nsplit=0       Iteration 2 (9.03 s, search 9.01 s): objective=39959.7 imbalance=1.257 nsplit=0       Iteration 3 (12.04 s, search 12.01 s): objective=39960.8 imbalance=1.245 nsplit=0     Iteration 4 (15.06 s, search 15.02 s): objective=39961.5 imbalance=1.240 nsplit=0       
15it [04:34, 18.19s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (6.19 s, search 6.17 s): objective=39958.7 imbalance=1.278 nsplit=0       Iteration 2 (9.31 s, search 9.29 s): objective=39961.2 imbalance=1.254 nsplit=0       Iteration 3 (12.45 s, search 12.42 s): objective=39962.2 imbalance=1.242 nsplit=0     Iteration 4 (15.59 s, search 15.56 s): objective=39962.8 imbalance=1.238 nsplit=0       
16it [04:53, 18.36s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.04 s, search 3.03 s): objective=39943.3 imbalance=1.363 nsplit=0       Iteration 2 (9.06 s, search 9.04 s): objective=39962.4 imbalance=1.256 nsplit=0       Iteration 3 (12.08 s, search 12.05 s): objective=39963.5 imbalance=1.244 nsplit=0     Iteration 4 (15.08 s, search 15.05 s): objective=39964 imbalance=1.239 nsplit=0       
17it [05:11, 18.28s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.00 s, search 2.99 s): objective=39945.3 imbalance=1.361 nsplit=0       Iteration 1 (6.02 s, search 6.00 s): objective=39961.2 imbalance=1.281 nsplit=0       Iteration 2 (9.03 s, search 9.01 s): objective=39963.5 imbalance=1.257 nsplit=0       Iteration 3 (12.05 s, search 12.02 s): objective=39964.4 imbalance=1.248 nsplit=0     Iteration 4 (15.07 s, search 15.03 s): objective=39965 imbalance=1.241 nsplit=0       
18it [05:29, 18.23s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (6.06 s, search 6.04 s): objective=39962.3 imbalance=1.283 nsplit=0       Iteration 2 (9.07 s, search 9.05 s): objective=39964.4 imbalance=1.259 nsplit=0       Iteration 3 (12.09 s, search 12.06 s): objective=39965.3 imbalance=1.247 nsplit=0     Iteration 4 (15.10 s, search 15.07 s): objective=39965.8 imbalance=1.240 nsplit=0       
19it [05:47, 18.21s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.09 s, search 3.08 s): objective=39948.5 imbalance=1.365 nsplit=0       Iteration 1 (6.22 s, search 6.21 s): objective=39963.3 imbalance=1.282 nsplit=0       Iteration 2 (9.23 s, search 9.21 s): objective=39965.3 imbalance=1.255 nsplit=0       Iteration 3 (12.39 s, search 12.36 s): objective=39966.1 imbalance=1.245 nsplit=0     Iteration 4 (15.55 s, search 15.52 s): objective=39966.6 imbalance=1.239 nsplit=0       
20it [06:06, 18.37s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.19 s, search 3.18 s): objective=39949.8 imbalance=1.363 nsplit=0       Iteration 1 (6.39 s, search 6.37 s): objective=39964.1 imbalance=1.282 nsplit=0       Iteration 3 (12.75 s, search 12.72 s): objective=39966.9 imbalance=1.244 nsplit=0     Iteration 4 (15.93 s, search 15.89 s): objective=39967.5 imbalance=1.239 nsplit=0       
21it [06:25, 18.60s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (6.37 s, search 6.35 s): objective=39964.8 imbalance=1.277 nsplit=0       Iteration 2 (9.55 s, search 9.52 s): objective=39966.7 imbalance=1.253 nsplit=0       Iteration 3 (12.73 s, search 12.70 s): objective=39967.7 imbalance=1.243 nsplit=0     Iteration 4 (15.91 s, search 15.87 s): objective=39968.1 imbalance=1.239 nsplit=0       
22it [06:44, 18.76s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.18 s, search 3.17 s): objective=39952.1 imbalance=1.355 nsplit=0       Iteration 1 (6.36 s, search 6.34 s): objective=39965.5 imbalance=1.279 nsplit=0       Iteration 2 (9.51 s, search 9.49 s): objective=39967.4 imbalance=1.254 nsplit=0       Iteration 3 (12.66 s, search 12.63 s): objective=39968.3 imbalance=1.246 nsplit=0     Iteration 4 (15.80 s, search 15.77 s): objective=39968.6 imbalance=1.242 nsplit=0       
23it [07:03, 18.79s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.04 s, search 3.03 s): objective=39953.1 imbalance=1.356 nsplit=0       Iteration 1 (6.24 s, search 6.23 s): objective=39966.2 imbalance=1.280 nsplit=1       Iteration 2 (9.39 s, search 9.37 s): objective=39967.9 imbalance=1.255 nsplit=0       Iteration 3 (12.49 s, search 12.46 s): objective=39968.7 imbalance=1.245 nsplit=0     Iteration 4 (15.52 s, search 15.49 s): objective=39969.1 imbalance=1.239 nsplit=0       
24it [07:22, 18.72s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.02 s, search 3.01 s): objective=39954.1 imbalance=1.357 nsplit=0       Iteration 1 (6.04 s, search 6.02 s): objective=39966.8 imbalance=1.281 nsplit=0       Iteration 2 (9.05 s, search 9.03 s): objective=39968.5 imbalance=1.256 nsplit=0       Iteration 3 (12.09 s, search 12.06 s): objective=39969.3 imbalance=1.245 nsplit=0     Iteration 4 (15.17 s, search 15.14 s): objective=39969.7 imbalance=1.240 nsplit=0       
25it [07:40, 18.58s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (6.24 s, search 6.23 s): objective=39967.3 imbalance=1.285 nsplit=0       Iteration 3 (12.48 s, search 12.46 s): objective=39969.8 imbalance=1.247 nsplit=0     Iteration 4 (15.52 s, search 15.49 s): objective=39970.2 imbalance=1.243 nsplit=0       
26it [07:59, 18.59s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.06 s, search 3.05 s): objective=39955.9 imbalance=1.357 nsplit=0       Iteration 1 (6.10 s, search 6.09 s): objective=39967.8 imbalance=1.285 nsplit=0       Iteration 2 (9.14 s, search 9.12 s): objective=39969.5 imbalance=1.259 nsplit=0       Iteration 3 (12.17 s, search 12.15 s): objective=39970.3 imbalance=1.249 nsplit=0     Iteration 4 (15.22 s, search 15.18 s): objective=39970.7 imbalance=1.243 nsplit=0       
27it [08:17, 18.49s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.04 s, search 3.03 s): objective=39956.7 imbalance=1.358 nsplit=0       Iteration 1 (6.08 s, search 6.06 s): objective=39968.3 imbalance=1.286 nsplit=0       Iteration 3 (12.18 s, search 12.15 s): objective=39970.8 imbalance=1.249 nsplit=0     Iteration 4 (15.22 s, search 15.18 s): objective=39971 imbalance=1.244 nsplit=0       
28it [08:35, 18.44s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.07 s, search 3.06 s): objective=39957.5 imbalance=1.359 nsplit=0       Iteration 1 (6.12 s, search 6.11 s): objective=39968.7 imbalance=1.288 nsplit=1       Iteration 2 (9.17 s, search 9.15 s): objective=39970.4 imbalance=1.262 nsplit=1       Iteration 3 (12.22 s, search 12.19 s): objective=39971.1 imbalance=1.251 nsplit=0     Iteration 4 (15.28 s, search 15.24 s): objective=39971.4 imbalance=1.245 nsplit=0       
29it [08:54, 18.41s/it]WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 512D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.05 s, search 3.04 s): objective=39958.3 imbalance=1.367 nsplit=0       Iteration 1 (6.09 s, search 6.08 s): objective=39969.2 imbalance=1.292 nsplit=0       Iteration 2 (9.14 s, search 9.12 s): objective=39970.8 imbalance=1.268 nsplit=1       Iteration 3 (12.18 s, search 12.15 s): objective=39971.6 imbalance=1.254 nsplit=0     Iteration 4 (15.22 s, search 15.19 s): objective=39971.9 imbalance=1.249 nsplit=0       
30it [09:12, 18.41s/it]
WARNING clustering 39985 points to 3998 centroids: please provide at least 155922 training points
Clustering 39985 points in 384D to 3998 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.00 s
  Iteration 0 (2.29 s, search 2.28 s): objective=36720.6 imbalance=1.416 nsplit=0       Iteration 1 (4.57 s, search 4.56 s): objective=37792.5 imbalance=1.338 nsplit=0       Iteration 2 (6.86 s, search 6.84 s): objective=37928.1 imbalance=1.319 nsplit=0       Iteration 4 (11.42 s, search 11.39 s): objective=38021.1 imbalance=1.307 nsplit=0       
[07:44:40] Auto image downscale factor of 1                                                 nerfstudio_dataparser.py:484
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
            Dataset is overriding orientation method to none                                nerfstudio_dataparser.py:232
Setting up training dataset...
Caching all 189 images.
Setting up evaluation dataset...
Caching all 1 images.
Scales: 100%|███████████████████████████████████████████| 7/7 [00:00<00:00, 60.90it/s]
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:325: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
Loading latest checkpoint from load_dir
/home/gtangg12/mambaforge/envs/efficient-lerf/lib/python3.10/site-packages/nerfstudio/utils/eval_utils.py:62: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  loaded_state = torch.load(load_path, map_location="cpu")
✅ Done loading checkpoint from 
/home/gtangg12/efficient-lerf/outputs/waldo_kitchen/lerf/2024-11-08_040632/nerfstudio_models/step-000029999.ckpt
[2024/11/13 07:44:44 hloc INFO] Extracting local features with configuration:
{'model': {'name': 'netvlad'},
 'output': 'global-feats-netvlad',
 'preprocessing': {'resize_max': 1024}}
[2024/11/13 07:44:44 hloc INFO] Found 190 images in root /home/gtangg12/data/lerf/LERF Datasets/waldo_kitchen/waldo_kitchen/images.
100%|███████████████████████████████████████████████| 190/190 [00:05<00:00, 37.81it/s]
[2024/11/13 07:44:53 hloc INFO] Finished exporting features.
100%|████████████████████████████████████████████| 189/189 [00:00<00:00, 53860.81it/s]
tensor([  0,   4,   8,  13,  16,  18,  20,  24,  28,  30,  33,  36,  46,  49,
         52,  55,  57,  59,  70,  74,  77,  81,  85,  87,  91,  94,  99, 102,
        105, 110, 112, 115, 122, 131, 136, 141, 145, 153, 158, 160, 162, 164,
        171, 172, 173, 178, 180, 182, 185, 187, 188]) 51
Rendering views: 51it [02:27,  2.89s/it]
0it [00:00, ?it/s]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.97 s, search 4.96 s): objective=49767.1 imbalance=1.396 nsplit=0       Iteration 1 (9.92 s, search 9.90 s): objective=49789.5 imbalance=1.309 nsplit=0       Iteration 2 (14.86 s, search 14.83 s): objective=49792.8 imbalance=1.283 nsplit=0     Iteration 3 (19.77 s, search 19.74 s): objective=49794.3 imbalance=1.269 nsplit=0     Iteration 4 (24.69 s, search 24.65 s): objective=49795.2 imbalance=1.261 nsplit=0       
1it [00:29, 29.47s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.74 s, search 4.73 s): objective=49721.9 imbalance=1.386 nsplit=0       Iteration 1 (9.49 s, search 9.47 s): objective=49760.9 imbalance=1.306 nsplit=0       Iteration 2 (14.22 s, search 14.19 s): objective=49767 imbalance=1.278 nsplit=0       Iteration 3 (18.97 s, search 18.94 s): objective=49769.7 imbalance=1.265 nsplit=0     Iteration 4 (23.72 s, search 23.68 s): objective=49770.9 imbalance=1.260 nsplit=0       
2it [00:57, 28.90s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.74 s, search 4.73 s): objective=49684.9 imbalance=1.380 nsplit=0       Iteration 1 (9.48 s, search 9.47 s): objective=49735.4 imbalance=1.294 nsplit=0       Iteration 2 (14.23 s, search 14.21 s): objective=49743.6 imbalance=1.266 nsplit=0     Iteration 3 (18.99 s, search 18.95 s): objective=49746.9 imbalance=1.256 nsplit=0     Iteration 4 (23.74 s, search 23.70 s): objective=49748.8 imbalance=1.249 nsplit=0       
3it [01:26, 28.72s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.75 s, search 4.74 s): objective=49668.1 imbalance=1.377 nsplit=0       Iteration 1 (9.50 s, search 9.48 s): objective=49723.9 imbalance=1.288 nsplit=1       Iteration 2 (14.24 s, search 14.22 s): objective=49732.3 imbalance=1.257 nsplit=0     Iteration 3 (19.00 s, search 18.97 s): objective=49736.5 imbalance=1.243 nsplit=0     Iteration 4 (23.74 s, search 23.70 s): objective=49738.5 imbalance=1.235 nsplit=0       
4it [01:55, 28.68s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.87 s, search 4.86 s): objective=49664.6 imbalance=1.378 nsplit=0       Iteration 2 (14.54 s, search 14.51 s): objective=49729.8 imbalance=1.252 nsplit=0     Iteration 3 (19.36 s, search 19.32 s): objective=49733.7 imbalance=1.239 nsplit=0     Iteration 4 (24.21 s, search 24.17 s): objective=49735.8 imbalance=1.233 nsplit=0       
5it [02:24, 28.82s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.66 s, search 4.65 s): objective=49668.2 imbalance=1.372 nsplit=0       Iteration 1 (9.33 s, search 9.31 s): objective=49723.7 imbalance=1.283 nsplit=0       Iteration 2 (14.00 s, search 13.98 s): objective=49732.1 imbalance=1.254 nsplit=0     Iteration 3 (18.67 s, search 18.64 s): objective=49735.7 imbalance=1.242 nsplit=0     Iteration 4 (23.34 s, search 23.30 s): objective=49738 imbalance=1.237 nsplit=0       
6it [02:52, 28.55s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.71 s, search 4.70 s): objective=49674.7 imbalance=1.363 nsplit=0       Iteration 1 (9.38 s, search 9.36 s): objective=49728.1 imbalance=1.272 nsplit=0       Iteration 2 (14.17 s, search 14.14 s): objective=49736.5 imbalance=1.245 nsplit=0     Iteration 3 (18.87 s, search 18.84 s): objective=49740.4 imbalance=1.232 nsplit=0     Iteration 4 (23.58 s, search 23.54 s): objective=49742.6 imbalance=1.225 nsplit=0       
7it [03:20, 28.48s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.73 s, search 4.72 s): objective=49683.3 imbalance=1.360 nsplit=0       Iteration 1 (9.47 s, search 9.46 s): objective=49734.3 imbalance=1.272 nsplit=0       Iteration 2 (14.16 s, search 14.13 s): objective=49742 imbalance=1.242 nsplit=0       Iteration 3 (18.86 s, search 18.82 s): objective=49745.7 imbalance=1.230 nsplit=0     Iteration 4 (23.57 s, search 23.53 s): objective=49747.6 imbalance=1.224 nsplit=0       
8it [03:48, 28.42s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.71 s, search 4.70 s): objective=49693.3 imbalance=1.367 nsplit=0       Iteration 1 (9.53 s, search 9.51 s): objective=49740.7 imbalance=1.277 nsplit=0       Iteration 2 (14.44 s, search 14.42 s): objective=49747.9 imbalance=1.249 nsplit=1     Iteration 3 (19.35 s, search 19.32 s): objective=49751.3 imbalance=1.234 nsplit=0     Iteration 4 (24.20 s, search 24.16 s): objective=49753.3 imbalance=1.226 nsplit=0       
9it [04:17, 28.60s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.78 s, search 4.77 s): objective=49704.1 imbalance=1.364 nsplit=0       Iteration 1 (9.54 s, search 9.53 s): objective=49747.7 imbalance=1.275 nsplit=0       Iteration 2 (14.34 s, search 14.32 s): objective=49754.3 imbalance=1.249 nsplit=0     Iteration 3 (19.16 s, search 19.13 s): objective=49757.2 imbalance=1.236 nsplit=0     Iteration 4 (23.94 s, search 23.90 s): objective=49758.9 imbalance=1.230 nsplit=0       
10it [04:46, 28.65s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.79 s, search 4.78 s): objective=49713.9 imbalance=1.365 nsplit=0       Iteration 2 (14.43 s, search 14.40 s): objective=49760.4 imbalance=1.250 nsplit=0     Iteration 3 (19.23 s, search 19.19 s): objective=49763.2 imbalance=1.236 nsplit=0     Iteration 4 (24.03 s, search 23.99 s): objective=49764.6 imbalance=1.230 nsplit=0       
11it [05:15, 28.71s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 2 (14.39 s, search 14.36 s): objective=49765.7 imbalance=1.245 nsplit=0     Iteration 3 (19.18 s, search 19.15 s): objective=49768.2 imbalance=1.232 nsplit=0     Iteration 4 (23.98 s, search 23.94 s): objective=49769.6 imbalance=1.226 nsplit=0       
12it [05:44, 28.74s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.80 s, search 4.79 s): objective=49731.3 imbalance=1.366 nsplit=0       Iteration 1 (9.59 s, search 9.57 s): objective=49765.4 imbalance=1.273 nsplit=1       Iteration 2 (14.37 s, search 14.35 s): objective=49770.8 imbalance=1.244 nsplit=0     Iteration 3 (19.17 s, search 19.14 s): objective=49773.1 imbalance=1.232 nsplit=0     Iteration 4 (23.94 s, search 23.90 s): objective=49774.1 imbalance=1.224 nsplit=0       
13it [06:12, 28.71s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.71 s, search 4.70 s): objective=49739.2 imbalance=1.367 nsplit=0       Iteration 1 (9.49 s, search 9.47 s): objective=49770.4 imbalance=1.278 nsplit=0       Iteration 2 (14.34 s, search 14.32 s): objective=49775.2 imbalance=1.249 nsplit=0     Iteration 3 (19.12 s, search 19.09 s): objective=49777.2 imbalance=1.237 nsplit=0     Iteration 4 (23.78 s, search 23.74 s): objective=49778.3 imbalance=1.231 nsplit=0       
14it [06:41, 28.64s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.69 s, search 4.68 s): objective=49746.1 imbalance=1.374 nsplit=0       Iteration 1 (9.37 s, search 9.35 s): objective=49774.6 imbalance=1.281 nsplit=1       Iteration 2 (14.03 s, search 14.01 s): objective=49778.9 imbalance=1.250 nsplit=0     Iteration 3 (18.71 s, search 18.68 s): objective=49780.6 imbalance=1.237 nsplit=0     Iteration 4 (23.38 s, search 23.34 s): objective=49781.5 imbalance=1.233 nsplit=0       
15it [07:09, 28.47s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.33 s, search 9.31 s): objective=49778.1 imbalance=1.284 nsplit=1       Iteration 2 (13.99 s, search 13.96 s): objective=49782 imbalance=1.254 nsplit=0       Iteration 3 (18.65 s, search 18.62 s): objective=49783.7 imbalance=1.243 nsplit=0     Iteration 4 (23.32 s, search 23.28 s): objective=49784.7 imbalance=1.238 nsplit=0       
16it [07:37, 28.33s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.78 s, search 4.77 s): objective=49757.1 imbalance=1.379 nsplit=0       Iteration 1 (9.68 s, search 9.66 s): objective=49780.9 imbalance=1.289 nsplit=0       Iteration 2 (14.58 s, search 14.56 s): objective=49784.7 imbalance=1.258 nsplit=0     Iteration 3 (19.35 s, search 19.32 s): objective=49786.2 imbalance=1.245 nsplit=0     Iteration 4 (24.02 s, search 23.98 s): objective=49787.2 imbalance=1.238 nsplit=0       
17it [08:06, 28.45s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.64 s, search 4.63 s): objective=49761.5 imbalance=1.378 nsplit=0       Iteration 1 (9.36 s, search 9.34 s): objective=49783.5 imbalance=1.286 nsplit=0       Iteration 2 (14.15 s, search 14.12 s): objective=49786.8 imbalance=1.255 nsplit=0     Iteration 3 (18.91 s, search 18.88 s): objective=49788.6 imbalance=1.242 nsplit=1     Iteration 4 (23.69 s, search 23.65 s): objective=49789.4 imbalance=1.234 nsplit=0       
18it [08:34, 28.44s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.71 s, search 4.70 s): objective=49765.6 imbalance=1.378 nsplit=0       Iteration 1 (9.41 s, search 9.39 s): objective=49785.9 imbalance=1.286 nsplit=0       Iteration 2 (14.11 s, search 14.08 s): objective=49789 imbalance=1.257 nsplit=0       Iteration 3 (18.85 s, search 18.82 s): objective=49790.6 imbalance=1.243 nsplit=0     Iteration 4 (23.59 s, search 23.55 s): objective=49791.3 imbalance=1.236 nsplit=0       
19it [09:02, 28.43s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.64 s, search 4.63 s): objective=49769.1 imbalance=1.380 nsplit=0       Iteration 1 (9.27 s, search 9.26 s): objective=49788.1 imbalance=1.288 nsplit=0       Iteration 2 (13.90 s, search 13.88 s): objective=49791 imbalance=1.260 nsplit=0       Iteration 3 (18.55 s, search 18.52 s): objective=49792.4 imbalance=1.245 nsplit=0     Iteration 4 (23.20 s, search 23.16 s): objective=49793.1 imbalance=1.239 nsplit=0       
20it [09:30, 28.27s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.38 s, search 9.36 s): objective=49789.7 imbalance=1.286 nsplit=0       Iteration 2 (14.24 s, search 14.21 s): objective=49792.6 imbalance=1.257 nsplit=0     Iteration 3 (19.10 s, search 19.07 s): objective=49793.9 imbalance=1.245 nsplit=0     Iteration 4 (24.05 s, search 24.01 s): objective=49794.6 imbalance=1.239 nsplit=0       
21it [09:59, 28.42s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.70 s, search 4.69 s): objective=49774.5 imbalance=1.385 nsplit=0       Iteration 1 (9.39 s, search 9.37 s): objective=49791.2 imbalance=1.289 nsplit=0       Iteration 2 (14.12 s, search 14.09 s): objective=49793.8 imbalance=1.259 nsplit=0     Iteration 3 (18.90 s, search 18.87 s): objective=49795.1 imbalance=1.245 nsplit=0     Iteration 4 (23.67 s, search 23.63 s): objective=49795.8 imbalance=1.238 nsplit=0       
22it [10:28, 28.43s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.76 s, search 4.75 s): objective=49776.8 imbalance=1.386 nsplit=0       Iteration 1 (9.45 s, search 9.44 s): objective=49792.6 imbalance=1.290 nsplit=0       Iteration 2 (14.10 s, search 14.07 s): objective=49795.2 imbalance=1.258 nsplit=0     Iteration 3 (18.74 s, search 18.71 s): objective=49796.4 imbalance=1.244 nsplit=0     Iteration 4 (23.39 s, search 23.35 s): objective=49797.1 imbalance=1.236 nsplit=0       
23it [10:56, 28.32s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.63 s, search 4.62 s): objective=49778.9 imbalance=1.386 nsplit=0       Iteration 1 (9.28 s, search 9.26 s): objective=49793.8 imbalance=1.291 nsplit=1       Iteration 2 (13.91 s, search 13.88 s): objective=49796.4 imbalance=1.260 nsplit=0     Iteration 3 (18.55 s, search 18.51 s): objective=49797.6 imbalance=1.246 nsplit=0     Iteration 4 (23.24 s, search 23.19 s): objective=49798.2 imbalance=1.239 nsplit=0       
24it [11:24, 28.24s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.79 s, search 4.78 s): objective=49780.9 imbalance=1.389 nsplit=0       Iteration 1 (9.57 s, search 9.55 s): objective=49795.2 imbalance=1.293 nsplit=0       Iteration 2 (14.37 s, search 14.34 s): objective=49797.4 imbalance=1.261 nsplit=0     Iteration 3 (19.14 s, search 19.11 s): objective=49798.5 imbalance=1.245 nsplit=0     Iteration 4 (23.91 s, search 23.87 s): objective=49799.2 imbalance=1.238 nsplit=0       
25it [11:52, 28.38s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.77 s, search 4.76 s): objective=49782.6 imbalance=1.388 nsplit=0       Iteration 1 (9.55 s, search 9.54 s): objective=49796.2 imbalance=1.288 nsplit=0       Iteration 2 (14.22 s, search 14.19 s): objective=49798.2 imbalance=1.258 nsplit=0     Iteration 3 (18.90 s, search 18.86 s): objective=49799.2 imbalance=1.244 nsplit=0     Iteration 4 (23.53 s, search 23.48 s): objective=49799.9 imbalance=1.237 nsplit=0       
26it [12:21, 28.33s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.66 s, search 4.65 s): objective=49784.1 imbalance=1.387 nsplit=0       Iteration 1 (9.33 s, search 9.31 s): objective=49797.2 imbalance=1.288 nsplit=0       Iteration 2 (13.98 s, search 13.96 s): objective=49799.1 imbalance=1.261 nsplit=0     Iteration 3 (18.65 s, search 18.61 s): objective=49800.1 imbalance=1.247 nsplit=0     Iteration 4 (23.30 s, search 23.26 s): objective=49800.7 imbalance=1.240 nsplit=0       
27it [12:49, 28.24s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.72 s, search 4.71 s): objective=49785.6 imbalance=1.385 nsplit=0       Iteration 1 (9.45 s, search 9.43 s): objective=49798.2 imbalance=1.290 nsplit=0       Iteration 2 (14.18 s, search 14.16 s): objective=49799.9 imbalance=1.257 nsplit=0     Iteration 3 (18.90 s, search 18.87 s): objective=49800.8 imbalance=1.244 nsplit=0     Iteration 4 (23.62 s, search 23.58 s): objective=49801.3 imbalance=1.237 nsplit=0       
28it [13:17, 28.28s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (4.74 s, search 4.73 s): objective=49786.8 imbalance=1.384 nsplit=0       Iteration 1 (9.45 s, search 9.44 s): objective=49798.8 imbalance=1.287 nsplit=0       Iteration 2 (14.16 s, search 14.14 s): objective=49800.6 imbalance=1.257 nsplit=0     Iteration 3 (18.89 s, search 18.86 s): objective=49801.4 imbalance=1.244 nsplit=0     Iteration 4 (23.75 s, search 23.71 s): objective=49802 imbalance=1.236 nsplit=0       
29it [13:46, 28.37s/it]WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 512D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 1 (9.40 s, search 9.38 s): objective=49799.5 imbalance=1.286 nsplit=0       Iteration 2 (14.21 s, search 14.18 s): objective=49801.1 imbalance=1.252 nsplit=0     Iteration 3 (18.98 s, search 18.95 s): objective=49802 imbalance=1.240 nsplit=0       Iteration 4 (23.69 s, search 23.64 s): objective=49802.5 imbalance=1.234 nsplit=0       
30it [14:14, 28.48s/it]
WARNING clustering 49812 points to 4981 centroids: please provide at least 194259 training points
Clustering 49812 points in 384D to 4981 clusters, redo 1 times, 5 iterations
  Preprocessing in 0.01 s
  Iteration 0 (3.50 s, search 3.50 s): objective=47058.8 imbalance=1.431 nsplit=0       Iteration 1 (6.99 s, search 6.98 s): objective=47988.3 imbalance=1.339 nsplit=0       Iteration 2 (10.53 s, search 10.51 s): objective=48121 imbalance=1.313 nsplit=0       Iteration 3 (14.04 s, search 14.02 s): objective=48184.3 imbalance=1.304 nsplit=0     Iteration 4 (17.53 s, search 17.50 s): objective=48214.6 imbalance=1.299 nsplit=0